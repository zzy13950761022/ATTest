=== Run Tests ===
FFFFFFFFF                                                                [100%]
================================== FAILURES ===================================
_ test_assert_equal_eager_mode[assert_equal-x_shape0-y_shape0-float32-eager] __

func_name = 'assert_equal', x_shape = [2, 2], y_shape = [2, 2]
dtype = 'float32', mode = 'eager'
mock_executing_eagerly = <MagicMock name='executing_eagerly' id='2045295506720'>
mock_constant_value = <MagicMock name='constant_value' id='2045295592640'>
mock_equal = <MagicMock name='equal' id='2045295617120'>
mock_greater = <MagicMock name='greater' id='2045295637504'>

    @pytest.mark.parametrize(
        "func_name,x_shape,y_shape,dtype,mode",
        [
            ("assert_equal", [2, 2], [2, 2], "float32", "eager"),
            # Parameter extensions from test_plan.json
            ("assert_equal", [4, 4], [4, 4], "float64", "eager"),
            ("assert_greater", [2, 2], [2, 2], "float32", "eager"),
        ]
    )
    def test_assert_equal_eager_mode(
        func_name, x_shape, y_shape, dtype, mode,
        mock_executing_eagerly, mock_constant_value, mock_equal, mock_greater
    ):
        """
        Test assert_equal and similar functions in eager mode.
    
        Weak assertions:
        - returns_none: Function should return None in eager mode
        - no_exception: No exception should be raised
    
        Parameters from test_plan.json:
        - func: assert_equal (and extensions)
        - x_shape: [2, 2], [4, 4], [2, 2]
        - y_shape: [2, 2], [4, 4], [2, 2]
        - dtype: float32, float64, float32
        - mode: eager
        """
        # Setup mocks
        mock_executing_eagerly.return_value = True  # Eager mode
        mock_constant_value.return_value = None  # Dynamic check required
    
        # Create tensors
        x = create_tensor(x_shape, dtype)
        y = create_tensor(y_shape, dtype)
    
        # Mock the comparison operation
        comparison_result = tf.constant(True)
        if func_name == "assert_equal":
            mock_equal.return_value = comparison_result
        elif func_name == "assert_greater":
            mock_greater.return_value = comparison_result
    
        # Get the function to test
        func = getattr(check_ops, func_name)
    
        # Execute the function
        result = func(x, y)
    
        # Weak assertion: returns_none
        assert result is None, f"{func_name} should return None in eager mode, got {result}"
    
        # Weak assertion: no_exception (implicitly passed if we reach here)
    
        # Verify mocks were called as expected
>       mock_executing_eagerly.assert_called_once()

tests\test_tensorflow_python_ops_check_ops.py:150: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <MagicMock name='executing_eagerly' id='2045295506720'>

    def assert_called_once(self):
        """assert that the mock was called only once.
        """
        if not self.call_count == 1:
            msg = ("Expected '%s' to have been called once. Called %s times.%s"
                   % (self._mock_name or 'mock',
                      self.call_count,
                      self._calls_repr()))
>           raise AssertionError(msg)
E           AssertionError: Expected 'executing_eagerly' to have been called once. Called 5 times.
E           Calls: [call(), call(), call(), call(), call()].

D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:886: AssertionError
---------------------------- Captured stderr call -----------------------------
2026-01-21 15:45:04.520732: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
_ test_assert_equal_eager_mode[assert_equal-x_shape1-y_shape1-float64-eager] __

func_name = 'assert_equal', x_shape = [4, 4], y_shape = [4, 4]
dtype = 'float64', mode = 'eager'
mock_executing_eagerly = <MagicMock name='executing_eagerly' id='2045295654032'>
mock_constant_value = <MagicMock name='constant_value' id='2045314737200'>
mock_equal = <MagicMock name='equal' id='2045315481024'>
mock_greater = <MagicMock name='greater' id='2045314784608'>

    @pytest.mark.parametrize(
        "func_name,x_shape,y_shape,dtype,mode",
        [
            ("assert_equal", [2, 2], [2, 2], "float32", "eager"),
            # Parameter extensions from test_plan.json
            ("assert_equal", [4, 4], [4, 4], "float64", "eager"),
            ("assert_greater", [2, 2], [2, 2], "float32", "eager"),
        ]
    )
    def test_assert_equal_eager_mode(
        func_name, x_shape, y_shape, dtype, mode,
        mock_executing_eagerly, mock_constant_value, mock_equal, mock_greater
    ):
        """
        Test assert_equal and similar functions in eager mode.
    
        Weak assertions:
        - returns_none: Function should return None in eager mode
        - no_exception: No exception should be raised
    
        Parameters from test_plan.json:
        - func: assert_equal (and extensions)
        - x_shape: [2, 2], [4, 4], [2, 2]
        - y_shape: [2, 2], [4, 4], [2, 2]
        - dtype: float32, float64, float32
        - mode: eager
        """
        # Setup mocks
        mock_executing_eagerly.return_value = True  # Eager mode
        mock_constant_value.return_value = None  # Dynamic check required
    
        # Create tensors
        x = create_tensor(x_shape, dtype)
        y = create_tensor(y_shape, dtype)
    
        # Mock the comparison operation
        comparison_result = tf.constant(True)
        if func_name == "assert_equal":
            mock_equal.return_value = comparison_result
        elif func_name == "assert_greater":
            mock_greater.return_value = comparison_result
    
        # Get the function to test
        func = getattr(check_ops, func_name)
    
        # Execute the function
        result = func(x, y)
    
        # Weak assertion: returns_none
        assert result is None, f"{func_name} should return None in eager mode, got {result}"
    
        # Weak assertion: no_exception (implicitly passed if we reach here)
    
        # Verify mocks were called as expected
>       mock_executing_eagerly.assert_called_once()

tests\test_tensorflow_python_ops_check_ops.py:150: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <MagicMock name='executing_eagerly' id='2045295654032'>

    def assert_called_once(self):
        """assert that the mock was called only once.
        """
        if not self.call_count == 1:
            msg = ("Expected '%s' to have been called once. Called %s times.%s"
                   % (self._mock_name or 'mock',
                      self.call_count,
                      self._calls_repr()))
>           raise AssertionError(msg)
E           AssertionError: Expected 'executing_eagerly' to have been called once. Called 5 times.
E           Calls: [call(), call(), call(), call(), call()].

D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:886: AssertionError
_ test_assert_equal_eager_mode[assert_greater-x_shape2-y_shape2-float32-eager] _

func_name = 'assert_greater', x_shape = [2, 2], y_shape = [2, 2]
dtype = 'float32', mode = 'eager'
mock_executing_eagerly = <MagicMock name='executing_eagerly' id='2045314780272'>
mock_constant_value = <MagicMock name='constant_value' id='2045314752416'>
mock_equal = <MagicMock name='equal' id='2045314873136'>
mock_greater = <MagicMock name='greater' id='2045314869040'>

    @pytest.mark.parametrize(
        "func_name,x_shape,y_shape,dtype,mode",
        [
            ("assert_equal", [2, 2], [2, 2], "float32", "eager"),
            # Parameter extensions from test_plan.json
            ("assert_equal", [4, 4], [4, 4], "float64", "eager"),
            ("assert_greater", [2, 2], [2, 2], "float32", "eager"),
        ]
    )
    def test_assert_equal_eager_mode(
        func_name, x_shape, y_shape, dtype, mode,
        mock_executing_eagerly, mock_constant_value, mock_equal, mock_greater
    ):
        """
        Test assert_equal and similar functions in eager mode.
    
        Weak assertions:
        - returns_none: Function should return None in eager mode
        - no_exception: No exception should be raised
    
        Parameters from test_plan.json:
        - func: assert_equal (and extensions)
        - x_shape: [2, 2], [4, 4], [2, 2]
        - y_shape: [2, 2], [4, 4], [2, 2]
        - dtype: float32, float64, float32
        - mode: eager
        """
        # Setup mocks
        mock_executing_eagerly.return_value = True  # Eager mode
        mock_constant_value.return_value = None  # Dynamic check required
    
        # Create tensors
        x = create_tensor(x_shape, dtype)
        y = create_tensor(y_shape, dtype)
    
        # Mock the comparison operation
        comparison_result = tf.constant(True)
        if func_name == "assert_equal":
            mock_equal.return_value = comparison_result
        elif func_name == "assert_greater":
            mock_greater.return_value = comparison_result
    
        # Get the function to test
        func = getattr(check_ops, func_name)
    
        # Execute the function
        result = func(x, y)
    
        # Weak assertion: returns_none
        assert result is None, f"{func_name} should return None in eager mode, got {result}"
    
        # Weak assertion: no_exception (implicitly passed if we reach here)
    
        # Verify mocks were called as expected
>       mock_executing_eagerly.assert_called_once()

tests\test_tensorflow_python_ops_check_ops.py:150: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <MagicMock name='executing_eagerly' id='2045314780272'>

    def assert_called_once(self):
        """assert that the mock was called only once.
        """
        if not self.call_count == 1:
            msg = ("Expected '%s' to have been called once. Called %s times.%s"
                   % (self._mock_name or 'mock',
                      self.call_count,
                      self._calls_repr()))
>           raise AssertionError(msg)
E           AssertionError: Expected 'executing_eagerly' to have been called once. Called 4 times.
E           Calls: [call(), call(), call(), call()].

D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:886: AssertionError
__ test_assert_equal_graph_mode[assert_equal-x_shape0-y_shape0-int32-graph] ___

func_name = 'assert_equal', x_shape = [3, 3], y_shape = [3, 3], dtype = 'int32'
mode = 'graph'
mock_executing_eagerly = <MagicMock name='executing_eagerly' id='2045315208384'>
mock_constant_value = <MagicMock name='constant_value' id='2045314941808'>
mock_equal = <MagicMock name='equal' id='2045314913760'>
mock_assert = <MagicMock name='Assert' id='2045314920896'>

    @pytest.mark.parametrize(
        "func_name,x_shape,y_shape,dtype,mode",
        [
            ("assert_equal", [3, 3], [3, 3], "int32", "graph"),
            # Parameter extensions from test_plan.json
            ("assert_equal", [1, 5], [5, 1], "int32", "graph"),
        ]
    )
    def test_assert_equal_graph_mode(
        func_name, x_shape, y_shape, dtype, mode,
        mock_executing_eagerly, mock_constant_value, mock_equal, mock_assert
    ):
        """
        Test assert_equal in graph mode.
    
        Weak assertions:
        - returns_assert_op: Function should return Assert operation in graph mode
        - no_exception: No exception should be raised
    
        Parameters from test_plan.json:
        - func: assert_equal
        - x_shape: [3, 3], [1, 5]
        - y_shape: [3, 3], [5, 1]
        - dtype: int32, int32
        - mode: graph
        """
        # Setup mocks
        mock_executing_eagerly.return_value = False  # Graph mode
        mock_constant_value.return_value = None  # Dynamic check required
    
        # Create tensors
        x = create_tensor(x_shape, dtype)
        y = create_tensor(y_shape, dtype)
    
        # Mock the comparison operation
        comparison_result = tf.constant(True)
        mock_equal.return_value = comparison_result
    
        # Mock the Assert operation
        mock_assert_op = Mock()
        mock_assert.return_value = mock_assert_op
    
        # Get the function to test
        func = getattr(check_ops, func_name)
    
        # Execute the function
>       result = func(x, y)

tests\test_tensorflow_python_ops_check_ops.py:205: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\util\traceback_utils.py:153: in error_handler
    raise e.with_traceback(filtered_tb) from None
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <tf.Tensor: shape=(3, 3), dtype=int32, numpy=
array([[1, 2, 3],
       [4, 5, 6],
       [7, 8, 9]])>

    @property
    def name(self):
>     raise AttributeError(
          "Tensor.name is meaningless when eager execution is enabled.")
E     AttributeError: Tensor.name is meaningless when eager execution is enabled.

D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\framework\ops.py:1384: AttributeError
__ test_assert_equal_graph_mode[assert_equal-x_shape1-y_shape1-int32-graph] ___

func_name = 'assert_equal', x_shape = [1, 5], y_shape = [5, 1], dtype = 'int32'
mode = 'graph'
mock_executing_eagerly = <MagicMock name='executing_eagerly' id='2045295266400'>
mock_constant_value = <MagicMock name='constant_value' id='2045315276416'>
mock_equal = <MagicMock name='equal' id='2045315481072'>
mock_assert = <MagicMock name='Assert' id='2045314737008'>

    @pytest.mark.parametrize(
        "func_name,x_shape,y_shape,dtype,mode",
        [
            ("assert_equal", [3, 3], [3, 3], "int32", "graph"),
            # Parameter extensions from test_plan.json
            ("assert_equal", [1, 5], [5, 1], "int32", "graph"),
        ]
    )
    def test_assert_equal_graph_mode(
        func_name, x_shape, y_shape, dtype, mode,
        mock_executing_eagerly, mock_constant_value, mock_equal, mock_assert
    ):
        """
        Test assert_equal in graph mode.
    
        Weak assertions:
        - returns_assert_op: Function should return Assert operation in graph mode
        - no_exception: No exception should be raised
    
        Parameters from test_plan.json:
        - func: assert_equal
        - x_shape: [3, 3], [1, 5]
        - y_shape: [3, 3], [5, 1]
        - dtype: int32, int32
        - mode: graph
        """
        # Setup mocks
        mock_executing_eagerly.return_value = False  # Graph mode
        mock_constant_value.return_value = None  # Dynamic check required
    
        # Create tensors
        x = create_tensor(x_shape, dtype)
        y = create_tensor(y_shape, dtype)
    
        # Mock the comparison operation
        comparison_result = tf.constant(True)
        mock_equal.return_value = comparison_result
    
        # Mock the Assert operation
        mock_assert_op = Mock()
        mock_assert.return_value = mock_assert_op
    
        # Get the function to test
        func = getattr(check_ops, func_name)
    
        # Execute the function
>       result = func(x, y)

tests\test_tensorflow_python_ops_check_ops.py:205: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\util\traceback_utils.py:153: in error_handler
    raise e.with_traceback(filtered_tb) from None
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <tf.Tensor: shape=(1, 5), dtype=int32, numpy=array([[1, 2, 3, 4, 5]])>

    @property
    def name(self):
>     raise AttributeError(
          "Tensor.name is meaningless when eager execution is enabled.")
E     AttributeError: Tensor.name is meaningless when eager execution is enabled.

D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\framework\ops.py:1384: AttributeError
_ test_assert_less_static_failure[assert_less-x_shape0-y_shape0-float64-static_fail] _

func_name = 'assert_less', x_shape = [2], y_shape = [2], dtype = 'float64'
mode = 'static_fail'
mock_constant_value = <MagicMock name='constant_value' id='2045318635472'>
mock_less = <MagicMock name='less' id='2045315530816'>

    @pytest.mark.parametrize(
        "func_name,x_shape,y_shape,dtype,mode",
        [
            ("assert_less", [2], [2], "float64", "static_fail"),
            # Parameter extensions from test_plan.json
            ("assert_less", [3], [3], "float32", "static_fail"),
        ]
    )
    def test_assert_less_static_failure(
        func_name, x_shape, y_shape, dtype, mode,
        mock_constant_value, mock_less
    ):
        """
        Test assert_less with static failure (immediate exception).
    
        Weak assertions:
        - raises_invalid_argument_error: Should raise InvalidArgumentError
        - error_type_correct: Error type should be correct
    
        Parameters from test_plan.json:
        - func: assert_less
        - x_shape: [2], [3]
        - y_shape: [2], [3]
        - dtype: float64, float32
        - mode: static_fail
        """
        # Setup mocks for static failure
        # For static failure, constant_value returns False (condition fails)
        mock_constant_value.return_value = False
    
        # Create tensors where x > y to trigger failure
        x = create_tensor(x_shape, dtype, value=10.0)  # x = 10
        y = create_tensor(y_shape, dtype, value=5.0)   # y = 5
    
        # Mock the comparison operation (won't be called in static failure)
        comparison_result = tf.constant(False)
        mock_less.return_value = comparison_result
    
        # Get the function to test
        func = getattr(check_ops, func_name)
    
        # Weak assertion: raises_invalid_argument_error
        with pytest.raises(tf.errors.InvalidArgumentError) as exc_info:
            func(x, y)
    
        # Weak assertion: error_type_correct
>       assert "assertion failed" in str(exc_info.value).lower() or \
               "condition" in str(exc_info.value).lower(), \
               f"Error message should indicate assertion failure"
E       AssertionError: Error message should indicate assertion failure
E       assert ('assertion failed' in 'whereop : unhandled input dimensions: 0 [op:where]' or 'condition' in 'whereop : unhandled input dimensions: 0 [op:where]')
E        +  where 'whereop : unhandled input dimensions: 0 [op:where]' = <built-in method lower of str object at 0x000001DC351DD180>()
E        +    where <built-in method lower of str object at 0x000001DC351DD180> = 'WhereOp : Unhandled input dimensions: 0 [Op:Where]'.lower
E        +      where 'WhereOp : Unhandled input dimensions: 0 [Op:Where]' = str(InvalidArgumentError())
E        +        where InvalidArgumentError() = <ExceptionInfo InvalidArgumentError() tblen=3>.value
E        +  and   'whereop : unhandled input dimensions: 0 [op:where]' = <built-in method lower of str object at 0x000001DC351DD180>()
E        +    where <built-in method lower of str object at 0x000001DC351DD180> = 'WhereOp : Unhandled input dimensions: 0 [Op:Where]'.lower
E        +      where 'WhereOp : Unhandled input dimensions: 0 [Op:Where]' = str(InvalidArgumentError())
E        +        where InvalidArgumentError() = <ExceptionInfo InvalidArgumentError() tblen=3>.value

tests\test_tensorflow_python_ops_check_ops.py:265: AssertionError
_ test_assert_less_static_failure[assert_less-x_shape1-y_shape1-float32-static_fail] _

func_name = 'assert_less', x_shape = [3], y_shape = [3], dtype = 'float32'
mode = 'static_fail'
mock_constant_value = <MagicMock name='constant_value' id='2045295593072'>
mock_less = <MagicMock name='less' id='2044664328000'>

    @pytest.mark.parametrize(
        "func_name,x_shape,y_shape,dtype,mode",
        [
            ("assert_less", [2], [2], "float64", "static_fail"),
            # Parameter extensions from test_plan.json
            ("assert_less", [3], [3], "float32", "static_fail"),
        ]
    )
    def test_assert_less_static_failure(
        func_name, x_shape, y_shape, dtype, mode,
        mock_constant_value, mock_less
    ):
        """
        Test assert_less with static failure (immediate exception).
    
        Weak assertions:
        - raises_invalid_argument_error: Should raise InvalidArgumentError
        - error_type_correct: Error type should be correct
    
        Parameters from test_plan.json:
        - func: assert_less
        - x_shape: [2], [3]
        - y_shape: [2], [3]
        - dtype: float64, float32
        - mode: static_fail
        """
        # Setup mocks for static failure
        # For static failure, constant_value returns False (condition fails)
        mock_constant_value.return_value = False
    
        # Create tensors where x > y to trigger failure
        x = create_tensor(x_shape, dtype, value=10.0)  # x = 10
        y = create_tensor(y_shape, dtype, value=5.0)   # y = 5
    
        # Mock the comparison operation (won't be called in static failure)
        comparison_result = tf.constant(False)
        mock_less.return_value = comparison_result
    
        # Get the function to test
        func = getattr(check_ops, func_name)
    
        # Weak assertion: raises_invalid_argument_error
        with pytest.raises(tf.errors.InvalidArgumentError) as exc_info:
            func(x, y)
    
        # Weak assertion: error_type_correct
>       assert "assertion failed" in str(exc_info.value).lower() or \
               "condition" in str(exc_info.value).lower(), \
               f"Error message should indicate assertion failure"
E       AssertionError: Error message should indicate assertion failure
E       assert ('assertion failed' in 'whereop : unhandled input dimensions: 0 [op:where]' or 'condition' in 'whereop : unhandled input dimensions: 0 [op:where]')
E        +  where 'whereop : unhandled input dimensions: 0 [op:where]' = <built-in method lower of str object at 0x000001DC0F7E0570>()
E        +    where <built-in method lower of str object at 0x000001DC0F7E0570> = 'WhereOp : Unhandled input dimensions: 0 [Op:Where]'.lower
E        +      where 'WhereOp : Unhandled input dimensions: 0 [Op:Where]' = str(InvalidArgumentError())
E        +        where InvalidArgumentError() = <ExceptionInfo InvalidArgumentError() tblen=3>.value
E        +  and   'whereop : unhandled input dimensions: 0 [op:where]' = <built-in method lower of str object at 0x000001DC0F7E0570>()
E        +    where <built-in method lower of str object at 0x000001DC0F7E0570> = 'WhereOp : Unhandled input dimensions: 0 [Op:Where]'.lower
E        +      where 'WhereOp : Unhandled input dimensions: 0 [Op:Where]' = str(InvalidArgumentError())
E        +        where InvalidArgumentError() = <ExceptionInfo InvalidArgumentError() tblen=3>.value

tests\test_tensorflow_python_ops_check_ops.py:265: AssertionError
__ test_assert_positive_empty_tensor[assert_positive-x_shape0-float32-eager] __

func_name = 'assert_positive', x_shape = [0, 0], dtype = 'float32'
mode = 'eager'
mock_executing_eagerly = <MagicMock name='executing_eagerly' id='2044664269024'>
mock_constant_value = <MagicMock name='constant_value' id='2045295509216'>
mock_greater = <MagicMock name='greater' id='2045315269056'>

    @pytest.mark.parametrize(
        "func_name,x_shape,dtype,mode",
        [
            ("assert_positive", [0, 0], "float32", "eager"),
            # Parameter extensions from test_plan.json
            ("assert_positive", [0], "int32", "graph"),
        ]
    )
    def test_assert_positive_empty_tensor(
        func_name, x_shape, dtype, mode,
        mock_executing_eagerly, mock_constant_value, mock_greater
    ):
        """
        Test assert_positive with empty tensors.
    
        Weak assertions:
        - returns_none: Function should return None in eager mode
        - no_exception: No exception should be raised
    
        Parameters from test_plan.json:
        - func: assert_positive
        - x_shape: [0, 0], [0]
        - dtype: float32, int32
        - mode: eager, graph
        """
        # Setup mocks based on mode
        if mode == "eager":
            mock_executing_eagerly.return_value = True  # Eager mode
        else:  # graph mode
            mock_executing_eagerly.return_value = False  # Graph mode
    
        # For empty tensors, constant_value returns empty array
        mock_constant_value.return_value = np.array([], dtype=np.float32 if dtype == 'float32' else np.int32)
    
        # Create empty tensor
        x = create_tensor(x_shape, dtype, value=1.0)  # Value doesn't matter for empty tensor
    
        # Mock the comparison operation
        # For empty tensor, comparison returns empty tensor
        empty_comparison = tf.constant([], dtype=tf.bool)
        mock_greater.return_value = empty_comparison
    
        # Get the function to test
        func = getattr(check_ops, func_name)
    
        # Execute the function
        if mode == "eager":
            result = func(x)
            # Weak assertion: returns_none (for eager mode)
            assert result is None, f"{func_name} should return None in eager mode for empty tensor"
        else:  # graph mode
            # In graph mode, we need to mock Assert operation
            with patch.object(control_flow_ops, 'Assert') as mock_assert:
                mock_assert_op = Mock()
                mock_assert.return_value = mock_assert_op
                result = func(x)
                # Weak assertion: returns_assert_op (for graph mode)
                assert result == mock_assert_op, f"{func_name} should return Assert operation in graph mode"
                mock_assert.assert_called_once()
    
        # Weak assertion: no_exception (implicitly passed if we reach here)
    
        # Verify mocks were called as expected
>       mock_executing_eagerly.assert_called_once()

tests\test_tensorflow_python_ops_check_ops.py:339: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <MagicMock name='executing_eagerly' id='2044664269024'>

    def assert_called_once(self):
        """assert that the mock was called only once.
        """
        if not self.call_count == 1:
            msg = ("Expected '%s' to have been called once. Called %s times.%s"
                   % (self._mock_name or 'mock',
                      self.call_count,
                      self._calls_repr()))
>           raise AssertionError(msg)
E           AssertionError: Expected 'executing_eagerly' to have been called once. Called 4 times.
E           Calls: [call(), call(), call(), call()].

D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:886: AssertionError
___ test_assert_positive_empty_tensor[assert_positive-x_shape1-int32-graph] ___

func_name = 'assert_positive', x_shape = [0], dtype = 'int32', mode = 'graph'
mock_executing_eagerly = <MagicMock name='executing_eagerly' id='2044664343760'>
mock_constant_value = <MagicMock name='constant_value' id='2045315357040'>
mock_greater = <MagicMock name='greater' id='2045315344752'>

    @pytest.mark.parametrize(
        "func_name,x_shape,dtype,mode",
        [
            ("assert_positive", [0, 0], "float32", "eager"),
            # Parameter extensions from test_plan.json
            ("assert_positive", [0], "int32", "graph"),
        ]
    )
    def test_assert_positive_empty_tensor(
        func_name, x_shape, dtype, mode,
        mock_executing_eagerly, mock_constant_value, mock_greater
    ):
        """
        Test assert_positive with empty tensors.
    
        Weak assertions:
        - returns_none: Function should return None in eager mode
        - no_exception: No exception should be raised
    
        Parameters from test_plan.json:
        - func: assert_positive
        - x_shape: [0, 0], [0]
        - dtype: float32, int32
        - mode: eager, graph
        """
        # Setup mocks based on mode
        if mode == "eager":
            mock_executing_eagerly.return_value = True  # Eager mode
        else:  # graph mode
            mock_executing_eagerly.return_value = False  # Graph mode
    
        # For empty tensors, constant_value returns empty array
        mock_constant_value.return_value = np.array([], dtype=np.float32 if dtype == 'float32' else np.int32)
    
        # Create empty tensor
        x = create_tensor(x_shape, dtype, value=1.0)  # Value doesn't matter for empty tensor
    
        # Mock the comparison operation
        # For empty tensor, comparison returns empty tensor
        empty_comparison = tf.constant([], dtype=tf.bool)
        mock_greater.return_value = empty_comparison
    
        # Get the function to test
        func = getattr(check_ops, func_name)
    
        # Execute the function
        if mode == "eager":
            result = func(x)
            # Weak assertion: returns_none (for eager mode)
            assert result is None, f"{func_name} should return None in eager mode for empty tensor"
        else:  # graph mode
            # In graph mode, we need to mock Assert operation
            with patch.object(control_flow_ops, 'Assert') as mock_assert:
                mock_assert_op = Mock()
                mock_assert.return_value = mock_assert_op
>               result = func(x)

tests\test_tensorflow_python_ops_check_ops.py:331: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\util\traceback_utils.py:153: in error_handler
    raise e.with_traceback(filtered_tb) from None
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <tf.Tensor: shape=(0,), dtype=int32, numpy=array([], dtype=int32)>

    @property
    def name(self):
>     raise AttributeError(
          "Tensor.name is meaningless when eager execution is enabled.")
E     AttributeError: Tensor.name is meaningless when eager execution is enabled.

D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\framework\ops.py:1384: AttributeError

---------- coverage: platform win32, python 3.9.25-final-0 -----------
Name                                            Stmts   Miss Branch BrPart  Cover   Missing
-------------------------------------------------------------------------------------------
tests\test_tensorflow_python_ops_check_ops.py     131     19     24      3    82%   65-66, 79-83, 135->139, 152-155, 208-215, 270, 333, 340-341, 357
-------------------------------------------------------------------------------------------
TOTAL                                             131     19     24      3    82%
Coverage XML written to file coverage.xml

=========================== short test summary info ===========================
FAILED tests\test_tensorflow_python_ops_check_ops.py::test_assert_equal_eager_mode[assert_equal-x_shape0-y_shape0-float32-eager]
FAILED tests\test_tensorflow_python_ops_check_ops.py::test_assert_equal_eager_mode[assert_equal-x_shape1-y_shape1-float64-eager]
FAILED tests\test_tensorflow_python_ops_check_ops.py::test_assert_equal_eager_mode[assert_greater-x_shape2-y_shape2-float32-eager]
FAILED tests\test_tensorflow_python_ops_check_ops.py::test_assert_equal_graph_mode[assert_equal-x_shape0-y_shape0-int32-graph]
FAILED tests\test_tensorflow_python_ops_check_ops.py::test_assert_equal_graph_mode[assert_equal-x_shape1-y_shape1-int32-graph]
FAILED tests\test_tensorflow_python_ops_check_ops.py::test_assert_less_static_failure[assert_less-x_shape0-y_shape0-float64-static_fail]
FAILED tests\test_tensorflow_python_ops_check_ops.py::test_assert_less_static_failure[assert_less-x_shape1-y_shape1-float32-static_fail]
FAILED tests\test_tensorflow_python_ops_check_ops.py::test_assert_positive_empty_tensor[assert_positive-x_shape0-float32-eager]
FAILED tests\test_tensorflow_python_ops_check_ops.py::test_assert_positive_empty_tensor[assert_positive-x_shape1-int32-graph]
9 failed in 2.36s

Error: exit 1