{
  "workflow_id": "3cc11d90",
  "created_at": "2026-01-25T17:47:19.457245",
  "op": "tensorflow_python_ops_sparse_ops",
  "arch": "python",
  "soc": "python",
  "vendor": "python",
  "project_root": "/Users/zzf1sh/Documents/Project/TestAgent-CLI-main/exam/tensorflow/python.ops.sparse_ops",
  "target": "tensorflow.python.ops.sparse_ops",
  "target_slug": "tensorflow_python_ops_sparse_ops",
  "current_stage": "complete",
  "stage_index": 6,
  "mode": "full-auto",
  "epoch_total": 5,
  "epoch_current": 5,
  "last_failure_signature": "",
  "last_error_signature": "",
  "last_block_errors": {},
  "auto_stop_reason": "",
  "artifacts": {
    "function_doc.md": "# tensorflow.python.ops.sparse_ops - 函数说明\n\n## 1. 基本信息\n- **FQN**: tensorflow.python.ops.sparse_ops\n- **模块文件**: `/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/ops/sparse_ops.py`\n- **签名**: 模块（包含多个函数）\n- **对象类型**: module\n\n## 2. 功能概述\nTensorFlow 稀疏张量操作模块。提供稀疏张量与密集张量之间的转换、稀疏矩阵运算、稀疏张量操作等功能。核心功能包括稀疏-密集转换、稀疏矩阵乘法、稀疏张量重排等。\n\n## 3. 参数说明\n模块包含多个函数，主要参数类型：\n- 稀疏张量参数：indices (int32/int64), values (任意dtype), shape (int64)\n- 密集张量参数：Tensor 类型\n- 布尔标志：adjoint_a, adjoint_b, validate_indices 等\n- 可选名称参数：name (str)\n\n## 4. 返回值\n各函数返回类型：\n- 稀疏张量操作：返回 SparseTensor 对象\n- 稀疏-密集转换：返回 Tensor 或 SparseTensor\n- 矩阵运算：返回密集 Tensor\n\n## 5. 文档要点\n- 稀疏张量索引应排序（lexicographic order）\n- 索引不能重复\n- 稀疏矩阵乘法要求特定排序格式\n- 零值元素在稀疏表示中被忽略\n\n## 6. 源码摘要\n- 核心辅助函数：`_convert_to_sparse_tensor`, `_convert_to_sparse_tensors`\n- 依赖 TensorFlow 核心 API：ops, array_ops, math_ops\n- 使用 gen_sparse_ops 生成的低级操作\n- 支持 eager 和 graph 执行模式\n\n## 7. 示例与用法（如有）\nfrom_dense 示例：\n```python\nsp = tf.sparse.from_dense([0, 0, 3, 0, 1])\n# sp.shape: [5], sp.values: [3, 1], sp.indices: [[2], [4]]\n```\n\nSparseToDense 示例：\n- 标量索引：dense[i] = (i == sparse_indices ? sparse_values : default_value)\n- 向量索引：dense[sparse_indices[i]] = sparse_values[i]\n- 矩阵索引：dense[sparse_indices[i][0], ...] = sparse_values[i]\n\n## 8. 风险与空白\n- 目标为模块而非单个函数，包含 30+ 个函数\n- 需要选择核心函数进行测试覆盖\n- 部分函数文档不完整（如边界条件）\n- 缺少性能约束说明\n- 未明确异常处理细节\n- 建议聚焦：from_dense, sparse_to_dense, sparse_tensor_dense_mat_mul",
    "requirements.md": "# tensorflow.python.ops.sparse_ops 测试需求\n\n## 1. 目标与范围\n- 主要功能与期望行为：验证稀疏张量与密集张量转换、稀疏矩阵运算、稀疏张量操作的正确性，确保索引排序、值提取、形状转换符合规范\n- 不在范围内的内容：底层 C++ 实现、分布式计算、自定义稀疏格式、第三方库集成\n\n## 2. 输入与约束\n- 参数列表（名称、类型/shape、默认值）：\n  - indices: int32/int64 Tensor [nnz, rank]\n  - values: 任意dtype Tensor [nnz]\n  - shape: int64 Tensor [rank]\n  - dense_tensor: 任意dtype Tensor\n  - adjoint_a/adjoint_b: bool (默认False)\n  - validate_indices: bool (默认True)\n  - name: str (默认None)\n\n- 有效取值范围/维度/设备要求：\n  - indices 必须按字典序排序且不重复\n  - shape 元素必须为正整数\n  - 稀疏矩阵乘法要求矩阵维度兼容\n  - 支持 CPU/GPU 设备\n\n- 必需与可选组合：\n  - 稀疏张量三要素必须同时提供 (indices, values, shape)\n  - 转换函数至少需要一个输入张量\n  - 矩阵运算需要两个操作数\n\n- 随机性/全局状态要求：\n  - 无随机性要求\n  - 无全局状态依赖\n\n## 3. 输出与判定\n- 期望返回结构及关键字段：\n  - SparseTensor: indices, values, shape 属性\n  - 密集 Tensor: 与输入形状匹配\n  - 矩阵运算结果: 符合数学定义\n\n- 容差/误差界（如浮点）：\n  - 浮点运算误差在 1e-6 范围内\n  - 整数运算精确匹配\n  - 形状转换零误差\n\n- 状态变化或副作用检查点：\n  - 无文件系统操作\n  - 无网络访问\n  - 无全局变量修改\n\n## 4. 错误与异常场景\n- 非法输入/维度/类型触发的异常或警告：\n  - 未排序 indices 触发 InvalidArgumentError\n  - 重复 indices 触发 InvalidArgumentError\n  - 维度不匹配触发 ValueError\n  - 类型不匹配触发 TypeError\n  - 负 shape 值触发 InvalidArgumentError\n\n- 边界值（空、None、0 长度、极端形状/数值）：\n  - 空稀疏张量 (nnz=0)\n  - 全零密集张量转换\n  - 极大形状 (接近 int64 上限)\n  - 极端稀疏度 (nnz << prod(shape))\n  - 浮点特殊值 (inf, nan, -0)\n\n## 5. 依赖与环境\n- 外部资源/设备/网络/文件依赖：\n  - TensorFlow 运行时环境\n  - 无外部网络/文件依赖\n\n- 需要 mock/monkeypatch 的部分：\n  - `tensorflow.python.ops.gen_sparse_ops` (底层操作)\n  - `tensorflow.python.framework.ops` (图模式)\n  - `tensorflow.python.eager.context` (执行上下文)\n\n## 6. 覆盖与优先级\n- 必测路径（高优先级，最多 5 条，短句）：\n  1. 密集到稀疏转换验证索引排序\n  2. 稀疏到密集转换验证值填充\n  3. 稀疏矩阵乘法维度兼容性\n  4. 边界条件处理（空张量、极端形状）\n  5. 异常输入触发正确错误类型\n\n- 可选路径（中/低优先级合并为一组列表）：\n  - 不同数据类型组合测试\n  - 跨设备（CPU/GPU）一致性\n  - 图模式与 eager 模式等价性\n  - 性能基准（大尺寸张量）\n  - 内存使用验证\n\n- 已知风险/缺失信息（仅列条目，不展开）：\n  - 部分函数文档不完整\n  - 边界条件细节缺失\n  - 性能约束未明确\n  - 异常处理细节不足",
    "test_plan.json": "{\n  \"plan_version\": 2,\n  \"target\": \"tensorflow.python.ops.sparse_ops\",\n  \"block_rules\": {\n    \"header_block\": \"HEADER\",\n    \"footer_block\": \"FOOTER\",\n    \"case_prefix\": \"CASE_\",\n    \"case_format\": \"CASE_01\"\n  },\n  \"iteration_strategy\": {\n    \"round1\": {\"include\": \"SMOKE_SET\", \"assert_level\": \"weak\", \"max_blocks\": 5},\n    \"roundN\": {\"only_fix_failed_blocks\": true, \"block_limit\": 3, \"promote_deferred\": true},\n    \"final\": {\"enable_strong_asserts\": true, \"coverage_optional\": true}\n  },\n  \"test_files\": {\n    \"default\": \"tests/test_tensorflow_python_ops_sparse_ops.py\",\n    \"all_pattern\": \"tests/test_tensorflow_python_ops_sparse_ops.py\"\n  },\n  \"cases\": [\n    {\n      \"tc_id\": \"TC-01\",\n      \"block_id\": \"CASE_01\",\n      \"name\": \"from_dense 基本转换\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"dtype\": \"float32\",\n          \"shape\": [5],\n          \"dense_values\": [0, 0, 3, 0, 1],\n          \"expected_indices\": [[2], [4]],\n          \"expected_values\": [3.0, 1.0]\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"shape_match\", \"dtype_match\", \"indices_correct\", \"values_correct\"],\n        \"strong\": [\"sparse_properties\", \"roundtrip_consistency\", \"lexicographic_order\"]\n      },\n      \"oracle\": \"tensorflow.sparse.from_dense\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"S\",\n      \"max_lines\": 70,\n      \"max_params\": 5,\n      \"is_parametrized\": true,\n      \"requires_mock\": false,\n      \"mock_targets\": []\n    },\n    {\n      \"tc_id\": \"TC-02\",\n      \"block_id\": \"CASE_02\",\n      \"name\": \"sparse_to_dense 基本填充\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"indices\": [[0, 0], [1, 2]],\n          \"values\": [1.0, 2.0],\n          \"shape\": [3, 4],\n          \"default_value\": 0.0,\n          \"dtype\": \"float32\"\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"output_shape\", \"dtype_match\", \"sparse_values_placed\", \"default_filled\"],\n        \"strong\": [\"exact_value_match\", \"edge_cases\", \"performance_check\"]\n      },\n      \"oracle\": \"tensorflow.sparse.to_dense\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"S\",\n      \"max_lines\": 75,\n      \"max_params\": 6,\n      \"is_parametrized\": true,\n      \"requires_mock\": false,\n      \"mock_targets\": []\n    },\n    {\n      \"tc_id\": \"TC-03\",\n      \"block_id\": \"CASE_03\",\n      \"name\": \"sparse_tensor_dense_mat_mul 矩阵乘法\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"sparse_shape\": [2, 3],\n          \"sparse_indices\": [[0, 1], [1, 2]],\n          \"sparse_values\": [2.0, 3.0],\n          \"dense_shape\": [3, 2],\n          \"dtype\": \"float32\"\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"result_shape\", \"dtype_match\", \"basic_calculation\", \"dimension_compatibility\"],\n        \"strong\": [\"numerical_accuracy\", \"adjoint_operations\", \"large_scale_validation\"]\n      },\n      \"oracle\": \"手动计算验证\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"M\",\n      \"max_lines\": 85,\n      \"max_params\": 7,\n      \"is_parametrized\": true,\n      \"requires_mock\": true,\n      \"mock_targets\": [\n        \"tensorflow.python.ops.gen_sparse_ops\",\n        \"tensorflow.python.framework.ops\",\n        \"tensorflow.python.eager.context\"\n      ]\n    },\n    {\n      \"tc_id\": \"TC-04\",\n      \"block_id\": \"CASE_04\",\n      \"name\": \"边界条件 - 空稀疏张量\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"indices\": [],\n          \"values\": [],\n          \"shape\": [3, 4],\n          \"dtype\": \"float32\",\n          \"operation\": \"to_dense\"\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"empty_handling\", \"shape_preserved\", \"all_default_values\"],\n        \"strong\": [\"memory_efficiency\", \"performance_characteristics\"]\n      },\n      \"oracle\": \"理论预期\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"S\",\n      \"max_lines\": 65,\n      \"max_params\": 5,\n      \"is_parametrized\": true,\n      \"requires_mock\": false,\n      \"mock_targets\": []\n    },\n    {\n      \"tc_id\": \"TC-05\",\n      \"block_id\": \"CASE_05\",\n      \"name\": \"异常输入验证\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"test_type\": \"unsorted_indices\",\n          \"indices\": [[1, 0], [0, 0]],\n          \"values\": [1.0, 2.0],\n          \"shape\": [2, 2],\n          \"dtype\": \"float32\",\n          \"expected_error\": \"InvalidArgumentError\"\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"error_type_match\", \"error_message_contains\", \"no_side_effects\"],\n        \"strong\": [\"error_context\", \"recovery_behavior\"]\n      },\n      \"oracle\": \"TensorFlow 异常规范\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"S\",\n      \"max_lines\": 70,\n      \"max_params\": 6,\n      \"is_parametrized\": true,\n      \"requires_mock\": false,\n      \"mock_targets\": []\n    }\n  ],\n  \"param_extensions\": [\n    {\n      \"base_block_id\": \"CASE_01\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"dtype\": \"int32\",\n        \"shape\": [3, 3],\n        \"dense_values\": [[0, 5, 0], [0, 0, 0], [2, 0, 8]],\n        \"expected_indices\": [[0, 1], [2, 0], [2, 2]],\n        \"expected_values\": [5, 2, 8]\n      },\n      \"note\": \"二维整数张量转换\"\n    },\n    {\n      \"base_block_id\": \"CASE_01\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"dtype\": \"float64\",\n        \"shape\": [10],\n        \"dense_values\": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],\n        \"expected_indices\": [],\n        \"expected_values\": []\n      },\n      \"note\": \"全零密集张量\"\n    },\n    {\n      \"base_block_id\": \"CASE_02\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"indices\": [[0], [2], [4]],\n        \"values\": [10, 20, 30],\n        \"shape\": [5],\n        \"default_value\": -1.0,\n        \"dtype\": \"float32\"\n      },\n      \"note\": \"一维张量不同默认值\"\n    },\n    {\n      \"base_block_id\": \"CASE_03\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"sparse_shape\": [4, 4],\n        \"sparse_indices\": [[0, 0], [1, 1], [2, 2], [3, 3]],\n        \"sparse_values\": [1.0, 1.0, 1.0, 1.0],\n        \"dense_shape\": [4, 4],\n        \"dtype\": \"float64\",\n        \"adjoint_a\": true\n      },\n      \"note\": \"伴随操作和双精度\"\n    },\n    {\n      \"base_block_id\": \"CASE_04\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"indices\": [],\n        \"values\": [],\n        \"shape\": [1000, 1000],\n        \"dtype\": \"float32\",\n        \"operation\": \"from_dense\"\n      },\n      \"note\": \"大形状空张量\"\n    }\n  ],\n  \"smoke_set\": [\"CASE_01\", \"CASE_02\", \"CASE_03\"],\n  \"deferred_set\": [\"CASE_04\", \"CASE_05\"]\n}",
    "test_plan.md": "# tensorflow.python.ops.sparse_ops 测试计划\n\n## 1. 测试策略\n- 单元测试框架：pytest\n- 隔离策略：mock/monkeypatch/fixtures（针对底层gen_sparse_ops）\n- 随机性处理：固定随机种子，确定性测试数据生成\n- 执行模式：支持eager和graph模式验证\n\n## 2. 生成规格摘要（来自test_plan.json）\n- **SMOKE_SET**: CASE_01 (from_dense基本转换), CASE_02 (sparse_to_dense基本填充), CASE_03 (稀疏矩阵乘法)\n- **DEFERRED_SET**: CASE_04 (边界条件-空稀疏张量), CASE_05 (异常输入验证)\n- **测试文件路径**: tests/test_tensorflow_python_ops_sparse_ops.py（单文件）\n- **断言分级策略**: 首轮使用weak断言（形状、类型、基本属性），后续启用strong断言（数值精度、性能）\n- **预算策略**: \n  - Size S: 65-75行，5-6参数\n  - Size M: 85行，7参数\n  - 所有用例参数化，减少重复代码\n\n## 3. 数据与边界\n- **正常数据集**: 小规模稀疏张量（1D/2D），非零值随机分布\n- **随机生成策略**: 固定种子，控制稀疏度（10-30%）\n- **边界值**:\n  - 空稀疏张量（nnz=0）\n  - 全零密集张量转换\n  - 单元素稀疏张量\n  - 极端稀疏度（nnz=1, shape大）\n- **极端形状**:\n  - 一维长向量（shape=[1000]）\n  - 二维大矩阵（shape=[100,100]）\n  - 高维张量（rank>2）\n- **空输入**: 空索引、空值数组\n- **负例与异常场景**:\n  - 未排序索引触发InvalidArgumentError\n  - 重复索引触发InvalidArgumentError\n  - 维度不匹配触发ValueError\n  - 负shape值触发InvalidArgumentError\n  - 类型不匹配触发TypeError\n\n## 4. 覆盖映射\n| TC_ID | 需求覆盖 | 约束验证 | 优先级 |\n|-------|----------|----------|--------|\n| TC-01 | 密集到稀疏转换 | 索引排序、值提取 | High |\n| TC-02 | 稀疏到密集转换 | 值填充、默认值处理 | High |\n| TC-03 | 稀疏矩阵乘法 | 维度兼容、数学正确性 | High |\n| TC-04 | 边界条件处理 | 空张量、极端形状 | High |\n| TC-05 | 异常输入验证 | 错误类型、错误消息 | High |\n\n### 尚未覆盖的风险点\n- 跨设备（CPU/GPU）一致性验证\n- 图模式与eager模式等价性\n- 大尺寸张量性能基准\n- 内存使用模式验证\n- 浮点特殊值（inf, nan）处理\n\n### 迭代策略\n1. **首轮（Round1）**: 仅生成SMOKE_SET（3个核心用例），使用weak断言\n2. **后续轮次（RoundN）**: 修复失败用例，每次最多处理3个block，提升deferred用例\n3. **最终轮（Final）**: 启用strong断言，可选覆盖率目标\n\n### Mock策略\n- CASE_03需要mock底层gen_sparse_ops、framework.ops、eager.context\n- 其他用例无需mock，直接测试公共API\n- mock目标确保与requirements中的约束一致",
    "tests/test_tensorflow_python_ops_sparse_ops.py": "\"\"\"\nTest cases for tensorflow.python.ops.sparse_ops module.\nGenerated by TestAgent.\n\"\"\"\n\nimport math\nimport numpy as np\nimport pytest\nimport tensorflow as tf\nfrom tensorflow.python.ops import sparse_ops\n\n# Set random seed for reproducibility\nnp.random.seed(42)\ntf.random.set_seed(42)\n\n# ==== BLOCK:HEADER START ====\n# Header block - imports and common fixtures\n# ==== BLOCK:HEADER END ====\n\n# ==== BLOCK:CASE_01 START ====\n# Test case: from_dense 基本转换\n# ==== BLOCK:CASE_01 END ====\n\n# ==== BLOCK:CASE_02 START ====\n# Test case: sparse_to_dense 基本填充\n# ==== BLOCK:CASE_02 END ====\n\n# ==== BLOCK:CASE_03 START ====\n# Test case: sparse_tensor_dense_mat_mul 矩阵乘法\n# ==== BLOCK:CASE_03 END ====\n\n# ==== BLOCK:CASE_04 START ====\n# Test case: 边界条件 - 空稀疏张量 (deferred placeholder)\n# ==== BLOCK:CASE_04 END ====\n\n# ==== BLOCK:CASE_05 START ====\n# Test case: 异常输入验证 (deferred placeholder)\n# ==== BLOCK:CASE_05 END ====\n\n# ==== BLOCK:FOOTER START ====\n# Footer block - cleanup and additional helpers\n# ==== BLOCK:FOOTER END ====",
    "execution_log.txt": "=== Run Tests ===\n.........FF.                                                             [100%]\n=================================== FAILURES ===================================\n_ test_invalid_input_validation[unsorted_indices-indices0-values0-shape0-float32-InvalidArgumentError-indices are not sorted] _\n\ntest_type = 'unsorted_indices', indices = [[1, 0], [0, 0]], values = [1.0, 2.0]\nshape = [2, 2], dtype_str = 'float32'\nexpected_error_type = <class 'tensorflow.python.framework.errors_impl.InvalidArgumentError'>\nexpected_error_message = 'indices are not sorted'\n\n    @pytest.mark.parametrize(\n        \"test_type,indices,values,shape,dtype_str,expected_error_type,expected_error_message\",\n        [\n            # Unsorted indices case from test plan\n            (\n                \"unsorted_indices\",\n                [[1, 0], [0, 0]],\n                [1.0, 2.0],\n                [2, 2],\n                \"float32\",\n                tf.errors.InvalidArgumentError,\n                \"indices are not sorted\"\n            ),\n            # Additional test: duplicate indices\n            (\n                \"duplicate_indices\",\n                [[0, 0], [0, 0]],\n                [1.0, 2.0],\n                [2, 2],\n                \"float32\",\n                tf.errors.InvalidArgumentError,\n                \"indices are not sorted\"\n            ),\n            # Additional test: out of bounds indices\n            (\n                \"out_of_bounds\",\n                [[0, 0], [2, 2]],\n                [1.0, 2.0],\n                [2, 2],\n                \"float32\",\n                tf.errors.InvalidArgumentError,\n                \"out of bounds\"\n            ),\n        ]\n    )\n    def test_invalid_input_validation(\n        test_type, indices, values, shape, dtype_str, expected_error_type, expected_error_message\n    ):\n        \"\"\"Test validation of invalid inputs for sparse operations.\"\"\"\n        # Convert dtype string to tf dtype\n        dtype_map = {\n            \"float32\": tf.float32,\n            \"float64\": tf.float64,\n            \"int32\": tf.int32,\n        }\n        dtype = dtype_map[dtype_str]\n    \n        # Create tensor components\n        sparse_indices = tf.constant(indices, dtype=tf.int64)\n        sparse_values = tf.constant(values, dtype=dtype)\n        output_shape = tf.constant(shape, dtype=tf.int64)\n        default_value = tf.constant(0.0, dtype=dtype)\n    \n        # Test 1: sparse_to_dense with validate_indices=True should raise error\n        with pytest.raises(expected_error_type) as exc_info:\n            sparse_ops.sparse_to_dense(\n                sparse_indices=sparse_indices,\n                output_shape=output_shape,\n                sparse_values=sparse_values,\n                default_value=default_value,\n                validate_indices=True  # This should trigger validation\n            )\n    \n        # Check error message contains expected text\n        error_message = str(exc_info.value)\n>       assert expected_error_message.lower() in error_message.lower(), \\\n            f\"Expected error message containing '{expected_error_message}', got: {error_message}\"\nE       AssertionError: Expected error message containing 'indices are not sorted', got: indices[1] = [0,0] is out of order. Many sparse ops require sorted indices.\nE             Use `tf.sparse.reorder` to create a correctly ordered copy.\nE         \nE          [Op:SparseToDense]\nE       assert 'indices are not sorted' in 'indices[1] = [0,0] is out of order. many sparse ops require sorted indices.\\n    use `tf.sparse.reorder` to create a correctly ordered copy.\\n\\n [op:sparsetodense]'\nE        +  where 'indices are not sorted' = <built-in method lower of str object at 0x10638e830>()\nE        +    where <built-in method lower of str object at 0x10638e830> = 'indices are not sorted'.lower\nE        +  and   'indices[1] = [0,0] is out of order. many sparse ops require sorted indices.\\n    use `tf.sparse.reorder` to create a correctly ordered copy.\\n\\n [op:sparsetodense]' = <built-in method lower of str object at 0x300b9f050>()\nE        +    where <built-in method lower of str object at 0x300b9f050> = 'indices[1] = [0,0] is out of order. Many sparse ops require sorted indices.\\n    Use `tf.sparse.reorder` to create a correctly ordered copy.\\n\\n [Op:SparseToDense]'.lower\n\ntests/test_tensorflow_python_ops_sparse_ops.py:626: AssertionError\n----------------------------- Captured stderr call -----------------------------\n2026-01-25 18:09:37.885651: W tensorflow/core/framework/op_kernel.cc:1745] OP_REQUIRES failed at sparse_to_dense_op.cc:162 : INVALID_ARGUMENT: indices[1] = [0,0] is out of order. Many sparse ops require sorted indices.\n    Use `tf.sparse.reorder` to create a correctly ordered copy.\n\n\n_ test_invalid_input_validation[duplicate_indices-indices1-values1-shape1-float32-InvalidArgumentError-indices are not sorted] _\n\ntest_type = 'duplicate_indices', indices = [[0, 0], [0, 0]], values = [1.0, 2.0]\nshape = [2, 2], dtype_str = 'float32'\nexpected_error_type = <class 'tensorflow.python.framework.errors_impl.InvalidArgumentError'>\nexpected_error_message = 'indices are not sorted'\n\n    @pytest.mark.parametrize(\n        \"test_type,indices,values,shape,dtype_str,expected_error_type,expected_error_message\",\n        [\n            # Unsorted indices case from test plan\n            (\n                \"unsorted_indices\",\n                [[1, 0], [0, 0]],\n                [1.0, 2.0],\n                [2, 2],\n                \"float32\",\n                tf.errors.InvalidArgumentError,\n                \"indices are not sorted\"\n            ),\n            # Additional test: duplicate indices\n            (\n                \"duplicate_indices\",\n                [[0, 0], [0, 0]],\n                [1.0, 2.0],\n                [2, 2],\n                \"float32\",\n                tf.errors.InvalidArgumentError,\n                \"indices are not sorted\"\n            ),\n            # Additional test: out of bounds indices\n            (\n                \"out_of_bounds\",\n                [[0, 0], [2, 2]],\n                [1.0, 2.0],\n                [2, 2],\n                \"float32\",\n                tf.errors.InvalidArgumentError,\n                \"out of bounds\"\n            ),\n        ]\n    )\n    def test_invalid_input_validation(\n        test_type, indices, values, shape, dtype_str, expected_error_type, expected_error_message\n    ):\n        \"\"\"Test validation of invalid inputs for sparse operations.\"\"\"\n        # Convert dtype string to tf dtype\n        dtype_map = {\n            \"float32\": tf.float32,\n            \"float64\": tf.float64,\n            \"int32\": tf.int32,\n        }\n        dtype = dtype_map[dtype_str]\n    \n        # Create tensor components\n        sparse_indices = tf.constant(indices, dtype=tf.int64)\n        sparse_values = tf.constant(values, dtype=dtype)\n        output_shape = tf.constant(shape, dtype=tf.int64)\n        default_value = tf.constant(0.0, dtype=dtype)\n    \n        # Test 1: sparse_to_dense with validate_indices=True should raise error\n        with pytest.raises(expected_error_type) as exc_info:\n            sparse_ops.sparse_to_dense(\n                sparse_indices=sparse_indices,\n                output_shape=output_shape,\n                sparse_values=sparse_values,\n                default_value=default_value,\n                validate_indices=True  # This should trigger validation\n            )\n    \n        # Check error message contains expected text\n        error_message = str(exc_info.value)\n>       assert expected_error_message.lower() in error_message.lower(), \\\n            f\"Expected error message containing '{expected_error_message}', got: {error_message}\"\nE       AssertionError: Expected error message containing 'indices are not sorted', got: indices[1] = [0,0] is repeated [Op:SparseToDense]\nE       assert 'indices are not sorted' in 'indices[1] = [0,0] is repeated [op:sparsetodense]'\nE        +  where 'indices are not sorted' = <built-in method lower of str object at 0x10638e830>()\nE        +    where <built-in method lower of str object at 0x10638e830> = 'indices are not sorted'.lower\nE        +  and   'indices[1] = [0,0] is repeated [op:sparsetodense]' = <built-in method lower of str object at 0x30159dbc0>()\nE        +    where <built-in method lower of str object at 0x30159dbc0> = 'indices[1] = [0,0] is repeated [Op:SparseToDense]'.lower\n\ntests/test_tensorflow_python_ops_sparse_ops.py:626: AssertionError\n----------------------------- Captured stderr call -----------------------------\n2026-01-25 18:09:37.994297: W tensorflow/core/framework/op_kernel.cc:1745] OP_REQUIRES failed at sparse_to_dense_op.cc:162 : INVALID_ARGUMENT: indices[1] = [0,0] is repeated\n=============================== warnings summary ===============================\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:18\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:18: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:36\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:36: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:43\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:43: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:29\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:29: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _TENSORSHAPEPROTO_DIM = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:73\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:73: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:80\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:80: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:66\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:66: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _TENSORSHAPEPROTO = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:19\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:19: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:33\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:33: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:37\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:37: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:41\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:41: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:45\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:45: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:49\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:49: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:53\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:53: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:57\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:57: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:61\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:61: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:65\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:65: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:69\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:69: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:73\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:73: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:77\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:77: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:81\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:81: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:85\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:85: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:89\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:89: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:93\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:93: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:97\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:97: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:101\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:101: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:105\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:105: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:109\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:109: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:113\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:113: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:117\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:117: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:121\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:121: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:125\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:125: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:129\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:129: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:133\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:133: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:137\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:137: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:141\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:141: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:145\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:145: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:149\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:149: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:153\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:153: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:157\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:157: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:161\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:161: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:165\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:165: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:169\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:169: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:173\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:173: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:177\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:177: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:181\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:181: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:185\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:185: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:189\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:189: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:193\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:193: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:197\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:197: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:201\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:201: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:205\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:205: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:209\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:209: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:213\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:213: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:217\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:217: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:27\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:27: DeprecationWarning: Call to deprecated create function EnumDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _DATATYPE = _descriptor.EnumDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:20\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:20: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:39\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:39: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:46\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:46: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:32\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:32: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _RESOURCEHANDLEPROTO_DTYPEANDSHAPE = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:76\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:76: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:83\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:83: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:90\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:90: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:97\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:97: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:104\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:104: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:111\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:111: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:69\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:69: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _RESOURCEHANDLEPROTO = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:21\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:21: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:40\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:40: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:47\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:47: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:54\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:54: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:61\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:61: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:68\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:68: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:75\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:75: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:82\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:82: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:89\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:89: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:96\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:96: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:103\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:103: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:110\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:110: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:117\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:117: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:124\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:124: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:131\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:131: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:138\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:138: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:145\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:145: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:152\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:152: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:33\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:33: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _TENSORPROTO = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:183\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:183: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:190\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:190: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:197\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:197: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:176\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:176: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _VARIANTTENSORDATAPROTO = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:21\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:21: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:40\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:40: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:47\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:47: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:54\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:54: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:61\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:61: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:68\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:68: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:75\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:75: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:82\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:82: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:89\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:89: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:33\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:33: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _ATTRVALUE_LISTVALUE = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/framework/dtypes.py:205\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/framework/dtypes.py:205: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)\n    np.bool8: (False, True),\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/flatbuffers/compat.py:19\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/flatbuffers/compat.py:19: DeprecationWarning: the imp module is deprecated in favour of importlib and slated for removal in Python 3.12; see the module's documentation for alternative uses\n    import imp\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:326\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:326: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)\n    np.bool8: (False, True),\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n================================ tests coverage ================================\n______________ coverage: platform darwin, python 3.10.19-final-0 _______________\n\nName                                             Stmts   Miss Branch BrPart  Cover   Missing\n--------------------------------------------------------------------------------------------\ntests/test_tensorflow_python_ops_sparse_ops.py     211     52     66     14    73%   39-51, 56, 65, 225->221, 239, 266, 437, 471, 493, 498->553, 532, 544->553, 639-650, 667-669, 674-688, 693-711, 725-745, 755, 760\n--------------------------------------------------------------------------------------------\nTOTAL                                              211     52     66     14    73%\nCoverage XML written to file coverage.xml\n=========================== short test summary info ============================\nFAILED tests/test_tensorflow_python_ops_sparse_ops.py::test_invalid_input_validation[unsorted_indices-indices0-values0-shape0-float32-InvalidArgumentError-indices are not sorted]\nFAILED tests/test_tensorflow_python_ops_sparse_ops.py::test_invalid_input_validation[duplicate_indices-indices1-values1-shape1-float32-InvalidArgumentError-indices are not sorted]\n2 failed, 10 passed, 103 warnings in 1.49s\n\nError: exit 1",
    "exit_code.txt": "1",
    "analysis_plan.json": "{\n  \"status\": \"未完全通过\",\n  \"passed\": 10,\n  \"failed\": 2,\n  \"errors\": 0,\n  \"collection_errors\": false,\n  \"block_limit\": 3,\n  \"failures\": [\n    {\n      \"test\": \"tests/test_tensorflow_python_ops_sparse_ops.py::test_invalid_input_validation[unsorted_indices-indices0-values0-shape0-float32-InvalidArgumentError-indices are not sorted]\",\n      \"block_id\": \"CASE_05\",\n      \"error_type\": \"AssertionError\",\n      \"action\": \"adjust_assertion\",\n      \"note\": \"错误消息不匹配：期望'indices are not sorted'，实际'indices[1] = [0,0] is out of order...'\"\n    },\n    {\n      \"test\": \"tests/test_tensorflow_python_ops_sparse_ops.py::test_invalid_input_validation[duplicate_indices-indices1-values1-shape1-float32-InvalidArgumentError-indices are not sorted]\",\n      \"block_id\": \"CASE_05\",\n      \"error_type\": \"AssertionError\",\n      \"action\": \"adjust_assertion\",\n      \"note\": \"错误消息不匹配：期望'indices are not sorted'，实际'indices[1] = [0,0] is repeated'\"\n    }\n  ],\n  \"deferred\": [],\n  \"stop_recommended\": true,\n  \"stop_reason\": \"与上一轮失败集合完全重复：两个测试用例在CASE_05中持续失败，错误消息验证不匹配\"\n}",
    "analysis.md": "## 测试执行结果分析\n\n### 状态与统计\n- **状态**: 未完全通过\n- **通过**: 10个测试\n- **失败**: 2个测试\n- **错误**: 0个错误\n- **覆盖率**: 73%\n\n### 待修复 BLOCK 列表\n1. **BLOCK_ID**: CASE_05\n   - **Action**: adjust_assertion\n   - **Error Type**: AssertionError\n   - **Note**: 错误消息验证不匹配，需要调整断言以匹配TensorFlow实际错误消息\n\n### 停止建议\n- **stop_recommended**: true\n- **stop_reason**: 与上一轮失败集合完全重复：两个测试用例在CASE_05中持续失败，错误消息验证不匹配",
    "final_report.md": "# tensorflow.python.ops.sparse_ops 测试报告\n\n## 1. 执行摘要\n测试基本通过但存在错误消息验证问题，核心功能验证成功但异常处理测试需要调整。\n\n**关键发现**：\n- 10个测试通过，2个测试失败（均在CASE_05异常验证场景）\n- 核心功能（稀疏-密集转换、稀疏矩阵乘法）验证成功\n- 错误消息断言不匹配导致测试失败，需要调整验证逻辑\n\n## 2. 测试范围\n**目标FQN**: `tensorflow.python.ops.sparse_ops`\n\n**测试环境**:\n- 框架：pytest\n- TensorFlow版本：Python 3.10环境\n- 依赖：TensorFlow运行时，无外部网络/文件依赖\n\n**覆盖场景**:\n- ✓ 密集到稀疏转换（from_dense）\n- ✓ 稀疏到密集转换（sparse_to_dense）\n- ✓ 稀疏矩阵乘法（sparse_tensor_dense_mat_mul）\n- ✓ 边界条件处理（空稀疏张量）\n- ✓ 异常输入验证（部分失败）\n\n**未覆盖项**:\n- 跨设备（CPU/GPU）一致性验证\n- 图模式与eager模式等价性\n- 大尺寸张量性能基准\n- 内存使用模式验证\n- 浮点特殊值（inf, nan）处理\n\n## 3. 结果概览\n- **用例总数**: 12个测试（5个测试用例参数化）\n- **通过**: 10个（83.3%）\n- **失败**: 2个（16.7%）\n- **错误**: 0个\n- **覆盖率**: 73%\n\n**主要失败点**:\n1. CASE_05中的错误消息验证不匹配\n   - 预期错误消息与实际TensorFlow抛出的错误消息不一致\n   - 涉及未排序索引和重复索引的异常场景\n\n## 4. 详细发现\n\n### 高优先级问题\n**问题1**: 错误消息验证失败\n- **严重级别**: 中（测试逻辑问题，不影响功能）\n- **根因**: 测试代码中的错误消息断言与TensorFlow实际抛出的错误消息不匹配\n- **影响**: 导致异常验证测试失败，但功能本身正常\n- **建议修复**:\n  1. 检查TensorFlow实际抛出的错误消息格式\n  2. 调整测试断言以匹配实际错误消息\n  3. 考虑使用错误类型验证而非精确消息匹配\n\n**问题2**: 异常处理测试覆盖不足\n- **严重级别**: 低\n- **根因**: 仅验证了部分异常场景\n- **影响**: 异常处理逻辑验证不完整\n- **建议修复**:\n  1. 补充维度不匹配、类型不匹配等异常场景\n  2. 验证负shape值等边界异常\n\n## 5. 覆盖与风险\n\n**需求覆盖情况**:\n- ✓ 密集到稀疏转换验证索引排序\n- ✓ 稀疏到密集转换验证值填充  \n- ✓ 稀疏矩阵乘法维度兼容性\n- ✓ 边界条件处理（空张量、极端形状）\n- ⚠ 异常输入触发正确错误类型（部分失败）\n\n**尚未覆盖的边界/缺失信息**:\n1. **性能约束**: 文档中未明确性能要求，测试未包含性能基准\n2. **设备兼容性**: 未验证CPU/GPU一致性\n3. **执行模式**: 未验证图模式与eager模式等价性\n4. **数据类型**: 未覆盖所有支持的数据类型组合\n5. **内存模式**: 未验证大尺寸张量的内存使用\n\n**风险点**:\n- 异常处理细节在文档中不完整\n- 边界条件细节缺失\n- 性能约束未明确，可能影响生产环境使用\n\n## 6. 后续动作\n\n### 高优先级（立即执行）\n1. **修复错误消息断言** (CASE_05)\n   - 检查TensorFlow实际错误消息格式\n   - 调整测试断言逻辑\n   - 考虑使用错误类型验证替代精确消息匹配\n   - 预计工作量：1-2小时\n\n### 中优先级（下一迭代）\n2. **补充异常场景测试**\n   - 添加维度不匹配异常验证\n   - 添加类型不匹配异常验证  \n   - 添加负shape值异常验证\n   - 预计工作量：2-3小时\n\n3. **扩展边界条件测试**\n   - 添加浮点特殊值（inf, nan）处理测试\n   - 添加极端稀疏度场景\n   - 添加高维张量测试\n   - 预计工作量：3-4小时\n\n### 低优先级（可选）\n4. **设备与执行模式验证**\n   - 验证CPU/GPU一致性\n   - 验证图模式与eager模式等价性\n   - 预计工作量：4-5小时\n\n5. **性能与内存基准**\n   - 添加大尺寸张量性能测试\n   - 验证内存使用模式\n   - 预计工作量：5-6小时\n\n### 测试质量改进\n6. **断言策略优化**\n   - 从weak断言升级到strong断言\n   - 添加数值精度验证\n   - 预计工作量：2-3小时\n\n**总体建议**: 优先修复错误消息验证问题，确保现有测试全部通过，然后逐步扩展测试覆盖范围，重点关注异常处理和边界条件验证。"
  },
  "stage_history": [
    {
      "stage": "understand_function",
      "status": "completed",
      "timestamp": "2026-01-25T17:48:25.062950",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "generate_requirements",
      "status": "completed",
      "timestamp": "2026-01-25T17:49:05.312487",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "design_test_plan",
      "status": "completed",
      "timestamp": "2026-01-25T17:50:54.531252",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-25T17:54:56.059236",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-25T17:54:58.966550",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-25T17:56:29.262164",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-25T17:59:18.409043",
      "attempts": 2,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-25T17:59:20.539836",
      "attempts": 2,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-25T18:00:27.901642",
      "attempts": 2,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-25T18:02:46.202352",
      "attempts": 3,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-25T18:02:48.891229",
      "attempts": 3,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-25T18:03:40.622496",
      "attempts": 3,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-25T18:06:18.815277",
      "attempts": 4,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-25T18:06:21.487608",
      "attempts": 4,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-25T18:07:12.969537",
      "attempts": 4,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-25T18:09:36.347484",
      "attempts": 5,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-25T18:09:38.392162",
      "attempts": 5,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-25T18:10:45.166734",
      "attempts": 5,
      "error": null
    },
    {
      "stage": "generate_report",
      "status": "completed",
      "timestamp": "2026-01-25T18:11:38.262109",
      "attempts": 1,
      "error": null
    }
  ],
  "user_feedback": []
}