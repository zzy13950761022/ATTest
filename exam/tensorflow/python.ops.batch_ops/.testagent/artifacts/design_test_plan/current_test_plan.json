{
  "plan_version": 2,
  "target": "tensorflow.python.ops.batch_ops",
  "block_rules": {
    "header_block": "HEADER",
    "footer_block": "FOOTER",
    "case_prefix": "CASE_",
    "case_format": "CASE_01"
  },
  "iteration_strategy": {
    "round1": {
      "include": "SMOKE_SET",
      "assert_level": "weak",
      "max_blocks": 5
    },
    "roundN": {
      "only_fix_failed_blocks": true,
      "block_limit": 3,
      "promote_deferred": true
    },
    "final": {
      "enable_strong_asserts": true,
      "coverage_optional": true
    }
  },
  "test_files": {
    "single": "tests/test_tensorflow_python_ops_batch_ops.py",
    "default": "tests/test_tensorflow_python_ops_batch_ops.py",
    "all_pattern": "tests/test_tensorflow_python_ops_batch_ops_*.py"
  },
  "cases": [
    {
      "tc_id": "TC-01",
      "block_id": "CASE_01",
      "name": "基本装饰器功能",
      "priority": "High",
      "param_matrix": [
        {
          "num_batch_threads": 1,
          "max_batch_size": 2,
          "batch_timeout_micros": 1000,
          "allowed_batch_sizes": null,
          "max_enqueued_batches": 10,
          "autograph": true,
          "enable_large_batch_splitting": true,
          "input_shape": [2, 3],
          "dtype": "float32"
        }
      ],
      "asserts": {
        "weak": ["装饰器创建成功", "函数可调用", "返回Tensor类型"],
        "strong": ["输出形状正确", "数值计算正确", "批处理维度正确"]
      },
      "oracle": "batch_function",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 80,
      "max_params": 8,
      "is_parametrized": true,
      "requires_mock": true,
      "mock_targets": [
        "tensorflow.python.ops.gen_batch_ops.batch_function",
        "tensorflow.python.eager.function.defun",
        "tensorflow.python.framework.tensor_spec.TensorSpec",
        "tensorflow.python.util.nest.pack_sequence_as"
      ],
      "note": "测试基本装饰器创建和调用功能"
    },
    {
      "tc_id": "TC-02",
      "block_id": "CASE_02",
      "name": "参数验证测试",
      "priority": "High",
      "param_matrix": [
        {
          "num_batch_threads": 2,
          "max_batch_size": 4,
          "batch_timeout_micros": 5000,
          "allowed_batch_sizes": [2, 4],
          "max_enqueued_batches": 5,
          "autograph": false,
          "enable_large_batch_splitting": false,
          "input_shape": [1, 5],
          "dtype": "float64"
        }
      ],
      "asserts": {
        "weak": ["装饰器创建成功", "allowed_batch_sizes验证通过", "参数传递正确"],
        "strong": ["参数验证逻辑正确", "边界条件检查", "错误参数拒绝"]
      },
      "oracle": "batch_function",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 80,
      "max_params": 8,
      "is_parametrized": true,
      "requires_mock": true,
      "mock_targets": [
        "tensorflow.python.ops.gen_batch_ops.batch_function",
        "tensorflow.python.eager.function.defun",
        "tensorflow.python.framework.tensor_spec.TensorSpec",
        "tensorflow.python.util.nest.pack_sequence_as",
        "tensorflow.python.ops.batch_ops._validate_allowed_batch_sizes"
      ],
      "note": "测试allowed_batch_sizes参数验证逻辑"
    },
    {
      "tc_id": "TC-03",
      "block_id": "CASE_03",
      "name": "错误处理测试",
      "priority": "High",
      "param_matrix": [
        {
          "num_batch_threads": 1,
          "max_batch_size": 2,
          "batch_timeout_micros": 1000,
          "allowed_batch_sizes": [1, 3],
          "max_enqueued_batches": 10,
          "autograph": true,
          "enable_large_batch_splitting": true,
          "input_shape": [2, 3],
          "dtype": "float32",
          "should_fail": true
        }
      ],
      "asserts": {
        "weak": ["异常类型正确", "错误消息包含关键词", "验证失败点正确"],
        "strong": ["异常触发条件完整", "错误处理逻辑正确", "边界情况覆盖"]
      },
      "oracle": "batch_function",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 80,
      "max_params": 9,
      "is_parametrized": true,
      "requires_mock": true,
      "mock_targets": [
        "tensorflow.python.ops.gen_batch_ops.batch_function",
        "tensorflow.python.eager.function.defun",
        "tensorflow.python.framework.tensor_spec.TensorSpec",
        "tensorflow.python.util.nest.pack_sequence_as",
        "tensorflow.python.ops.batch_ops._validate_allowed_batch_sizes"
      ],
      "note": "测试allowed_batch_sizes验证失败场景"
    },
    {
      "tc_id": "TC-04",
      "block_id": "CASE_04",
      "name": "并发批处理测试",
      "priority": "High",
      "param_matrix": [
        {
          "num_batch_threads": 2,
          "max_batch_size": 4,
          "batch_timeout_micros": 10000,
          "allowed_batch_sizes": null,
          "max_enqueued_batches": 20,
          "autograph": true,
          "enable_large_batch_splitting": true,
          "input_shape": [1, 3],
          "dtype": "float32",
          "concurrent_calls": 3
        }
      ],
      "asserts": {
        "weak": ["装饰器创建成功", "并发调用不崩溃", "基本功能正常"],
        "strong": ["并发批处理正确", "拼接维度正确", "超时处理正确"]
      },
      "oracle": "batch_function",
      "assertion_level": "weak",
      "size": "M",
      "max_lines": 100,
      "max_params": 9,
      "is_parametrized": true,
      "requires_mock": true,
      "mock_targets": [
        "tensorflow.python.ops.gen_batch_ops.batch_function",
        "tensorflow.python.eager.function.defun",
        "tensorflow.python.framework.tensor_spec.TensorSpec",
        "tensorflow.python.util.nest.pack_sequence_as",
        "tensorflow.python.ops.batch_ops._BatchFunction"
      ],
      "note": "测试多个会话并发调用时的批处理行为"
    },
    {
      "tc_id": "TC-05",
      "block_id": "CASE_05",
      "name": "超时处理测试",
      "priority": "High",
      "param_matrix": [
        {
          "num_batch_threads": 1,
          "max_batch_size": 2,
          "batch_timeout_micros": 0,
          "allowed_batch_sizes": null,
          "max_enqueued_batches": 10,
          "autograph": true,
          "enable_large_batch_splitting": true,
          "input_shape": [2, 3],
          "dtype": "float32"
        }
      ],
      "asserts": {
        "weak": ["装饰器创建成功", "零超时参数接受", "基本调用正常"],
        "strong": ["超时边界处理", "不完整批次处理", "性能边界测试"]
      },
      "oracle": "batch_function",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 80,
      "max_params": 8,
      "is_parametrized": true,
      "requires_mock": true,
      "mock_targets": [
        "tensorflow.python.ops.gen_batch_ops.batch_function",
        "tensorflow.python.eager.function.defun",
        "tensorflow.python.framework.tensor_spec.TensorSpec",
        "tensorflow.python.util.nest.pack_sequence_as"
      ],
      "note": "测试batch_timeout_micros边界值处理"
    }
  ],
  "param_extensions": [
    {
      "base_block_id": "CASE_01",
      "priority": "Medium",
      "params": {
        "num_batch_threads": 4,
        "max_batch_size": 8,
        "batch_timeout_micros": 10000,
        "allowed_batch_sizes": [2, 4, 8],
        "max_enqueued_batches": 20,
        "autograph": false,
        "enable_large_batch_splitting": false,
        "input_shape": [4, 5],
        "dtype": "float64"
      },
      "note": "扩展参数组合测试"
    },
    {
      "base_block_id": "CASE_02",
      "priority": "Medium",
      "params": {
        "num_batch_threads": 1,
        "max_batch_size": 1,
        "batch_timeout_micros": 100,
        "allowed_batch_sizes": [1],
        "max_enqueued_batches": 1,
        "autograph": true,
        "enable_large_batch_splitting": true,
        "input_shape": [1, 1],
        "dtype": "float32"
      },
      "note": "最小参数边界测试"
    },
    {
      "base_block_id": "CASE_04",
      "priority": "Medium",
      "params": {
        "num_batch_threads": 1,
        "max_batch_size": 10,
        "batch_timeout_micros": 5000,
        "allowed_batch_sizes": null,
        "max_enqueued_batches": 5,
        "autograph": true,
        "enable_large_batch_splitting": true,
        "input_shape": [2, 10],
        "dtype": "float32",
        "concurrent_calls": 5
      },
      "note": "不同并发度测试"
    }
  ],
  "smoke_set": ["CASE_01", "CASE_02", "CASE_03"],
  "deferred_set": ["CASE_04", "CASE_05"]
}