=== Run Tests ===
FFFF.                                                                    [100%]
================================== FAILURES ===================================
_____ test_scan_invalid_parameters[None-valid_scan_func-expected_error0] ______

initial_state = None
scan_func = <function valid_scan_func at 0x000001DBED115280>
expected_error = (<class 'TypeError'>, <class 'ValueError'>)

    @pytest.mark.parametrize("initial_state,scan_func,expected_error", [
        # Test case 1: initial_state is None (invalid)
        (
            None,  # invalid initial_state
            valid_scan_func,
            (TypeError, ValueError)  # TensorFlow may raise either
        ),
        # Test case 2: scan_func has wrong number of arguments
        (
            tf.constant(0.0, dtype=tf.float32),  # valid initial_state
            invalid_args_scan_func,  # function with 3 args instead of 2
            (TypeError, ValueError)
        ),
    ])
    def test_scan_invalid_parameters(initial_state, scan_func, expected_error):
        """Test scan function with invalid parameters raises appropriate exceptions.
    
        This test verifies:
        1. Invalid initial_state raises exception
        2. Scan function with wrong argument count raises exception
        3. Exception type is correct (TypeError or ValueError)
        4. No side effects from failed scan call
        """
        # For deprecated functions, warnings may go to stderr instead of Python warnings
        # We'll capture stderr to check for deprecation warnings
        import io
        import sys
    
        # Create a string buffer to capture stderr
        stderr_capture = io.StringIO()
    
        # Verify that scan raises an exception with invalid parameters
        with pytest.raises(expected_error) as exc_info:
            # Redirect stderr to capture deprecation warnings
            old_stderr = sys.stderr
            sys.stderr = stderr_capture
            try:
                scan(initial_state, scan_func)
            finally:
>               sys.stderr = old_stderr
E               Failed: DID NOT RAISE (<class 'TypeError'>, <class 'ValueError'>)

tests\test_tensorflow_python_data_experimental_ops_scan_ops_g2.py:140: Failed
------------------------------ Captured log call ------------------------------
WARNING  tensorflow:deprecation.py:337 From D:\Project\TestAgent-CLI-main\exam\tensorflow\python.data.experimental.ops.scan_ops\tests\test_tensorflow_python_data_experimental_ops_scan_ops_g2.py:138: scan (from tensorflow.python.data.experimental.ops.scan_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.scan(...) instead
_ test_scan_invalid_parameters[initial_state1-invalid_args_scan_func-expected_error1] _

initial_state = <tf.Tensor: shape=(), dtype=float32, numpy=0.0>
scan_func = <function invalid_args_scan_func at 0x000001DB92D09F70>
expected_error = (<class 'TypeError'>, <class 'ValueError'>)

    @pytest.mark.parametrize("initial_state,scan_func,expected_error", [
        # Test case 1: initial_state is None (invalid)
        (
            None,  # invalid initial_state
            valid_scan_func,
            (TypeError, ValueError)  # TensorFlow may raise either
        ),
        # Test case 2: scan_func has wrong number of arguments
        (
            tf.constant(0.0, dtype=tf.float32),  # valid initial_state
            invalid_args_scan_func,  # function with 3 args instead of 2
            (TypeError, ValueError)
        ),
    ])
    def test_scan_invalid_parameters(initial_state, scan_func, expected_error):
        """Test scan function with invalid parameters raises appropriate exceptions.
    
        This test verifies:
        1. Invalid initial_state raises exception
        2. Scan function with wrong argument count raises exception
        3. Exception type is correct (TypeError or ValueError)
        4. No side effects from failed scan call
        """
        # For deprecated functions, warnings may go to stderr instead of Python warnings
        # We'll capture stderr to check for deprecation warnings
        import io
        import sys
    
        # Create a string buffer to capture stderr
        stderr_capture = io.StringIO()
    
        # Verify that scan raises an exception with invalid parameters
        with pytest.raises(expected_error) as exc_info:
            # Redirect stderr to capture deprecation warnings
            old_stderr = sys.stderr
            sys.stderr = stderr_capture
            try:
                scan(initial_state, scan_func)
            finally:
>               sys.stderr = old_stderr
E               Failed: DID NOT RAISE (<class 'TypeError'>, <class 'ValueError'>)

tests\test_tensorflow_python_data_experimental_ops_scan_ops_g2.py:140: Failed
_ test_scan_edge_cases[initial_state0-identity_scan_func-empty_dataset-handles_empty] _

initial_state = <tf.Tensor: shape=(0,), dtype=float32, numpy=array([], dtype=float32)>
scan_func = <function identity_scan_func at 0x000001DB92D22DC0>
dataset_fixture = 'empty_dataset', expected_behavior = 'handles_empty'
request = <FixtureRequest for <Function test_scan_edge_cases[initial_state0-identity_scan_func-empty_dataset-handles_empty]>>

    @pytest.mark.parametrize("initial_state,scan_func,dataset_fixture,expected_behavior", [
        # Test case 1: Empty tensor state with empty dataset
        (
            tf.constant([], dtype=tf.float32),  # empty tensor
            identity_scan_func,
            'empty_dataset',
            'handles_empty'  # Should handle without crashing
        ),
        # Test case 2: Zero scalar state with single element
        (
            tf.constant(0.0, dtype=tf.float32),  # zero scalar
            valid_scan_func,
            'single_element_dataset',
            'single_pass_works'  # Should process single element correctly
        ),
    ])
    def test_scan_edge_cases(initial_state, scan_func, dataset_fixture, expected_behavior, request):
        """Test scan function with edge cases and boundary conditions.
    
        This test verifies:
        1. Empty states and datasets are handled without crashing
        2. Single element datasets work correctly
        3. Basic sanity checks pass for edge cases
        4. The function returns a callable transformation
        """
        # Get the dataset fixture
        dataset = request.getfixturevalue(dataset_fixture)
    
        # For deprecated functions, warnings may go to stderr instead of Python warnings
        import io
        import sys
    
        # Create a string buffer to capture stderr
        stderr_capture = io.StringIO()
    
        # Redirect stderr to capture deprecation warnings
        old_stderr = sys.stderr
        sys.stderr = stderr_capture
        try:
            # Call scan function - should not crash
            transform_fn = scan(initial_state, scan_func)
        finally:
            sys.stderr = old_stderr
    
        # Check if deprecation warning was printed to stderr
        stderr_output = stderr_capture.getvalue()
>       assert "deprecated" in stderr_output.lower() or "warning" in stderr_output.lower(), \
            f"Expected deprecation warning in stderr, got: {stderr_output}"
E       AssertionError: Expected deprecation warning in stderr, got: 
E       assert ('deprecated' in '' or 'warning' in '')
E        +  where '' = <built-in method lower of str object at 0x000001DBE9E646F0>()
E        +    where <built-in method lower of str object at 0x000001DBE9E646F0> = ''.lower
E        +  and   '' = <built-in method lower of str object at 0x000001DBE9E646F0>()
E        +    where <built-in method lower of str object at 0x000001DBE9E646F0> = ''.lower

tests\test_tensorflow_python_data_experimental_ops_scan_ops_g2.py:221: AssertionError
_ test_scan_edge_cases[initial_state1-valid_scan_func-single_element_dataset-single_pass_works] _

initial_state = <tf.Tensor: shape=(), dtype=float32, numpy=0.0>
scan_func = <function valid_scan_func at 0x000001DBED115280>
dataset_fixture = 'single_element_dataset'
expected_behavior = 'single_pass_works'
request = <FixtureRequest for <Function test_scan_edge_cases[initial_state1-valid_scan_func-single_element_dataset-single_pass_works]>>

    @pytest.mark.parametrize("initial_state,scan_func,dataset_fixture,expected_behavior", [
        # Test case 1: Empty tensor state with empty dataset
        (
            tf.constant([], dtype=tf.float32),  # empty tensor
            identity_scan_func,
            'empty_dataset',
            'handles_empty'  # Should handle without crashing
        ),
        # Test case 2: Zero scalar state with single element
        (
            tf.constant(0.0, dtype=tf.float32),  # zero scalar
            valid_scan_func,
            'single_element_dataset',
            'single_pass_works'  # Should process single element correctly
        ),
    ])
    def test_scan_edge_cases(initial_state, scan_func, dataset_fixture, expected_behavior, request):
        """Test scan function with edge cases and boundary conditions.
    
        This test verifies:
        1. Empty states and datasets are handled without crashing
        2. Single element datasets work correctly
        3. Basic sanity checks pass for edge cases
        4. The function returns a callable transformation
        """
        # Get the dataset fixture
        dataset = request.getfixturevalue(dataset_fixture)
    
        # For deprecated functions, warnings may go to stderr instead of Python warnings
        import io
        import sys
    
        # Create a string buffer to capture stderr
        stderr_capture = io.StringIO()
    
        # Redirect stderr to capture deprecation warnings
        old_stderr = sys.stderr
        sys.stderr = stderr_capture
        try:
            # Call scan function - should not crash
            transform_fn = scan(initial_state, scan_func)
        finally:
            sys.stderr = old_stderr
    
        # Check if deprecation warning was printed to stderr
        stderr_output = stderr_capture.getvalue()
>       assert "deprecated" in stderr_output.lower() or "warning" in stderr_output.lower(), \
            f"Expected deprecation warning in stderr, got: {stderr_output}"
E       AssertionError: Expected deprecation warning in stderr, got: 
E       assert ('deprecated' in '' or 'warning' in '')
E        +  where '' = <built-in method lower of str object at 0x000001DBE9E646F0>()
E        +    where <built-in method lower of str object at 0x000001DBE9E646F0> = ''.lower
E        +  and   '' = <built-in method lower of str object at 0x000001DBE9E646F0>()
E        +    where <built-in method lower of str object at 0x000001DBE9E646F0> = ''.lower

tests\test_tensorflow_python_data_experimental_ops_scan_ops_g2.py:221: AssertionError

---------- coverage: platform win32, python 3.9.25-final-0 -----------
Name                                                                Stmts   Miss Branch BrPart  Cover   Missing
---------------------------------------------------------------------------------------------------------------
tests\test_tensorflow_python_data_experimental_ops_scan_ops_g2.py     165    105     52      1    28%   35-37, 42, 47, 51, 56-59, 75-76, 85-97, 143-170, 225-273, 306-310, 321-336, 348-365, 378-384, 389, 394-395
---------------------------------------------------------------------------------------------------------------
TOTAL                                                                 165    105     52      1    28%
Coverage XML written to file coverage.xml

=========================== short test summary info ===========================
FAILED tests\test_tensorflow_python_data_experimental_ops_scan_ops_g2.py::test_scan_invalid_parameters[None-valid_scan_func-expected_error0]
FAILED tests\test_tensorflow_python_data_experimental_ops_scan_ops_g2.py::test_scan_invalid_parameters[initial_state1-invalid_args_scan_func-expected_error1]
FAILED tests\test_tensorflow_python_data_experimental_ops_scan_ops_g2.py::test_scan_edge_cases[initial_state0-identity_scan_func-empty_dataset-handles_empty]
FAILED tests\test_tensorflow_python_data_experimental_ops_scan_ops_g2.py::test_scan_edge_cases[initial_state1-valid_scan_func-single_element_dataset-single_pass_works]
4 failed, 1 passed in 1.56s

Error: exit 1