=== Run Tests ===
...s...FFss                                                              [100%]
================================== FAILURES ===================================
_ test_take_while_predicate_returns_non_boolean[returns_integer-dataset_args0-expected_error0] _

predicate_type = 'returns_integer', dataset_args = {'stop': 5}
expected_error = (<class 'TypeError'>, <class 'ValueError'>)

    @pytest.mark.parametrize("predicate_type,dataset_args,expected_error", [
        ("returns_integer", {"stop": 5}, (TypeError, ValueError)),
        ("returns_string", {"stop": 5}, (TypeError, ValueError)),
    ])
    def test_take_while_predicate_returns_non_boolean(predicate_type, dataset_args, expected_error):
        """Test predicate returning non-boolean type raises error"""
        # Arrange: create dataset
        dataset = tf.data.Dataset.range(dataset_args["stop"])
    
        # Create predicate based on type
        if predicate_type == "returns_integer":
            def predicate(x):
                return tf.constant(42)  # Returns integer instead of boolean
        elif predicate_type == "returns_string":
            def predicate(x):
                return tf.constant("not_a_boolean")  # Returns string instead of boolean
        else:
            pytest.fail(f"Unknown predicate type: {predicate_type}")
    
        # Act & Assert: should raise error when predicate returns non-boolean
        # Note: The error may be raised during dataset iteration
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", DeprecationWarning)
            transform_func = take_while(predicate)
    
            # The error should be raised when trying to use the transformation
>           result_dataset = transform_func(dataset)

tests\test_tensorflow_python_data_experimental_ops_take_while_ops.py:249: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\data\experimental\ops\take_while_ops.py:36: in _apply_fn
    return dataset.take_while(predicate=predicate)
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3118: in take_while
    return _TakeWhileDataset(self, predicate, name=name)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <_TakeWhileDataset element_spec=TensorSpec(shape=(), dtype=tf.int64, name=None)>
input_dataset = <RangeDataset element_spec=TensorSpec(shape=(), dtype=tf.int64, name=None)>
predicate = <function test_take_while_predicate_returns_non_boolean.<locals>.predicate at 0x000001D14D6CA8B0>
name = None

    def __init__(self, input_dataset, predicate, name=None):
      """See `take_while()` for details."""
    
      self._input_dataset = input_dataset
      wrapped_func = structured_function.StructuredFunctionWrapper(
          predicate, self._transformation_name(), dataset=self._input_dataset)
    
      if not wrapped_func.output_structure.is_compatible_with(
          tensor_spec.TensorSpec([], dtypes.bool)):
>       raise ValueError(f"Invalid `predicate`. `predicate` must return a "
                         f"`tf.bool` scalar tensor but its return type is"
                         f"{wrapped_func.output_structure}.")
E       ValueError: Invalid `predicate`. `predicate` must return a `tf.bool` scalar tensor but its return type isTensorSpec(shape=(), dtype=tf.int32, name=None).

D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:5969: ValueError
_ test_take_while_predicate_returns_non_boolean[returns_string-dataset_args1-expected_error1] _

predicate_type = 'returns_string', dataset_args = {'stop': 5}
expected_error = (<class 'TypeError'>, <class 'ValueError'>)

    @pytest.mark.parametrize("predicate_type,dataset_args,expected_error", [
        ("returns_integer", {"stop": 5}, (TypeError, ValueError)),
        ("returns_string", {"stop": 5}, (TypeError, ValueError)),
    ])
    def test_take_while_predicate_returns_non_boolean(predicate_type, dataset_args, expected_error):
        """Test predicate returning non-boolean type raises error"""
        # Arrange: create dataset
        dataset = tf.data.Dataset.range(dataset_args["stop"])
    
        # Create predicate based on type
        if predicate_type == "returns_integer":
            def predicate(x):
                return tf.constant(42)  # Returns integer instead of boolean
        elif predicate_type == "returns_string":
            def predicate(x):
                return tf.constant("not_a_boolean")  # Returns string instead of boolean
        else:
            pytest.fail(f"Unknown predicate type: {predicate_type}")
    
        # Act & Assert: should raise error when predicate returns non-boolean
        # Note: The error may be raised during dataset iteration
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", DeprecationWarning)
            transform_func = take_while(predicate)
    
            # The error should be raised when trying to use the transformation
>           result_dataset = transform_func(dataset)

tests\test_tensorflow_python_data_experimental_ops_take_while_ops.py:249: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\data\experimental\ops\take_while_ops.py:36: in _apply_fn
    return dataset.take_while(predicate=predicate)
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:3118: in take_while
    return _TakeWhileDataset(self, predicate, name=name)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <_TakeWhileDataset element_spec=TensorSpec(shape=(), dtype=tf.int64, name=None)>
input_dataset = <RangeDataset element_spec=TensorSpec(shape=(), dtype=tf.int64, name=None)>
predicate = <function test_take_while_predicate_returns_non_boolean.<locals>.predicate at 0x000001D14E9ABD30>
name = None

    def __init__(self, input_dataset, predicate, name=None):
      """See `take_while()` for details."""
    
      self._input_dataset = input_dataset
      wrapped_func = structured_function.StructuredFunctionWrapper(
          predicate, self._transformation_name(), dataset=self._input_dataset)
    
      if not wrapped_func.output_structure.is_compatible_with(
          tensor_spec.TensorSpec([], dtypes.bool)):
>       raise ValueError(f"Invalid `predicate`. `predicate` must return a "
                         f"`tf.bool` scalar tensor but its return type is"
                         f"{wrapped_func.output_structure}.")
E       ValueError: Invalid `predicate`. `predicate` must return a `tf.bool` scalar tensor but its return type isTensorSpec(shape=(), dtype=tf.string, name=None).

D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:5969: ValueError

---------- coverage: platform win32, python 3.9.25-final-0 -----------
Name                                                                   Stmts   Miss Branch BrPart  Cover   Missing
------------------------------------------------------------------------------------------------------------------
test_actual_behavior.py                                                    0      0      0      0   100%
test_error_timing.py                                                       0      0      0      0   100%
tests\test_tensorflow_python_data_experimental_ops_take_while_ops.py     116     17     12      5    83%   22, 26-28, 46-47, 52->exit, 75->83, 78->83, 92-94, 149-150, 210-211, 235, 238-240, 252, 280
------------------------------------------------------------------------------------------------------------------
TOTAL                                                                    116     17     12      5    83%
Coverage XML written to file coverage.xml

=========================== short test summary info ===========================
FAILED tests\test_tensorflow_python_data_experimental_ops_take_while_ops.py::test_take_while_predicate_returns_non_boolean[returns_integer-dataset_args0-expected_error0]
FAILED tests\test_tensorflow_python_data_experimental_ops_take_while_ops.py::test_take_while_predicate_returns_non_boolean[returns_string-dataset_args1-expected_error1]
2 failed, 6 passed, 3 skipped in 1.77s

Error: exit 1