=== Run Tests ===
.sss.s.sF..                                                              [100%]
================================== FAILURES ===================================
_ test_wrapper_serialization_cycle[DropoutWrapper-BasicRNNCell-0.6-0.7-float32-4] _

wrapper_type = 'DropoutWrapper', cell_type = 'BasicRNNCell'
input_keep_prob = 0.6, output_keep_prob = 0.7, dtype = 'float32', units = 4

    @pytest.mark.parametrize(
        "wrapper_type,cell_type,input_keep_prob,output_keep_prob,dtype,units",
        [
            (
                "DropoutWrapper",
                "BasicRNNCell",
                0.6,
                0.7,
                "float32",
                4
            )
        ]
    )
    def test_wrapper_serialization_cycle(
        wrapper_type,
        cell_type,
        input_keep_prob,
        output_keep_prob,
        dtype,
        units
    ):
        """Test serialization/deserialization cycle for wrappers."""
        # Create the base RNN cell
        if cell_type == "BasicRNNCell":
            cell = BasicRNNCell(num_units=units, dtype=getattr(tf, dtype))
            # Need to build with a dummy shape for serialization
            cell.build((None, units))  # Using units as input_dim for simplicity
        else:
            raise ValueError(f"Unsupported cell type: {cell_type}")
    
        # Create the wrapper
        if wrapper_type == "DropoutWrapper":
            original_wrapper = DropoutWrapper(
                cell=cell,
                input_keep_prob=input_keep_prob,
                output_keep_prob=output_keep_prob,
                dtype=getattr(tf, dtype),
                seed=42
            )
        else:
            raise ValueError(f"Unsupported wrapper type: {wrapper_type}")
    
        # Weak assertion 1: config_serializable
        config = original_wrapper.get_config()
        assert isinstance(config, dict)
    
        # Weak assertion 2: config_keys_present
        expected_keys = ['cell', 'name']
        for key in expected_keys:
            assert key in config, f"Missing key in config: {key}"
    
        # Check cell config is present
        assert 'cell' in config
        cell_config = config['cell']
        assert isinstance(cell_config, dict)
        assert 'class_name' in cell_config
        assert 'config' in cell_config
    
        # Weak assertion 3: deserialization_works
        # Recreate wrapper from config
>       reconstructed_wrapper = original_wrapper.__class__.from_config(config)

tests\test_tensorflow_python_keras_layers_rnn_cell_wrapper_v2.py:631: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\keras\layers\legacy_rnn\rnn_cell_wrapper_impl.py:315: in from_config
    return super(DropoutWrapperBase, cls).from_config(
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\keras\layers\rnn_cell_wrapper_v2.py:89: in from_config
    cell = deserialize_layer(config.pop("cell"), custom_objects=custom_objects)
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\keras\layers\serialization.py:123: in deserialize
    return generic_utils.deserialize_keras_object(
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\keras\utils\generic_utils.py:659: in deserialize_keras_object
    (cls, cls_config) = class_and_config_for_serialized_keras_object(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

config = {'class_name': 'BasicRNNCell', 'config': {'activation': 'tanh', 'dtype': 'float32', 'name': 'basic_rnn_cell_6', 'num_units': 4, ...}}
module_objects = {'AbstractRNNCell': <class 'tensorflow.python.keras.layers.recurrent.AbstractRNNCell'>, 'Activation': <class 'tensorfl...flow.python.keras.layers.core.ActivityRegularization'>, 'Add': <class 'tensorflow.python.keras.layers.merge.Add'>, ...}
custom_objects = None, printable_module_name = 'layer'

    def class_and_config_for_serialized_keras_object(
        config,
        module_objects=None,
        custom_objects=None,
        printable_module_name='object'):
      """Returns the class name and config for a serialized keras object."""
      if (not isinstance(config, dict)
          or 'class_name' not in config
          or 'config' not in config):
        raise ValueError('Improper config format: ' + str(config))
    
      class_name = config['class_name']
      cls = get_registered_object(class_name, custom_objects, module_objects)
      if cls is None:
>       raise ValueError(
            'Unknown {}: {}. Please ensure this object is '
            'passed to the `custom_objects` argument. See '
            'https://www.tensorflow.org/guide/keras/save_and_serialize'
            '#registering_the_custom_object for details.'
            .format(printable_module_name, class_name))
E       ValueError: Unknown layer: BasicRNNCell. Please ensure this object is passed to the `custom_objects` argument. See https://www.tensorflow.org/guide/keras/save_and_serialize#registering_the_custom_object for details.

D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\keras\utils\generic_utils.py:556: ValueError
============================== warnings summary ===============================
exam/tensorflow/python.keras.layers.rnn_cell_wrapper_v2/tests/test_tensorflow_python_keras_layers_rnn_cell_wrapper_v2.py::test_dropout_wrapper_basic_functionality[BasicRNNCell-1.0-1.0-1.0-False-float32-2-3-4-5]
exam/tensorflow/python.keras.layers.rnn_cell_wrapper_v2/tests/test_tensorflow_python_keras_layers_rnn_cell_wrapper_v2.py::test_dropout_wrapper_probability_boundaries[BasicRNNCell-0.0-0.5-1.0-False-float32-1-2-3-4]
exam/tensorflow/python.keras.layers.rnn_cell_wrapper_v2/tests/test_tensorflow_python_keras_layers_rnn_cell_wrapper_v2.py::test_dropout_wrapper_probability_boundaries[BasicRNNCell-1.0-0.0-0.0-False-float32-3-1-5-5]
exam/tensorflow/python.keras.layers.rnn_cell_wrapper_v2/tests/test_tensorflow_python_keras_layers_rnn_cell_wrapper_v2.py::test_residual_wrapper_dimension_matching[BasicRNNCell-6-6-float32-2-3]
exam/tensorflow/python.keras.layers.rnn_cell_wrapper_v2/tests/test_tensorflow_python_keras_layers_rnn_cell_wrapper_v2.py::test_device_wrapper_device_placement[BasicRNNCell-/cpu:0-float32-1-2-3-4]
exam/tensorflow/python.keras.layers.rnn_cell_wrapper_v2/tests/test_tensorflow_python_keras_layers_rnn_cell_wrapper_v2.py::test_wrapper_serialization_cycle[DropoutWrapper-BasicRNNCell-0.6-0.7-float32-4]
  D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\keras\layers\legacy_rnn\rnn_cell_impl.py:427: UserWarning: `tf.nn.rnn_cell.BasicRNNCell` is deprecated and will be removed in a future version. This class is equivalent as `tf.keras.layers.SimpleRNNCell`, and will be replaced by that in Tensorflow 2.0.
    warnings.warn("`tf.nn.rnn_cell.BasicRNNCell` is deprecated and will be "

exam/tensorflow/python.keras.layers.rnn_cell_wrapper_v2/tests/test_tensorflow_python_keras_layers_rnn_cell_wrapper_v2.py::test_dropout_wrapper_basic_functionality[BasicRNNCell-1.0-1.0-1.0-False-float32-2-3-4-5]
exam/tensorflow/python.keras.layers.rnn_cell_wrapper_v2/tests/test_tensorflow_python_keras_layers_rnn_cell_wrapper_v2.py::test_dropout_wrapper_probability_boundaries[BasicRNNCell-0.0-0.5-1.0-False-float32-1-2-3-4]
exam/tensorflow/python.keras.layers.rnn_cell_wrapper_v2/tests/test_tensorflow_python_keras_layers_rnn_cell_wrapper_v2.py::test_dropout_wrapper_probability_boundaries[BasicRNNCell-1.0-0.0-0.0-False-float32-3-1-5-5]
exam/tensorflow/python.keras.layers.rnn_cell_wrapper_v2/tests/test_tensorflow_python_keras_layers_rnn_cell_wrapper_v2.py::test_residual_wrapper_dimension_matching[BasicRNNCell-6-6-float32-2-3]
exam/tensorflow/python.keras.layers.rnn_cell_wrapper_v2/tests/test_tensorflow_python_keras_layers_rnn_cell_wrapper_v2.py::test_device_wrapper_device_placement[BasicRNNCell-/cpu:0-float32-1-2-3-4]
exam/tensorflow/python.keras.layers.rnn_cell_wrapper_v2/tests/test_tensorflow_python_keras_layers_rnn_cell_wrapper_v2.py::test_wrapper_serialization_cycle[DropoutWrapper-BasicRNNCell-0.6-0.7-float32-4]
  D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\keras\engine\base_layer.py:2220: UserWarning: `layer.add_variable` is deprecated and will be removed in a future version. Please use `layer.add_weight` method instead.
    warnings.warn('`layer.add_variable` is deprecated and '

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

---------- coverage: platform win32, python 3.9.25-final-0 -----------
Name                                                               Stmts   Miss Branch BrPart  Cover   Missing
--------------------------------------------------------------------------------------------------------------
tests\test_tensorflow_python_keras_layers_rnn_cell_wrapper_v2.py     230     80     46     12    63%   25-28, 33-36, 41-43, 55, 113, 149->159, 162-171, 225, 235-319, 364, 474, 513->526, 599, 611, 634-676, 714-722, 726-727
--------------------------------------------------------------------------------------------------------------
TOTAL                                                                230     80     46     12    63%
Coverage XML written to file coverage.xml

=========================== short test summary info ===========================
FAILED tests\test_tensorflow_python_keras_layers_rnn_cell_wrapper_v2.py::test_wrapper_serialization_cycle[DropoutWrapper-BasicRNNCell-0.6-0.7-float32-4]
1 failed, 5 passed, 5 skipped, 12 warnings in 1.67s

Error: exit 1