=== Run Tests ===
............F.                                                           [100%]
================================== FAILURES ===================================
____________________ test_label_exceeds_num_classes_error _____________________

    def test_label_exceeds_num_classes_error():
        """
        CASE_08: 标签超出num_classes错误处理
        测试当标签或预测值大于等于num_classes时是否抛出适当异常
        """
        # Test case 1: Label exceeds num_classes
        labels = tf.constant([0, 1, 5], dtype=tf.int32)  # 5 >= 3
        predictions = tf.constant([0, 1, 2], dtype=tf.int32)
    
        with pytest.raises((tf.errors.InvalidArgumentError, ValueError)) as exc_info:
            confusion_matrix.confusion_matrix(
                labels=labels,
                predictions=predictions,
                num_classes=3  # Labels contain 5 which is >= 3
            )
    
        # Verify that an error was raised with appropriate message
        assert exc_info.value is not None, "Expected exception for label exceeding num_classes"
        error_msg = str(exc_info.value).lower()
        # Check for num_classes/range related keywords in error message
>       assert any(keyword in error_msg for keyword in ['num_classes', 'range', 'less than', '>=', 'exceed', 'out of range']), \
            f"Error message should mention num_classes/range violation. Got: {error_msg}"
E       AssertionError: Error message should mention num_classes/range violation. Got: `labels` out of bound
E         condition x < y did not hold.
E         first 3 elements of x:
E         [0 1 5]
E         first 1 elements of y:
E         [3]
E       assert False
E        +  where False = any(<generator object test_label_exceeds_num_classes_error.<locals>.<genexpr> at 0x00000231596DBA50>)

tests\test_tensorflow_python_ops_confusion_matrix.py:630: AssertionError

---------- coverage: platform win32, python 3.9.25-final-0 -----------
Name                                                   Stmts   Miss Branch BrPart  Cover   Missing
--------------------------------------------------------------------------------------------------
tests\test_tensorflow_python_ops_confusion_matrix.py     208     44     32     10    78%   78, 103->exit, 147, 179->exit, 257, 303, 347->exit, 393, 441-442, 601-604, 634-715, 727, 741-742
--------------------------------------------------------------------------------------------------
TOTAL                                                    208     44     32     10    78%
Coverage XML written to file coverage.xml

=========================== short test summary info ===========================
FAILED tests\test_tensorflow_python_ops_confusion_matrix.py::test_label_exceeds_num_classes_error
1 failed, 13 passed in 1.61s

Error: exit 1