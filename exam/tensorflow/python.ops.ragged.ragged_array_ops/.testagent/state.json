{
  "workflow_id": "2c199521",
  "created_at": "2026-01-25T06:31:46.511595",
  "op": "tensorflow_python_ops_ragged_ragged_array_ops",
  "arch": "python",
  "soc": "python",
  "vendor": "python",
  "project_root": "/Users/zzf1sh/Documents/Project/TestAgent-CLI-main/exam/tensorflow/python.ops.ragged.ragged_array_ops",
  "target": "tensorflow.python.ops.ragged.ragged_array_ops",
  "target_slug": "tensorflow_python_ops_ragged_ragged_array_ops",
  "current_stage": "complete",
  "stage_index": 6,
  "mode": "full-auto",
  "epoch_total": 5,
  "epoch_current": 5,
  "last_failure_signature": "",
  "last_error_signature": "",
  "last_block_errors": {},
  "auto_stop_reason": "",
  "artifacts": {
    "function_doc.md": "# tensorflow.python.ops.ragged.ragged_array_ops - 函数说明\n\n## 1. 基本信息\n- **FQN**: tensorflow.python.ops.ragged.ragged_array_ops\n- **模块文件**: `/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/ops/ragged/ragged_array_ops.py`\n- **签名**: 模块（包含多个函数）\n- **对象类型**: module\n\n## 2. 功能概述\nTensorFlow RaggedTensor 数组操作模块。提供对不规则张量（RaggedTensor）的数组操作支持，包括掩码、平铺、重塑、维度操作等。这些函数专门处理具有非均匀形状的张量。\n\n## 3. 参数说明\n模块包含多个函数，每个函数有独立参数：\n\n**核心函数示例：boolean_mask**\n- data (Tensor/RaggedTensor): 输入数据张量\n- mask (Tensor/RaggedTensor): 布尔掩码张量，形状必须是 data 形状的前缀\n- name (str/None): 操作名称（可选）\n\n**核心函数示例：tile**\n- input (RaggedTensor): 输入 RaggedTensor\n- multiples (1-D Tensor): 整数张量，长度必须与 input 维度数相同\n- name (str/None): 操作名称（可选）\n\n## 4. 返回值\n各函数返回类型不同：\n- boolean_mask: 返回与输入相同秩的潜在 RaggedTensor\n- tile: 返回与输入相同类型、秩和 ragged_rank 的 RaggedTensor\n- expand_dims: 返回在指定轴添加维度大小为1的张量\n\n## 5. 文档要点\n- mask 的秩必须静态已知\n- mask.shape 必须是 data.shape 的前缀\n- 支持 RaggedTensor 和普通 Tensor 的混合操作\n- 函数通过 @dispatch 装饰器实现多态分发\n\n## 6. 源码摘要\n- 模块包含多个函数：boolean_mask, tile, expand_dims, size, rank, reverse, cross, dynamic_partition, split, reshape 等\n- 依赖 tensorflow.python.ops.ragged.ragged_tensor 进行 RaggedTensor 转换\n- 使用 @tf_export 和 @dispatch.add_dispatch_support 装饰器\n- 实现递归处理嵌套 RaggedTensor 的逻辑\n- 包含输入验证和错误检查\n\n## 7. 示例与用法（如有）\n**boolean_mask 示例**：\n```python\n>>> T, F = (True, False)\n>>> tf.ragged.boolean_mask(\n...     data=[[1, 2, 3], [4, 5, 6], [7, 8, 9]],\n...     mask=[[T, F, T], [F, F, F], [T, F, F]]).to_list()\n[[1, 3], [], [7]]\n```\n\n**tile 示例**：\n```python\n>>> rt = tf.ragged.constant([[1, 2], [3]])\n>>> tf.tile(rt, [3, 2]).to_list()\n[[1, 2, 1, 2], [3, 3], [1, 2, 1, 2], [3, 3], [1, 2, 1, 2], [3, 3]]\n```\n\n## 8. 风险与空白\n- 目标为模块而非单个函数，包含多个函数实体\n- 需要测试多个核心函数：boolean_mask, tile, expand_dims, size, rank 等\n- 缺少单个函数的完整类型注解（部分函数有）\n- 需要验证 RaggedTensor 与普通 Tensor 的互操作性\n- 边界情况：空 RaggedTensor、标量输入、维度不匹配\n- 需要测试错误处理：无效 mask 形状、未知秩等\n- 模块文档列出了大量支持 RaggedTensor 的其他 TensorFlow 操作，但本模块仅包含特定数组操作",
    "requirements.md": "# tensorflow.python.ops.ragged.ragged_array_ops 测试需求\n\n## 1. 目标与范围\n- 主要功能与期望行为：测试 RaggedTensor 数组操作模块，包括 boolean_mask、tile、expand_dims、size、rank、reverse、cross、dynamic_partition、split、reshape 等函数对不规则张量的正确处理\n- 不在范围内的内容：其他 TensorFlow 模块的 RaggedTensor 支持、非数组操作函数、性能基准测试\n\n## 2. 输入与约束\n- 参数列表（名称、类型/shape、默认值）：\n  - boolean_mask: data (Tensor/RaggedTensor), mask (Tensor/RaggedTensor), name (str/None)\n  - tile: input (RaggedTensor), multiples (1-D Tensor), name (str/None)\n  - expand_dims: input (RaggedTensor), axis (int/Tensor), name (str/None)\n  - size: input (RaggedTensor), out_type (tf.dtype), name (str/None)\n  - rank: input (RaggedTensor), name (str/None)\n- 有效取值范围/维度/设备要求：\n  - mask 的秩必须静态已知\n  - mask.shape 必须是 data.shape 的前缀\n  - multiples 长度必须与 input 维度数相同\n  - 支持 RaggedTensor 和普通 Tensor 的混合操作\n- 必需与可选组合：\n  - boolean_mask: data 和 mask 必需，name 可选\n  - tile: input 和 multiples 必需，name 可选\n  - expand_dims: input 和 axis 必需，name 可选\n- 随机性/全局状态要求：无全局状态依赖，函数为纯操作\n\n## 3. 输出与判定\n- 期望返回结构及关键字段：\n  - boolean_mask: 返回与输入相同秩的潜在 RaggedTensor\n  - tile: 返回与输入相同类型、秩和 ragged_rank 的 RaggedTensor\n  - expand_dims: 返回在指定轴添加维度大小为1的张量\n  - size: 返回标量张量表示元素总数\n  - rank: 返回标量张量表示秩\n- 容差/误差界（如浮点）：无特殊浮点容差要求\n- 状态变化或副作用检查点：无副作用，不修改输入张量\n\n## 4. 错误与异常场景\n- 非法输入/维度/类型触发的异常或警告：\n  - mask 形状不是 data 形状的前缀\n  - mask 秩未知（非静态）\n  - multiples 长度与 input 维度数不匹配\n  - 无效的 axis 值（超出范围）\n  - 类型不匹配（如非布尔 mask）\n- 边界值（空、None、0 长度、极端形状/数值）：\n  - 空 RaggedTensor 输入\n  - 标量输入处理\n  - 全 True/False mask\n  - 零维度 RaggedTensor\n  - 极端嵌套深度\n\n## 5. 依赖与环境\n- 外部资源/设备/网络/文件依赖：仅依赖 TensorFlow 运行时\n- 需要 mock/monkeypatch 的部分：\n  - `tensorflow.python.ops.ragged.ragged_tensor.RaggedTensor` 的转换方法\n  - `tensorflow.python.ops.ragged.ragged_tensor.convert_to_tensor_or_ragged_tensor`\n  - `tensorflow.python.ops.ragged.ragged_tensor.is_ragged`\n  - `tensorflow.python.ops.ragged.ragged_tensor.RaggedTensor.from_nested_row_splits`\n\n## 6. 覆盖与优先级\n- 必测路径（高优先级，最多 5 条，短句）：\n  1. boolean_mask 基本功能：正确过滤 RaggedTensor 元素\n  2. tile 复制功能：验证多维复制逻辑\n  3. expand_dims 维度扩展：单轴和多轴扩展\n  4. size 和 rank 计算：验证元素计数和维度数\n  5. 混合类型操作：RaggedTensor 与普通 Tensor 互操作\n- 可选路径（中/低优先级合并为一组列表）：\n  - reverse 反转操作\n  - cross 向量叉积\n  - dynamic_partition 动态分区\n  - split 张量分割\n  - reshape 形状重塑\n  - 深度嵌套 RaggedTensor\n  - 大规模数据性能\n  - GPU 设备兼容性\n- 已知风险/缺失信息（仅列条目，不展开）：\n  - 部分函数缺少完整类型注解\n  - 递归处理逻辑的深度限制\n  - 内存使用边界情况\n  - 稀疏张量互操作性\n  - 分布式环境行为",
    "test_plan.json": "{\n  \"plan_version\": 2,\n  \"target\": \"tensorflow.python.ops.ragged.ragged_array_ops\",\n  \"block_rules\": {\n    \"header_block\": \"HEADER\",\n    \"footer_block\": \"FOOTER\",\n    \"case_prefix\": \"CASE_\",\n    \"case_format\": \"CASE_01\"\n  },\n  \"iteration_strategy\": {\n    \"round1\": {\"include\": \"SMOKE_SET\", \"assert_level\": \"weak\", \"max_blocks\": 5},\n    \"roundN\": {\"only_fix_failed_blocks\": true, \"block_limit\": 3, \"promote_deferred\": true},\n    \"final\": {\"enable_strong_asserts\": true, \"coverage_optional\": true}\n  },\n  \"test_files\": {\n    \"default\": \"tests/test_tensorflow_python_ops_ragged_ragged_array_ops.py\",\n    \"all_pattern\": \"tests/test_tensorflow_python_ops_ragged_ragged_array_ops.py\"\n  },\n  \"cases\": [\n    {\n      \"tc_id\": \"TC-01\",\n      \"block_id\": \"CASE_01\",\n      \"name\": \"boolean_mask 基本功能\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"function\": \"boolean_mask\",\n          \"data_type\": \"RaggedTensor\",\n          \"data_shape\": [[1, 2, 3], [4, 5, 6], [7, 8, 9]],\n          \"mask_type\": \"RaggedTensor\",\n          \"mask_shape\": [[true, false, true], [false, false, false], [true, false, false]],\n          \"name\": null\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"shape_match\", \"dtype_preserved\", \"values_correct\", \"no_exception\"],\n        \"strong\": [\"exact_values\", \"memory_layout\", \"gradient_check\"]\n      },\n      \"oracle\": \"manual_verification\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"S\",\n      \"max_lines\": 80,\n      \"max_params\": 6,\n      \"is_parametrized\": true,\n      \"requires_mock\": false,\n      \"mock_targets\": []\n    },\n    {\n      \"tc_id\": \"TC-02\",\n      \"block_id\": \"CASE_02\",\n      \"name\": \"tile 复制功能\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"function\": \"tile\",\n          \"input_type\": \"RaggedTensor\",\n          \"input_shape\": [[1, 2], [3]],\n          \"multiples\": [3, 2],\n          \"name\": null\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"shape_match\", \"dtype_preserved\", \"repetition_correct\", \"no_exception\"],\n        \"strong\": [\"exact_repetition\", \"memory_efficiency\", \"gradient_check\"]\n      },\n      \"oracle\": \"manual_verification\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"S\",\n      \"max_lines\": 80,\n      \"max_params\": 6,\n      \"is_parametrized\": true,\n      \"requires_mock\": false,\n      \"mock_targets\": []\n    },\n    {\n      \"tc_id\": \"TC-03\",\n      \"block_id\": \"CASE_03\",\n      \"name\": \"expand_dims 维度扩展\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"function\": \"expand_dims\",\n          \"input_type\": \"RaggedTensor\",\n          \"input_shape\": [[1, 2], [3]],\n          \"axis\": 0,\n          \"name\": null\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"rank_increased\", \"dtype_preserved\", \"values_preserved\", \"no_exception\"],\n        \"strong\": [\"exact_shape\", \"axis_validation\", \"gradient_check\"]\n      },\n      \"oracle\": \"manual_verification\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"S\",\n      \"max_lines\": 80,\n      \"max_params\": 6,\n      \"is_parametrized\": true,\n      \"requires_mock\": false,\n      \"mock_targets\": []\n    },\n    {\n      \"tc_id\": \"TC-04\",\n      \"block_id\": \"CASE_04\",\n      \"name\": \"size 和 rank 计算\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"function\": \"size\",\n          \"input_type\": \"RaggedTensor\",\n          \"input_shape\": [[1, 2, 3], [4, 5], [6]],\n          \"out_type\": \"tf.int32\",\n          \"name\": null\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"correct_count\", \"dtype_match\", \"scalar_output\", \"no_exception\"],\n        \"strong\": [\"exact_value\", \"type_conversion\", \"edge_cases\"]\n      },\n      \"oracle\": \"manual_calculation\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"S\",\n      \"max_lines\": 80,\n      \"max_params\": 6,\n      \"is_parametrized\": true,\n      \"requires_mock\": false,\n      \"mock_targets\": []\n    },\n    {\n      \"tc_id\": \"TC-05\",\n      \"block_id\": \"CASE_05\",\n      \"name\": \"混合类型操作\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"function\": \"boolean_mask\",\n          \"data_type\": \"Tensor\",\n          \"data_shape\": [[1, 2, 3], [4, 5, 6], [7, 8, 9]],\n          \"mask_type\": \"RaggedTensor\",\n          \"mask_shape\": [[true, false, true], [false, false, false], [true, false, false]],\n          \"name\": null\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"type_conversion\", \"shape_match\", \"values_correct\", \"no_exception\"],\n        \"strong\": [\"exact_conversion\", \"performance_check\", \"gradient_check\"]\n      },\n      \"oracle\": \"manual_verification\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"S\",\n      \"max_lines\": 80,\n      \"max_params\": 6,\n      \"is_parametrized\": true,\n      \"requires_mock\": true,\n      \"mock_targets\": [\n        \"tensorflow.python.ops.ragged.ragged_tensor.RaggedTensor\",\n        \"tensorflow.python.ops.ragged.ragged_tensor.convert_to_tensor_or_ragged_tensor\",\n        \"tensorflow.python.ops.ragged.ragged_tensor.is_ragged\"\n      ]\n    }\n  ],\n  \"param_extensions\": [\n    {\n      \"base_block_id\": \"CASE_01\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"function\": \"boolean_mask\",\n        \"data_type\": \"RaggedTensor\",\n        \"data_shape\": [],\n        \"mask_type\": \"RaggedTensor\",\n        \"mask_shape\": [],\n        \"name\": null\n      },\n      \"note\": \"空 RaggedTensor 边界情况\"\n    },\n    {\n      \"base_block_id\": \"CASE_01\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"function\": \"boolean_mask\",\n        \"data_type\": \"RaggedTensor\",\n        \"data_shape\": [[1, 2, 3], [4, 5, 6], [7, 8, 9]],\n        \"mask_type\": \"RaggedTensor\",\n        \"mask_shape\": [[true, true, true], [true, true, true], [true, true, true]],\n        \"name\": null\n      },\n      \"note\": \"全 True mask 边界情况\"\n    },\n    {\n      \"base_block_id\": \"CASE_02\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"function\": \"tile\",\n        \"input_type\": \"RaggedTensor\",\n        \"input_shape\": [],\n        \"multiples\": [1, 1],\n        \"name\": null\n      },\n      \"note\": \"空 RaggedTensor 复制\"\n    },\n    {\n      \"base_block_id\": \"CASE_03\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"function\": \"expand_dims\",\n        \"input_type\": \"RaggedTensor\",\n        \"input_shape\": [],\n        \"axis\": -1,\n        \"name\": null\n      },\n      \"note\": \"空 RaggedTensor 维度扩展\"\n    },\n    {\n      \"base_block_id\": \"CASE_04\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"function\": \"rank\",\n        \"input_type\": \"RaggedTensor\",\n        \"input_shape\": [],\n        \"name\": null\n      },\n      \"note\": \"空 RaggedTensor 秩计算\"\n    }\n  ],\n  \"smoke_set\": [\"CASE_01\", \"CASE_02\", \"CASE_03\"],\n  \"deferred_set\": [\"CASE_04\", \"CASE_05\"]\n}",
    "test_plan.md": "# tensorflow.python.ops.ragged.ragged_array_ops 测试计划\n\n## 1. 测试策略\n- 单元测试框架：pytest\n- 隔离策略：mock/monkeypatch/fixtures\n- 随机性处理：固定随机种子/控制 RNG\n\n## 2. 生成规格摘要（来自 test_plan.json）\n- SMOKE_SET: CASE_01, CASE_02, CASE_03\n- DEFERRED_SET: CASE_04, CASE_05\n- 测试文件路径：tests/test_tensorflow_python_ops_ragged_ragged_array_ops.py\n- 断言分级策略：首轮使用 weak 断言，最终轮启用 strong 断言\n- 预算策略：每个用例 size=S, max_lines=80, max_params=6\n\n## 3. 数据与边界\n- 正常数据集：标准 RaggedTensor 形状，如 [[1,2,3],[4,5,6],[7,8,9]]\n- 边界值：空 RaggedTensor、标量输入、全 True/False mask\n- 极端形状：零维度、深度嵌套、大规模数据\n- 负例与异常场景：\n  - mask 形状不是 data 形状的前缀\n  - mask 秩未知（非静态）\n  - multiples 长度与 input 维度数不匹配\n  - 无效的 axis 值（超出范围）\n  - 类型不匹配（如非布尔 mask）\n\n## 4. 覆盖映射\n| TC ID | 对应需求 | 核心功能 | 优先级 |\n|-------|----------|----------|--------|\n| TC-01 | boolean_mask 基本功能 | 正确过滤 RaggedTensor 元素 | High |\n| TC-02 | tile 复制功能 | 验证多维复制逻辑 | High |\n| TC-03 | expand_dims 维度扩展 | 单轴和多轴扩展 | High |\n| TC-04 | size 和 rank 计算 | 验证元素计数和维度数 | High |\n| TC-05 | 混合类型操作 | RaggedTensor 与普通 Tensor 互操作 | High |\n\n### 尚未覆盖的风险点\n- 递归处理逻辑的深度限制\n- 内存使用边界情况\n- 稀疏张量互操作性\n- 分布式环境行为\n- GPU 设备兼容性",
    "tests/test_tensorflow_python_ops_ragged_ragged_array_ops.py": "\"\"\"\nTest cases for tensorflow.python.ops.ragged.ragged_array_ops\nGenerated by TestAgent\n\"\"\"\n\nimport math\nimport pytest\nimport tensorflow as tf\nfrom tensorflow.python.ops.ragged import ragged_array_ops\nfrom tensorflow.python.ops.ragged import ragged_tensor\nfrom unittest import mock\n\n# Set random seed for reproducibility\ntf.random.set_seed(42)\n\n# ==== BLOCK:HEADER START ====\n# Test class and helper functions\nclass TestRaggedArrayOps:\n    \"\"\"Test suite for ragged_array_ops module.\"\"\"\n    \n    @pytest.fixture(autouse=True)\n    def setup(self):\n        \"\"\"Setup test fixture.\"\"\"\n        tf.random.set_seed(42)\n        yield\n# ==== BLOCK:HEADER END ====\n\n# ==== BLOCK:CASE_01 START ====\n# Placeholder for boolean_mask 基本功能\n# This block will be replaced with actual test code\n# ==== BLOCK:CASE_01 END ====\n\n# ==== BLOCK:CASE_02 START ====\n# Placeholder for tile 复制功能\n# This block will be replaced with actual test code\n# ==== BLOCK:CASE_02 END ====\n\n# ==== BLOCK:CASE_03 START ====\n# Placeholder for expand_dims 维度扩展\n# This block will be replaced with actual test code\n# ==== BLOCK:CASE_03 END ====\n\n# ==== BLOCK:CASE_04 START ====\n# Placeholder for size 和 rank 计算 (DEFERRED_SET)\n# This block will be replaced in later rounds\n# ==== BLOCK:CASE_04 END ====\n\n# ==== BLOCK:CASE_05 START ====\n# Placeholder for 混合类型操作 (DEFERRED_SET)\n# This block will be replaced in later rounds\n# ==== BLOCK:CASE_05 END ====\n\n# ==== BLOCK:FOOTER START ====\n# Additional test cases and cleanup\nif __name__ == '__main__':\n    pytest.main([__file__, '-v'])\n# ==== BLOCK:FOOTER END ====",
    "execution_log.txt": "=== Run Tests ===\n...........F.......                                                      [100%]\n=================================== FAILURES ===================================\n___ TestRaggedArrayOps.test_size_and_rank_calculation[input_shape1-0-1-rank] ___\n\nself = <test_tensorflow_python_ops_ragged_ragged_array_ops.TestRaggedArrayOps object at 0x1683f5ae0>\ninput_shape = [], expected_size = 0, expected_rank = 1, test_type = 'rank'\n\n    @pytest.mark.parametrize(\n        \"input_shape, expected_size, expected_rank, test_type\",\n        [\n            # Test case from test_plan.json: size function\n            (\n                [[1, 2, 3], [4, 5], [6]],  # input_shape\n                6,  # expected_size: 3 + 2 + 1 = 6\n                2,  # expected_rank: 2D ragged tensor\n                \"size\"\n            ),\n            # Param extension: rank function with empty RaggedTensor\n            (\n                [],  # empty RaggedTensor\n                0,  # expected_size: 0 elements\n                1,  # expected_rank: 1D empty ragged tensor\n                \"rank\"\n            ),\n            # Additional test: 1D ragged tensor\n            (\n                [[1, 2, 3, 4, 5]],  # single row with 5 elements\n                5,  # expected_size\n                2,  # expected_rank: 2D (1 row, variable columns)\n                \"both\"\n            ),\n            # Additional test: 3D ragged tensor\n            (\n                [[[1, 2], [3]], [[4, 5, 6]]],  # 3D ragged tensor\n                6,  # expected_size: 2 + 1 + 3 = 6\n                3,  # expected_rank: 3D ragged tensor\n                \"both\"\n            ),\n            # Additional test: scalar-like ragged tensor (1 element)\n            (\n                [[[42]]],  # single element\n                1,  # expected_size\n                3,  # expected_rank: 3D ragged tensor\n                \"both\"\n            ),\n        ]\n    )\n    def test_size_and_rank_calculation(self, input_shape, expected_size, expected_rank, test_type):\n        \"\"\"Test size and rank calculations for RaggedTensors.\"\"\"\n        # Create RaggedTensor from input_shape\n        if input_shape == []:\n            # Special case: empty RaggedTensor\n            rt = tf.ragged.constant([], ragged_rank=1, dtype=tf.int32)\n        else:\n            rt = tf.ragged.constant(input_shape, dtype=tf.int32)\n    \n        # Test size function\n        if test_type in [\"size\", \"both\"]:\n            # Test with default out_type (tf.int32)\n            size_result = tf.size(rt)\n            assert size_result.dtype == tf.int32, f\"Expected dtype tf.int32, got {size_result.dtype}\"\n            assert size_result.shape == (), \"size() should return a scalar\"\n            assert size_result.numpy() == expected_size, \\\n                f\"Expected size {expected_size}, got {size_result.numpy()}\"\n    \n            # Test with tf.int64 out_type\n            size_result_int64 = tf.size(rt, out_type=tf.int64)\n            assert size_result_int64.dtype == tf.int64, f\"Expected dtype tf.int64, got {size_result_int64.dtype}\"\n            assert size_result_int64.numpy() == expected_size, \\\n                f\"Expected size {expected_size} with tf.int64, got {size_result_int64.numpy()}\"\n    \n        # Test rank function\n        if test_type in [\"rank\", \"both\"]:\n            rank_result = tf.rank(rt)\n            assert rank_result.dtype == tf.int32, f\"Expected dtype tf.int32, got {rank_result.dtype}\"\n            assert rank_result.shape == (), \"rank() should return a scalar\"\n    \n            # For empty RaggedTensor, TensorFlow returns rank 1\n            actual_rank = rank_result.numpy()\n            if input_shape == []:\n                # Empty RaggedTensor should have rank 1\n>               assert actual_rank == 1, \\\n                    f\"Expected rank 1 for empty RaggedTensor, got {actual_rank}\"\nE               AssertionError: Expected rank 1 for empty RaggedTensor, got 2\nE               assert 2 == 1\n\ntests/test_tensorflow_python_ops_ragged_ragged_array_ops.py:369: AssertionError\n=============================== warnings summary ===============================\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:18\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:18: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:36\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:36: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:43\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:43: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:29\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:29: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _TENSORSHAPEPROTO_DIM = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:73\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:73: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:80\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:80: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:66\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:66: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _TENSORSHAPEPROTO = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:19\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:19: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:33\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:33: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:37\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:37: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:41\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:41: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:45\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:45: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:49\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:49: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:53\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:53: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:57\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:57: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:61\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:61: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:65\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:65: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:69\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:69: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:73\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:73: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:77\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:77: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:81\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:81: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:85\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:85: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:89\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:89: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:93\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:93: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:97\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:97: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:101\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:101: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:105\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:105: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:109\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:109: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:113\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:113: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:117\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:117: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:121\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:121: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:125\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:125: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:129\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:129: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:133\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:133: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:137\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:137: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:141\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:141: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:145\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:145: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:149\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:149: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:153\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:153: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:157\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:157: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:161\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:161: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:165\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:165: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:169\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:169: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:173\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:173: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:177\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:177: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:181\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:181: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:185\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:185: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:189\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:189: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:193\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:193: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:197\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:197: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:201\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:201: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:205\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:205: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:209\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:209: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:213\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:213: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:217\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:217: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:27\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:27: DeprecationWarning: Call to deprecated create function EnumDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _DATATYPE = _descriptor.EnumDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:20\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:20: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:39\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:39: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:46\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:46: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:32\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:32: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _RESOURCEHANDLEPROTO_DTYPEANDSHAPE = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:76\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:76: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:83\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:83: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:90\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:90: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:97\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:97: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:104\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:104: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:111\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:111: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:69\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:69: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _RESOURCEHANDLEPROTO = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:21\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:21: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:40\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:40: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:47\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:47: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:54\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:54: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:61\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:61: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:68\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:68: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:75\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:75: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:82\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:82: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:89\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:89: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:96\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:96: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:103\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:103: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:110\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:110: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:117\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:117: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:124\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:124: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:131\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:131: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:138\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:138: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:145\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:145: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:152\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:152: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:33\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:33: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _TENSORPROTO = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:183\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:183: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:190\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:190: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:197\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:197: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:176\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:176: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _VARIANTTENSORDATAPROTO = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:21\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:21: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:40\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:40: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:47\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:47: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:54\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:54: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:61\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:61: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:68\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:68: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:75\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:75: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:82\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:82: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:89\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:89: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:33\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:33: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _ATTRVALUE_LISTVALUE = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/framework/dtypes.py:205\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/framework/dtypes.py:205: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)\n    np.bool8: (False, True),\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/flatbuffers/compat.py:19\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/flatbuffers/compat.py:19: DeprecationWarning: the imp module is deprecated in favour of importlib and slated for removal in Python 3.12; see the module's documentation for alternative uses\n    import imp\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:326\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:326: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)\n    np.bool8: (False, True),\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n================================ tests coverage ================================\n______________ coverage: platform darwin, python 3.10.19-final-0 _______________\n\nName                                                          Stmts   Miss Branch BrPart  Cover   Missing\n---------------------------------------------------------------------------------------------------------\ntests/test_tensorflow_python_ops_ragged_ragged_array_ops.py     158     11     52      6    90%   35-48, 52, 289->exit, 376->388, 379->388, 388->exit, 390->exit, 445\n---------------------------------------------------------------------------------------------------------\nTOTAL                                                           158     11     52      6    90%\nCoverage XML written to file coverage.xml\n=========================== short test summary info ============================\nFAILED tests/test_tensorflow_python_ops_ragged_ragged_array_ops.py::TestRaggedArrayOps::test_size_and_rank_calculation[input_shape1-0-1-rank]\n1 failed, 18 passed, 103 warnings in 3.20s\n\nError: exit 1",
    "exit_code.txt": "1",
    "analysis_plan.json": "{\n  \"status\": \"未完全通过\",\n  \"passed\": 18,\n  \"failed\": 1,\n  \"errors\": 0,\n  \"collection_errors\": false,\n  \"block_limit\": 3,\n  \"failures\": [\n    {\n      \"test\": \"TestRaggedArrayOps.test_size_and_rank_calculation[input_shape1-0-1-rank]\",\n      \"block_id\": \"CASE_04\",\n      \"error_type\": \"AssertionError\",\n      \"action\": \"adjust_assertion\",\n      \"note\": \"空RaggedTensor的rank计算错误，预期1但实际2，需要根据TensorFlow实际行为调整断言\"\n    }\n  ],\n  \"deferred\": [],\n  \"stop_recommended\": false,\n  \"stop_reason\": \"\"\n}",
    "analysis.md": "# 测试结果分析\n\n## 状态与统计\n- **状态**: 未完全通过\n- **通过**: 18个测试\n- **失败**: 1个测试\n- **错误**: 0个\n- **集合错误**: 无\n\n## 待修复BLOCK列表（最多3个）\n\n### 1. CASE_04块 - 调整断言\n- **测试**: TestRaggedArrayOps.test_size_and_rank_calculation[input_shape1-0-1-rank]\n- **错误类型**: AssertionError\n- **操作**: adjust_assertion\n- **原因**: 空RaggedTensor的rank计算错误，预期1但实际2，需要根据TensorFlow实际行为调整断言\n\n## 停止建议\n- **stop_recommended**: false\n- **stop_reason**: 无",
    "final_report.md": "# tensorflow.python.ops.ragged.ragged_array_ops 测试报告\n\n## 1. 执行摘要\n测试基本通过，仅有一个关于空RaggedTensor秩计算的断言需要调整；模块核心功能（boolean_mask、tile、expand_dims等）均正常工作，满足基本使用需求。\n\n**关键发现**：空RaggedTensor的rank计算行为与预期不符，需要根据TensorFlow实际实现调整测试断言。\n\n## 2. 测试范围\n- **目标FQN**: tensorflow.python.ops.ragged.ragged_array_ops\n- **测试环境**: pytest + TensorFlow运行时\n- **覆盖场景**:\n  - boolean_mask基本功能：正确过滤RaggedTensor元素\n  - tile复制功能：验证多维复制逻辑\n  - expand_dims维度扩展：单轴和多轴扩展\n  - size和rank计算：验证元素计数和维度数\n  - 混合类型操作：RaggedTensor与普通Tensor互操作\n- **未覆盖项**:\n  - reverse、cross、dynamic_partition、split、reshape等可选函数\n  - 深度嵌套RaggedTensor边界情况\n  - GPU设备兼容性测试\n  - 大规模数据性能测试\n\n## 3. 结果概览\n- **用例总数**: 19个测试\n- **通过**: 18个（94.7%）\n- **失败**: 1个（5.3%）\n- **错误**: 0个\n- **主要失败点**: 空RaggedTensor的rank计算断言不匹配\n\n## 4. 详细发现\n\n### 高优先级问题\n**问题1**: 空RaggedTensor秩计算断言错误\n- **严重级别**: 低（仅测试断言问题，非功能缺陷）\n- **根因**: 测试预期空RaggedTensor的rank为1，但TensorFlow实际返回2\n- **影响**: 仅影响测试通过率，不影响模块功能\n- **建议修复**: 调整测试断言以匹配TensorFlow实际行为\n\n### 中优先级问题\n**问题2**: 可选函数未测试\n- **严重级别**: 中\n- **根因**: 测试计划仅覆盖核心高优先级函数\n- **影响**: reverse、cross、dynamic_partition、split、reshape等函数缺乏验证\n- **建议修复**: 补充可选函数的测试用例\n\n## 5. 覆盖与风险\n- **需求覆盖**: 5个高优先级需求全部覆盖，核心功能验证完成\n- **尚未覆盖的边界**:\n  - 递归处理逻辑的深度限制\n  - 内存使用边界情况\n  - 稀疏张量互操作性\n  - 分布式环境行为\n  - GPU设备兼容性\n- **缺失信息**: 部分函数缺少完整类型注解，但测试验证了实际行为\n\n## 6. 后续动作\n\n### P0（立即执行）\n1. **修复测试断言**: 调整TestRaggedArrayOps.test_size_and_rank_calculation中对空RaggedTensor rank的断言，从预期1改为预期2\n\n### P1（下一迭代）\n2. **补充可选函数测试**: 为reverse、cross、dynamic_partition、split、reshape等函数添加基础测试用例\n3. **边界情况扩展**: 添加深度嵌套RaggedTensor和大规模数据的边界测试\n\n### P2（后续规划）\n4. **环境兼容性测试**: 考虑添加GPU设备兼容性验证\n5. **性能基准**: 添加大规模数据性能测试，建立性能基线\n\n### 风险缓解建议\n- 对于生产环境使用，建议在部署前补充reverse、cross等可选函数的测试\n- 深度嵌套和大规模数据场景建议在实际使用前进行针对性验证\n- 分布式环境行为需要结合具体部署架构进行测试"
  },
  "stage_history": [
    {
      "stage": "understand_function",
      "status": "completed",
      "timestamp": "2026-01-25T06:33:01.999591",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "generate_requirements",
      "status": "completed",
      "timestamp": "2026-01-25T06:33:43.878152",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "design_test_plan",
      "status": "completed",
      "timestamp": "2026-01-25T06:35:09.687887",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-25T06:37:45.538584",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-25T06:37:49.810562",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-25T06:39:12.743307",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-25T06:41:33.916653",
      "attempts": 2,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-25T06:41:38.879408",
      "attempts": 2,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-25T06:42:57.716488",
      "attempts": 2,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-25T06:45:01.139408",
      "attempts": 3,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-25T06:45:04.705823",
      "attempts": 3,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-25T06:45:47.441946",
      "attempts": 3,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-25T06:47:24.700542",
      "attempts": 4,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-25T06:47:28.890079",
      "attempts": 4,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-25T06:48:46.929346",
      "attempts": 4,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-25T06:50:26.167252",
      "attempts": 5,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-25T06:50:30.303415",
      "attempts": 5,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-25T06:51:35.271349",
      "attempts": 5,
      "error": null
    },
    {
      "stage": "generate_report",
      "status": "completed",
      "timestamp": "2026-01-25T06:52:12.539767",
      "attempts": 1,
      "error": null
    }
  ],
  "user_feedback": []
}