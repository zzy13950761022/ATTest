# tensorflow.python.data.ops.dataset_ops 测试计划

## 1. 测试策略
- 单元测试框架：pytest
- 隔离策略：使用 fixtures 管理数据集生命周期，mock 文件 I/O
- 随机性处理：固定随机种子控制 shuffle 操作可重复性
- 设备隔离：CPU-only 测试，避免 GPU 依赖

## 2. 生成规格摘要（来自 test_plan.json）
- **SMOKE_SET**: CASE_01, CASE_02, CASE_03, CASE_04
- **DEFERRED_SET**: CASE_05, CASE_06, CASE_07
- **group 列表**: G1（数据集创建与基本操作）, G2（数据转换操作）
- **active_group_order**: G1 → G2
- **断言分级策略**: 首轮使用 weak 断言（形状、基数、迭代完整性）
- **预算策略**: 
  - Size S: max_lines=60-70, max_params=4-5
  - Size M: max_lines=80-85, max_params=6
  - 所有用例均为参数化测试

## 3. 数据与边界
- **正常数据集**: 小/中尺寸张量（5-100元素），标准数据类型
- **随机生成策略**: 固定种子生成可重复测试数据
- **边界值**: 空数据集、单元素、大尺寸（100+元素）
- **极端形状**: 零维张量、高维嵌套结构
- **空输入**: 空列表、零形状张量
- **负例场景**: 类型不匹配、形状不一致、无效操作链
- **异常场景**: 内存不足模拟、文件权限错误、无效函数参数

## 4. 覆盖映射
| TC ID | 对应需求 | 覆盖约束 | 风险点 |
|-------|----------|----------|--------|
| TC-01 | 数据集创建路径 | 张量切片创建、元素规范 | 类型转换边界 |
| TC-02 | Python数据源 | 列表到张量转换 | 内存使用效率 |
| TC-03 | map操作核心 | 函数应用、形状保持 | 并行执行正确性 |
| TC-04 | batch操作核心 | 分组逻辑、尾部处理 | 内存碎片化 |
| TC-05 | 边界值处理 | 空数据集迭代 | 错误消息质量 |

**尚未覆盖的关键风险点**:
1. shuffle 随机性验证（需要统计测试）
2. 嵌套结构数据集处理
3. 动态形状支持
4. 图模式与 eager 模式差异
5. 内存泄漏检测机制