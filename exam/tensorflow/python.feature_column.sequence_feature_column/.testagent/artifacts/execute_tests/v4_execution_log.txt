=== Run Tests ===
FFFF.                                                                    [100%]
================================== FAILURES ===================================
_ TestSequenceFeatureColumnG1.test_sequence_categorical_column_creation[sequence_categorical_column_with_identity-params0-SequenceCategoricalColumn-False] _

self = <test_tensorflow_python_feature_column_sequence_feature_column_g1.TestSequenceFeatureColumnG1 object at 0x000002323318B280>
func_name = 'sequence_categorical_column_with_identity'
params = {'default_value': 0, 'key': 'test_feature', 'num_buckets': 10}
expected_type = 'SequenceCategoricalColumn', expect_failure = False

    @pytest.mark.parametrize("func_name,params,expected_type,expect_failure", [
        ("sequence_categorical_column_with_identity",
         {"key": "test_feature", "num_buckets": 10, "default_value": 0},
         "SequenceCategoricalColumn", False),
        ("sequence_categorical_column_with_hash_bucket",
         {"key": "test_feature", "hash_bucket_size": 100, "dtype": tf.int64},
         "SequenceCategoricalColumn", False),
        # Parameter extensions from test_plan.json
        # Note: default_value=-1 is invalid for num_buckets=1000, so we change it to 0
        ("sequence_categorical_column_with_identity",
         {"key": "extended_feature", "num_buckets": 1000, "default_value": 0},
         "SequenceCategoricalColumn", False),
        ("sequence_categorical_column_with_hash_bucket",
         {"key": "large_hash", "hash_bucket_size": 10000, "dtype": tf.string},
         "SequenceCategoricalColumn", False),
    ])
    def test_sequence_categorical_column_creation(self, func_name, params, expected_type, expect_failure):
        """Test basic creation of sequence categorical columns (CASE_01)."""
        # Get the function
        func = globals()[func_name]
    
        # Handle expected failures
        if expect_failure:
            with pytest.raises(ValueError):
                func(**params)
            return
    
        # Create the feature column
        column = func(**params)
    
        # Weak assertions
        # 1. Check instance type
        assert column is not None
        assert hasattr(column, '__class__')
        assert expected_type in column.__class__.__name__
    
        # 2. Check has key property - SequenceCategoricalColumn wraps categorical_column
        # The key is accessed through the categorical_column property
        assert hasattr(column, 'categorical_column')
        categorical_column = column.categorical_column
        assert hasattr(categorical_column, 'key')
        assert categorical_column.key == params['key']
    
        # 3. Check has dtype property
        if 'dtype' in params:
            assert hasattr(categorical_column, 'dtype')
            # Convert tf.dtype to string for comparison
            if hasattr(categorical_column.dtype, 'name'):
                assert categorical_column.dtype.name == params['dtype'].name
            else:
                assert str(categorical_column.dtype) == str(params['dtype'])
    
        # 4. Check has num_buckets or hash_bucket_size property
        if 'num_buckets' in params:
            assert hasattr(categorical_column, 'num_buckets')
            assert categorical_column.num_buckets == params['num_buckets']
        elif 'hash_bucket_size' in params:
            assert hasattr(categorical_column, 'hash_bucket_size')
            assert categorical_column.hash_bucket_size == params['hash_bucket_size']
    
        # 5. Check default_value if provided
        if 'default_value' in params:
            assert hasattr(categorical_column, 'default_value')
            assert categorical_column.default_value == params['default_value']
    
        # Additional basic checks
        assert hasattr(column, 'name')
        assert isinstance(column.name, str)
    
        # Check that it's a sequence column
        assert hasattr(column, '_is_v2_column')
        # Note: In TensorFlow 2.x, all feature columns are v2 columns
    
        # Check that the column has the expected properties for sequence processing
>       assert hasattr(column, '_get_sequence_dense_tensor')
E       AssertionError: assert False
E        +  where False = hasattr(SequenceCategoricalColumn(categorical_column=IdentityCategoricalColumn(key='test_feature', number_buckets=10, default_value=0)), '_get_sequence_dense_tensor')

tests\test_tensorflow_python_feature_column_sequence_feature_column_g1.py:122: AssertionError
_ TestSequenceFeatureColumnG1.test_sequence_categorical_column_creation[sequence_categorical_column_with_hash_bucket-params1-SequenceCategoricalColumn-False] _

self = <test_tensorflow_python_feature_column_sequence_feature_column_g1.TestSequenceFeatureColumnG1 object at 0x000002323318B2E0>
func_name = 'sequence_categorical_column_with_hash_bucket'
params = {'dtype': tf.int64, 'hash_bucket_size': 100, 'key': 'test_feature'}
expected_type = 'SequenceCategoricalColumn', expect_failure = False

    @pytest.mark.parametrize("func_name,params,expected_type,expect_failure", [
        ("sequence_categorical_column_with_identity",
         {"key": "test_feature", "num_buckets": 10, "default_value": 0},
         "SequenceCategoricalColumn", False),
        ("sequence_categorical_column_with_hash_bucket",
         {"key": "test_feature", "hash_bucket_size": 100, "dtype": tf.int64},
         "SequenceCategoricalColumn", False),
        # Parameter extensions from test_plan.json
        # Note: default_value=-1 is invalid for num_buckets=1000, so we change it to 0
        ("sequence_categorical_column_with_identity",
         {"key": "extended_feature", "num_buckets": 1000, "default_value": 0},
         "SequenceCategoricalColumn", False),
        ("sequence_categorical_column_with_hash_bucket",
         {"key": "large_hash", "hash_bucket_size": 10000, "dtype": tf.string},
         "SequenceCategoricalColumn", False),
    ])
    def test_sequence_categorical_column_creation(self, func_name, params, expected_type, expect_failure):
        """Test basic creation of sequence categorical columns (CASE_01)."""
        # Get the function
        func = globals()[func_name]
    
        # Handle expected failures
        if expect_failure:
            with pytest.raises(ValueError):
                func(**params)
            return
    
        # Create the feature column
        column = func(**params)
    
        # Weak assertions
        # 1. Check instance type
        assert column is not None
        assert hasattr(column, '__class__')
        assert expected_type in column.__class__.__name__
    
        # 2. Check has key property - SequenceCategoricalColumn wraps categorical_column
        # The key is accessed through the categorical_column property
        assert hasattr(column, 'categorical_column')
        categorical_column = column.categorical_column
        assert hasattr(categorical_column, 'key')
        assert categorical_column.key == params['key']
    
        # 3. Check has dtype property
        if 'dtype' in params:
            assert hasattr(categorical_column, 'dtype')
            # Convert tf.dtype to string for comparison
            if hasattr(categorical_column.dtype, 'name'):
                assert categorical_column.dtype.name == params['dtype'].name
            else:
                assert str(categorical_column.dtype) == str(params['dtype'])
    
        # 4. Check has num_buckets or hash_bucket_size property
        if 'num_buckets' in params:
            assert hasattr(categorical_column, 'num_buckets')
            assert categorical_column.num_buckets == params['num_buckets']
        elif 'hash_bucket_size' in params:
            assert hasattr(categorical_column, 'hash_bucket_size')
            assert categorical_column.hash_bucket_size == params['hash_bucket_size']
    
        # 5. Check default_value if provided
        if 'default_value' in params:
            assert hasattr(categorical_column, 'default_value')
            assert categorical_column.default_value == params['default_value']
    
        # Additional basic checks
        assert hasattr(column, 'name')
        assert isinstance(column.name, str)
    
        # Check that it's a sequence column
        assert hasattr(column, '_is_v2_column')
        # Note: In TensorFlow 2.x, all feature columns are v2 columns
    
        # Check that the column has the expected properties for sequence processing
>       assert hasattr(column, '_get_sequence_dense_tensor')
E       AssertionError: assert False
E        +  where False = hasattr(SequenceCategoricalColumn(categorical_column=HashedCategoricalColumn(key='test_feature', hash_bucket_size=100, dtype=tf.int64)), '_get_sequence_dense_tensor')

tests\test_tensorflow_python_feature_column_sequence_feature_column_g1.py:122: AssertionError
_ TestSequenceFeatureColumnG1.test_sequence_categorical_column_creation[sequence_categorical_column_with_identity-params2-SequenceCategoricalColumn-False] _

self = <test_tensorflow_python_feature_column_sequence_feature_column_g1.TestSequenceFeatureColumnG1 object at 0x000002323318B520>
func_name = 'sequence_categorical_column_with_identity'
params = {'default_value': 0, 'key': 'extended_feature', 'num_buckets': 1000}
expected_type = 'SequenceCategoricalColumn', expect_failure = False

    @pytest.mark.parametrize("func_name,params,expected_type,expect_failure", [
        ("sequence_categorical_column_with_identity",
         {"key": "test_feature", "num_buckets": 10, "default_value": 0},
         "SequenceCategoricalColumn", False),
        ("sequence_categorical_column_with_hash_bucket",
         {"key": "test_feature", "hash_bucket_size": 100, "dtype": tf.int64},
         "SequenceCategoricalColumn", False),
        # Parameter extensions from test_plan.json
        # Note: default_value=-1 is invalid for num_buckets=1000, so we change it to 0
        ("sequence_categorical_column_with_identity",
         {"key": "extended_feature", "num_buckets": 1000, "default_value": 0},
         "SequenceCategoricalColumn", False),
        ("sequence_categorical_column_with_hash_bucket",
         {"key": "large_hash", "hash_bucket_size": 10000, "dtype": tf.string},
         "SequenceCategoricalColumn", False),
    ])
    def test_sequence_categorical_column_creation(self, func_name, params, expected_type, expect_failure):
        """Test basic creation of sequence categorical columns (CASE_01)."""
        # Get the function
        func = globals()[func_name]
    
        # Handle expected failures
        if expect_failure:
            with pytest.raises(ValueError):
                func(**params)
            return
    
        # Create the feature column
        column = func(**params)
    
        # Weak assertions
        # 1. Check instance type
        assert column is not None
        assert hasattr(column, '__class__')
        assert expected_type in column.__class__.__name__
    
        # 2. Check has key property - SequenceCategoricalColumn wraps categorical_column
        # The key is accessed through the categorical_column property
        assert hasattr(column, 'categorical_column')
        categorical_column = column.categorical_column
        assert hasattr(categorical_column, 'key')
        assert categorical_column.key == params['key']
    
        # 3. Check has dtype property
        if 'dtype' in params:
            assert hasattr(categorical_column, 'dtype')
            # Convert tf.dtype to string for comparison
            if hasattr(categorical_column.dtype, 'name'):
                assert categorical_column.dtype.name == params['dtype'].name
            else:
                assert str(categorical_column.dtype) == str(params['dtype'])
    
        # 4. Check has num_buckets or hash_bucket_size property
        if 'num_buckets' in params:
            assert hasattr(categorical_column, 'num_buckets')
            assert categorical_column.num_buckets == params['num_buckets']
        elif 'hash_bucket_size' in params:
            assert hasattr(categorical_column, 'hash_bucket_size')
            assert categorical_column.hash_bucket_size == params['hash_bucket_size']
    
        # 5. Check default_value if provided
        if 'default_value' in params:
            assert hasattr(categorical_column, 'default_value')
            assert categorical_column.default_value == params['default_value']
    
        # Additional basic checks
        assert hasattr(column, 'name')
        assert isinstance(column.name, str)
    
        # Check that it's a sequence column
        assert hasattr(column, '_is_v2_column')
        # Note: In TensorFlow 2.x, all feature columns are v2 columns
    
        # Check that the column has the expected properties for sequence processing
>       assert hasattr(column, '_get_sequence_dense_tensor')
E       AssertionError: assert False
E        +  where False = hasattr(SequenceCategoricalColumn(categorical_column=IdentityCategoricalColumn(key='extended_feature', number_buckets=1000, default_value=0)), '_get_sequence_dense_tensor')

tests\test_tensorflow_python_feature_column_sequence_feature_column_g1.py:122: AssertionError
_ TestSequenceFeatureColumnG1.test_sequence_categorical_column_creation[sequence_categorical_column_with_hash_bucket-params3-SequenceCategoricalColumn-False] _

self = <test_tensorflow_python_feature_column_sequence_feature_column_g1.TestSequenceFeatureColumnG1 object at 0x000002323318B5E0>
func_name = 'sequence_categorical_column_with_hash_bucket'
params = {'dtype': tf.string, 'hash_bucket_size': 10000, 'key': 'large_hash'}
expected_type = 'SequenceCategoricalColumn', expect_failure = False

    @pytest.mark.parametrize("func_name,params,expected_type,expect_failure", [
        ("sequence_categorical_column_with_identity",
         {"key": "test_feature", "num_buckets": 10, "default_value": 0},
         "SequenceCategoricalColumn", False),
        ("sequence_categorical_column_with_hash_bucket",
         {"key": "test_feature", "hash_bucket_size": 100, "dtype": tf.int64},
         "SequenceCategoricalColumn", False),
        # Parameter extensions from test_plan.json
        # Note: default_value=-1 is invalid for num_buckets=1000, so we change it to 0
        ("sequence_categorical_column_with_identity",
         {"key": "extended_feature", "num_buckets": 1000, "default_value": 0},
         "SequenceCategoricalColumn", False),
        ("sequence_categorical_column_with_hash_bucket",
         {"key": "large_hash", "hash_bucket_size": 10000, "dtype": tf.string},
         "SequenceCategoricalColumn", False),
    ])
    def test_sequence_categorical_column_creation(self, func_name, params, expected_type, expect_failure):
        """Test basic creation of sequence categorical columns (CASE_01)."""
        # Get the function
        func = globals()[func_name]
    
        # Handle expected failures
        if expect_failure:
            with pytest.raises(ValueError):
                func(**params)
            return
    
        # Create the feature column
        column = func(**params)
    
        # Weak assertions
        # 1. Check instance type
        assert column is not None
        assert hasattr(column, '__class__')
        assert expected_type in column.__class__.__name__
    
        # 2. Check has key property - SequenceCategoricalColumn wraps categorical_column
        # The key is accessed through the categorical_column property
        assert hasattr(column, 'categorical_column')
        categorical_column = column.categorical_column
        assert hasattr(categorical_column, 'key')
        assert categorical_column.key == params['key']
    
        # 3. Check has dtype property
        if 'dtype' in params:
            assert hasattr(categorical_column, 'dtype')
            # Convert tf.dtype to string for comparison
            if hasattr(categorical_column.dtype, 'name'):
                assert categorical_column.dtype.name == params['dtype'].name
            else:
                assert str(categorical_column.dtype) == str(params['dtype'])
    
        # 4. Check has num_buckets or hash_bucket_size property
        if 'num_buckets' in params:
            assert hasattr(categorical_column, 'num_buckets')
            assert categorical_column.num_buckets == params['num_buckets']
        elif 'hash_bucket_size' in params:
            assert hasattr(categorical_column, 'hash_bucket_size')
            assert categorical_column.hash_bucket_size == params['hash_bucket_size']
    
        # 5. Check default_value if provided
        if 'default_value' in params:
            assert hasattr(categorical_column, 'default_value')
            assert categorical_column.default_value == params['default_value']
    
        # Additional basic checks
        assert hasattr(column, 'name')
        assert isinstance(column.name, str)
    
        # Check that it's a sequence column
        assert hasattr(column, '_is_v2_column')
        # Note: In TensorFlow 2.x, all feature columns are v2 columns
    
        # Check that the column has the expected properties for sequence processing
>       assert hasattr(column, '_get_sequence_dense_tensor')
E       AssertionError: assert False
E        +  where False = hasattr(SequenceCategoricalColumn(categorical_column=HashedCategoricalColumn(key='large_hash', hash_bucket_size=10000, dtype=tf.string)), '_get_sequence_dense_tensor')

tests\test_tensorflow_python_feature_column_sequence_feature_column_g1.py:122: AssertionError

---------- coverage: platform win32, python 3.9.25-final-0 -----------
Name                                                                        Stmts   Miss Branch BrPart  Cover   Missing
-----------------------------------------------------------------------------------------------------------------------
tests\test_tensorflow_python_feature_column_sequence_feature_column_g1.py      85     16     18      5    78%   35-44, 71-73, 98, 104->109, 123, 155, 206
-----------------------------------------------------------------------------------------------------------------------
TOTAL                                                                          85     16     18      5    78%
Coverage XML written to file coverage.xml

=========================== short test summary info ===========================
FAILED tests\test_tensorflow_python_feature_column_sequence_feature_column_g1.py::TestSequenceFeatureColumnG1::test_sequence_categorical_column_creation[sequence_categorical_column_with_identity-params0-SequenceCategoricalColumn-False]
FAILED tests\test_tensorflow_python_feature_column_sequence_feature_column_g1.py::TestSequenceFeatureColumnG1::test_sequence_categorical_column_creation[sequence_categorical_column_with_hash_bucket-params1-SequenceCategoricalColumn-False]
FAILED tests\test_tensorflow_python_feature_column_sequence_feature_column_g1.py::TestSequenceFeatureColumnG1::test_sequence_categorical_column_creation[sequence_categorical_column_with_identity-params2-SequenceCategoricalColumn-False]
FAILED tests\test_tensorflow_python_feature_column_sequence_feature_column_g1.py::TestSequenceFeatureColumnG1::test_sequence_categorical_column_creation[sequence_categorical_column_with_hash_bucket-params3-SequenceCategoricalColumn-False]
4 failed, 1 passed in 1.58s

Error: exit 1