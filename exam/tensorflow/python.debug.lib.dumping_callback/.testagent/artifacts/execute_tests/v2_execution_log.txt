=== Run Tests ===
EF.EEE                                                                   [100%]
=================================== ERRORS ====================================
______________ ERROR at setup of test_basic_enable_disable_flow _______________

thing = <module 'tensorflow' from 'D:\\Coding\\Anaconda\\envs\\testagent-experiment\\lib\\site-packages\\tensorflow\\__init__.py'>
comp = 'python', import_path = 'tensorflow.python'

    def _dot_lookup(thing, comp, import_path):
        try:
>           return getattr(thing, comp)
E           AttributeError: module 'tensorflow' has no attribute 'python'

D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1226: AttributeError

During handling of the above exception, another exception occurred:

    @pytest.fixture
    def mock_debug_events_writer():
        """Mock DebugEventsWriter to avoid actual file I/O."""
        # Use the correct import path for TensorFlow 2.x
>       with mock.patch('tensorflow.python.debug.lib.dumping_callback.debug_events_writer.DebugEventsWriter') as mock_writer:

tests\test_tensorflow_python_debug_lib_dumping_callback.py:27: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1388: in __enter__
    self.target = self.getter()
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1563: in <lambda>
    getter = lambda: _importer(target)
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1239: in _importer
    thing = _dot_lookup(thing, comp, import_path)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

thing = <module 'tensorflow' from 'D:\\Coding\\Anaconda\\envs\\testagent-experiment\\lib\\site-packages\\tensorflow\\__init__.py'>
comp = 'python', import_path = 'tensorflow.python'

    def _dot_lookup(thing, comp, import_path):
        try:
            return getattr(thing, comp)
        except AttributeError:
            __import__(import_path)
>           return getattr(thing, comp)
E           AttributeError: module 'tensorflow' has no attribute 'python'

D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1229: AttributeError
____________ ERROR at setup of test_basic_tensor_debug_mode_shape _____________

thing = <module 'tensorflow' from 'D:\\Coding\\Anaconda\\envs\\testagent-experiment\\lib\\site-packages\\tensorflow\\__init__.py'>
comp = 'python', import_path = 'tensorflow.python'

    def _dot_lookup(thing, comp, import_path):
        try:
>           return getattr(thing, comp)
E           AttributeError: module 'tensorflow' has no attribute 'python'

D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1226: AttributeError

During handling of the above exception, another exception occurred:

    @pytest.fixture
    def mock_debug_events_writer():
        """Mock DebugEventsWriter to avoid actual file I/O."""
        # Use the correct import path for TensorFlow 2.x
>       with mock.patch('tensorflow.python.debug.lib.dumping_callback.debug_events_writer.DebugEventsWriter') as mock_writer:

tests\test_tensorflow_python_debug_lib_dumping_callback.py:27: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1388: in __enter__
    self.target = self.getter()
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1563: in <lambda>
    getter = lambda: _importer(target)
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1239: in _importer
    thing = _dot_lookup(thing, comp, import_path)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

thing = <module 'tensorflow' from 'D:\\Coding\\Anaconda\\envs\\testagent-experiment\\lib\\site-packages\\tensorflow\\__init__.py'>
comp = 'python', import_path = 'tensorflow.python'

    def _dot_lookup(thing, comp, import_path):
        try:
            return getattr(thing, comp)
        except AttributeError:
            __import__(import_path)
>           return getattr(thing, comp)
E           AttributeError: module 'tensorflow' has no attribute 'python'

D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1229: AttributeError
___________________ ERROR at setup of test_curt_health_mode ___________________

thing = <module 'tensorflow' from 'D:\\Coding\\Anaconda\\envs\\testagent-experiment\\lib\\site-packages\\tensorflow\\__init__.py'>
comp = 'python', import_path = 'tensorflow.python'

    def _dot_lookup(thing, comp, import_path):
        try:
>           return getattr(thing, comp)
E           AttributeError: module 'tensorflow' has no attribute 'python'

D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1226: AttributeError

During handling of the above exception, another exception occurred:

    @pytest.fixture
    def mock_debug_events_writer():
        """Mock DebugEventsWriter to avoid actual file I/O."""
        # Use the correct import path for TensorFlow 2.x
>       with mock.patch('tensorflow.python.debug.lib.dumping_callback.debug_events_writer.DebugEventsWriter') as mock_writer:

tests\test_tensorflow_python_debug_lib_dumping_callback.py:27: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1388: in __enter__
    self.target = self.getter()
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1563: in <lambda>
    getter = lambda: _importer(target)
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1239: in _importer
    thing = _dot_lookup(thing, comp, import_path)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

thing = <module 'tensorflow' from 'D:\\Coding\\Anaconda\\envs\\testagent-experiment\\lib\\site-packages\\tensorflow\\__init__.py'>
comp = 'python', import_path = 'tensorflow.python'

    def _dot_lookup(thing, comp, import_path):
        try:
            return getattr(thing, comp)
        except AttributeError:
            __import__(import_path)
>           return getattr(thing, comp)
E           AttributeError: module 'tensorflow' has no attribute 'python'

D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1229: AttributeError
__________________ ERROR at setup of test_op_regex_filtering __________________

thing = <module 'tensorflow' from 'D:\\Coding\\Anaconda\\envs\\testagent-experiment\\lib\\site-packages\\tensorflow\\__init__.py'>
comp = 'python', import_path = 'tensorflow.python'

    def _dot_lookup(thing, comp, import_path):
        try:
>           return getattr(thing, comp)
E           AttributeError: module 'tensorflow' has no attribute 'python'

D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1226: AttributeError

During handling of the above exception, another exception occurred:

    @pytest.fixture
    def mock_debug_events_writer():
        """Mock DebugEventsWriter to avoid actual file I/O."""
        # Use the correct import path for TensorFlow 2.x
>       with mock.patch('tensorflow.python.debug.lib.dumping_callback.debug_events_writer.DebugEventsWriter') as mock_writer:

tests\test_tensorflow_python_debug_lib_dumping_callback.py:27: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1388: in __enter__
    self.target = self.getter()
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1563: in <lambda>
    getter = lambda: _importer(target)
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1239: in _importer
    thing = _dot_lookup(thing, comp, import_path)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

thing = <module 'tensorflow' from 'D:\\Coding\\Anaconda\\envs\\testagent-experiment\\lib\\site-packages\\tensorflow\\__init__.py'>
comp = 'python', import_path = 'tensorflow.python'

    def _dot_lookup(thing, comp, import_path):
        try:
            return getattr(thing, comp)
        except AttributeError:
            __import__(import_path)
>           return getattr(thing, comp)
E           AttributeError: module 'tensorflow' has no attribute 'python'

D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1229: AttributeError
================================== FAILURES ===================================
_ test_invalid_parameters_exception_handling[-NO_TENSOR-ValueError-empty or none dump root] _

dump_root = '', tensor_debug_mode = 'NO_TENSOR'
expected_error_type = <class 'ValueError'>
error_contains = 'empty or none dump root', reset_dumping_state = None

    @pytest.mark.parametrize(
        "dump_root,tensor_debug_mode,expected_error_type,error_contains",
        [
            # Test case 1: empty dump_root
            (
                "",  # empty dump_root
                "NO_TENSOR",
                ValueError,
                "empty or none dump root"  # Updated to match actual error message
            ),
            # Test case 2: invalid tensor_debug_mode
            (
                "/tmp/test_dump_2",
                "INVALID_MODE",  # invalid mode
                ValueError,
                "tensor_debug_mode"  # Keep original for invalid mode
            ),
        ]
    )
    def test_invalid_parameters_exception_handling(
        dump_root,
        tensor_debug_mode,
        expected_error_type,
        error_contains,
        reset_dumping_state
    ):
        """TC-02: 无效参数异常处理"""
        # Weak assertion: empty_dump_root_error / invalid_mode_error
        with pytest.raises(expected_error_type) as exc_info:
            dumping_callback.enable_dump_debug_info(
                dump_root=dump_root,
                tensor_debug_mode=tensor_debug_mode,
                circular_buffer_size=1000,
                op_regex=None,
                tensor_dtypes=None
            )
    
        # Weak assertion: error_message_contains
        error_msg = str(exc_info.value).lower()
        assert error_contains.lower() in error_msg, \
            f"Error message should contain '{error_contains}', got: {error_msg}"
    
        # Weak assertion: no_side_effects (state should not be set)
>       assert not hasattr(dumping_callback._state, 'dumping_callback'), \
            "State should not be set when enable fails"
E       AssertionError: State should not be set when enable fails
E       assert not True
E        +  where True = hasattr(<_thread._local object at 0x000001FA59837D10>, 'dumping_callback')
E        +    where <_thread._local object at 0x000001FA59837D10> = dumping_callback._state

tests\test_tensorflow_python_debug_lib_dumping_callback.py:149: AssertionError

---------- coverage: platform win32, python 3.9.25-final-0 -----------
Name                                                         Stmts   Miss Branch BrPart  Cover   Missing
--------------------------------------------------------------------------------------------------------
tests\test_tensorflow_python_debug_lib_dumping_callback.py      98     59      6      2    41%   20->exit, 28-30, 36-39, 68-101, 170-221, 234-274, 295-341, 355
--------------------------------------------------------------------------------------------------------
TOTAL                                                           98     59      6      2    41%
Coverage XML written to file coverage.xml

=========================== short test summary info ===========================
FAILED tests\test_tensorflow_python_debug_lib_dumping_callback.py::test_invalid_parameters_exception_handling[-NO_TENSOR-ValueError-empty or none dump root]
ERROR tests\test_tensorflow_python_debug_lib_dumping_callback.py::test_basic_enable_disable_flow
ERROR tests\test_tensorflow_python_debug_lib_dumping_callback.py::test_basic_tensor_debug_mode_shape
ERROR tests\test_tensorflow_python_debug_lib_dumping_callback.py::test_curt_health_mode
ERROR tests\test_tensorflow_python_debug_lib_dumping_callback.py::test_op_regex_filtering
1 failed, 1 passed, 4 errors in 1.96s

Error: exit 1