{
  "workflow_id": "5c3e5a17",
  "created_at": "2026-01-25T10:54:24.541633",
  "op": "tensorflow_python_ops_script_ops",
  "arch": "python",
  "soc": "python",
  "vendor": "python",
  "project_root": "/Users/zzf1sh/Documents/Project/TestAgent-CLI-main/exam/tensorflow/python.ops.script_ops",
  "target": "tensorflow.python.ops.script_ops",
  "target_slug": "tensorflow_python_ops_script_ops",
  "current_stage": "complete",
  "stage_index": 6,
  "mode": "full-auto",
  "epoch_total": 5,
  "epoch_current": 5,
  "last_failure_signature": "",
  "last_error_signature": "",
  "last_block_errors": {},
  "auto_stop_reason": "",
  "artifacts": {
    "function_doc.md": "# tensorflow.python.ops.script_ops - 函数说明\n\n## 1. 基本信息\n- **FQN**: tensorflow.python.ops.script_ops\n- **模块文件**: `/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/ops/script_ops.py`\n- **签名**: 模块（包含多个函数和类）\n- **对象类型**: module\n\n## 2. 功能概述\nTensorFlow脚本语言操作模块，提供Python函数与TensorFlow图的集成能力。核心功能包括：\n- 将Python函数包装为TensorFlow操作\n- 支持eager执行和graph模式\n- 处理NumPy数组与Tensor之间的转换\n\n## 3. 参数说明\n模块包含多个主要函数：\n\n**eager_py_func (tf.py_function)**\n- func (callable): Python函数，接受Tensor输入，返回Tensor输出\n- inp (list): 输入参数列表，包含Tensor或CompositeTensor\n- Tout (list/tf.DType/tf.TypeSpec): 返回值的类型描述\n- name (str/None): 操作名称（可选）\n\n**py_func_common / py_func (tf.compat.v1.py_func)**\n- func (callable): Python函数，接受NumPy数组输入，返回NumPy数组\n- inp (list): 输入Tensor列表\n- Tout (list/tf.DType): 返回值的TensorFlow数据类型\n- stateful (bool): 是否是有状态操作（默认True）\n- name (str/None): 操作名称（可选）\n\n**numpy_function (tf.numpy_function)**\n- 参数与py_func_common相同\n\n## 4. 返回值\n- 返回Tensor、CompositeTensor或它们的列表\n- 根据Tout参数确定返回类型\n- 如果func返回None，则返回空列表\n\n## 5. 文档要点\n- eager_py_func支持TensorFlow操作在函数体内执行\n- py_func_common仅支持NumPy数组操作\n- 函数体不会被序列化到GraphDef中\n- 必须在与调用程序相同的地址空间中运行\n- 不支持XLA编译（jit_comiple=True时会报错）\n\n## 6. 源码摘要\n- 核心函数：_internal_py_func处理所有py函数变体\n- 注册机制：FuncRegistry管理Python函数注册\n- 设备处理：_maybe_copy_to_context_device处理设备间复制\n- 梯度支持：EagerFunc类支持自动微分\n- 复合张量：_wrap_for_composites处理CompositeTensor输入输出\n\n## 7. 示例与用法\n**eager_py_func示例**：\n```python\ndef log_huber(x, m):\n    if tf.abs(x) <= m:\n        return x**2\n    else:\n        return m**2 * (1 - 2 * tf.math.log(m) + tf.math.log(x**2))\n\ny = tf.py_function(func=log_huber, inp=[x, m], Tout=tf.float32)\n```\n\n**py_func示例**：\n```python\ndef my_func(x):\n    return np.sinh(x)\ny = tf.compat.v1.py_func(my_func, [input], tf.float32)\n```\n\n## 8. 风险与空白\n- 模块包含多个实体：eager_py_func、py_func、numpy_function、EagerFunc类、FuncRegistry类\n- 需要为每个主要函数单独设计测试用例\n- 缺少详细的错误处理文档（如输入类型不匹配的具体错误信息）\n- 性能限制：调用会获取Python全局解释器锁（GIL）\n- 序列化限制：函数体不会保存到SavedModel中\n- 分布式环境限制：必须在同一进程中运行\n- 缺少对异步执行的具体约束说明",
    "requirements.md": "# tensorflow.python.ops.script_ops 测试需求\n\n## 1. 目标与范围\n- 主要功能与期望行为\n  - 验证Python函数包装为TensorFlow操作的正确性\n  - 测试eager执行和graph模式下函数调用一致性\n  - 验证NumPy数组与Tensor之间的转换逻辑\n  - 确保函数注册和调用机制正常工作\n- 不在范围内的内容\n  - XLA编译支持（明确不支持）\n  - SavedModel序列化（函数体不保存）\n  - 分布式跨进程执行（必须在同一进程）\n  - 性能基准测试（GIL限制已知）\n\n## 2. 输入与约束\n- 参数列表（名称、类型/shape、默认值）\n  - func: callable，必需，接受Tensor/NumPy数组，返回Tensor/NumPy数组\n  - inp: list[Tensor/CompositeTensor]，必需，长度匹配func参数\n  - Tout: list/tf.DType/tf.TypeSpec，必需，指定返回类型\n  - stateful: bool，默认True，仅py_func_common\n  - name: str/None，可选，操作名称\n- 有效取值范围/维度/设备要求\n  - func必须与调用程序在同一地址空间\n  - inp元素必须是Tensor或CompositeTensor\n  - Tout必须与func返回值类型匹配\n  - 不支持jit_compile=True\n- 必需与可选组合\n  - func、inp、Tout为必需参数\n  - name为可选参数\n  - stateful仅适用于py_func_common变体\n- 随机性/全局状态要求\n  - stateful=True时函数可能有副作用\n  - 函数调用会获取Python GIL\n  - 不支持异步执行\n\n## 3. 输出与判定\n- 期望返回结构及关键字段\n  - 返回Tensor、CompositeTensor或列表\n  - 返回类型由Tout参数确定\n  - func返回None时返回空列表\n  - 返回值形状与func输出一致\n- 容差/误差界（如浮点）\n  - NumPy数组转换使用默认精度\n  - 浮点运算遵循TensorFlow标准容差\n  - 类型转换遵循TensorFlow类型提升规则\n- 状态变化或副作用检查点\n  - 验证FuncRegistry注册正确性\n  - 检查设备间复制逻辑（_maybe_copy_to_context_device）\n  - 验证CompositeTensor包装处理（_wrap_for_composites）\n\n## 4. 错误与异常场景\n- 非法输入/维度/类型触发的异常或警告\n  - func不是callable时抛出TypeError\n  - inp不是list时抛出TypeError\n  - Tout与func返回值类型不匹配时抛出异常\n  - 尝试使用jit_compile=True时抛出错误\n- 边界值（空、None、0长度、极端形状/数值）\n  - inp为空列表（func无参数）\n  - func返回None（应返回空列表）\n  - 输入Tensor形状为0或极端维度\n  - CompositeTensor边界情况\n  - 嵌套结构输入输出\n\n## 5. 依赖与环境\n- 外部资源/设备/网络/文件依赖\n  - Python解释器环境（同一进程）\n  - TensorFlow运行时\n  - NumPy库（py_func变体）\n  - 设备上下文（CPU/GPU）\n- 需要mock/monkeypatch的部分\n  - `tensorflow.python.framework.func_graph.FuncGraph`（graph模式）\n  - `tensorflow.python.eager.context.context`（eager执行）\n  - `tensorflow.python.framework.ops.get_default_graph`\n  - `tensorflow.python.ops.script_ops._internal_py_func`（核心实现）\n  - `tensorflow.python.ops.script_ops.FuncRegistry`（函数注册）\n  - `tensorflow.python.ops.script_ops._maybe_copy_to_context_device`\n  - `tensorflow.python.ops.script_ops._wrap_for_composites`\n\n## 6. 覆盖与优先级\n- 必测路径（高优先级，最多5条，短句）\n  1. eager_py_func基础调用：Tensor输入输出\n  2. py_func_common：NumPy数组转换\n  3. numpy_function别名功能验证\n  4. 复合张量（CompositeTensor）支持\n  5. 错误处理：类型不匹配、无效输入\n- 可选路径（中/低优先级合并为一组列表）\n  - 多返回值场景（Tout为列表）\n  - stateful参数影响（True/False）\n  - 嵌套函数调用\n  - 设备间数据复制\n  - 梯度计算支持（EagerFunc）\n  - 函数注册表管理（FuncRegistry）\n  - 名称参数使用\n  - 空输入/输出边界\n- 已知风险/缺失信息（仅列条目，不展开）\n  - GIL获取对并发性能影响\n  - 函数体不序列化到GraphDef\n  - 不支持跨进程分布式\n  - 缺少详细错误消息文档\n  - 异步执行限制未明确",
    "test_plan.json": "{\n  \"plan_version\": 2,\n  \"target\": \"tensorflow.python.ops.script_ops\",\n  \"block_rules\": {\n    \"header_block\": \"HEADER\",\n    \"footer_block\": \"FOOTER\",\n    \"case_prefix\": \"CASE_\",\n    \"case_format\": \"CASE_01\"\n  },\n  \"iteration_strategy\": {\n    \"round1\": {\n      \"include\": \"SMOKE_SET\",\n      \"assert_level\": \"weak\",\n      \"max_blocks\": 5\n    },\n    \"roundN\": {\n      \"only_fix_failed_blocks\": true,\n      \"block_limit\": 3,\n      \"promote_deferred\": true\n    },\n    \"final\": {\n      \"enable_strong_asserts\": true,\n      \"coverage_optional\": true\n    }\n  },\n  \"test_files\": {\n    \"default\": \"tests/test_tensorflow_python_ops_script_ops.py\",\n    \"all_pattern\": \"tests/test_tensorflow_python_ops_script_ops.py\"\n  },\n  \"cases\": [\n    {\n      \"tc_id\": \"TC-01\",\n      \"block_id\": \"CASE_01\",\n      \"name\": \"eager_py_func基础调用\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"func_type\": \"simple_math\",\n          \"input_type\": \"tensor\",\n          \"dtype\": \"float32\",\n          \"shape\": [2, 3],\n          \"mode\": \"eager\",\n          \"stateful\": true\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"shape_match\", \"dtype_match\", \"value_finite\", \"basic_operation\"],\n        \"strong\": [\"approx_equal_ref\", \"gradient_correct\", \"device_consistency\"]\n      },\n      \"oracle\": \"numpy_equivalent\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"S\",\n      \"max_lines\": 80,\n      \"max_params\": 6,\n      \"is_parametrized\": true,\n      \"requires_mock\": false,\n      \"mock_targets\": []\n    },\n    {\n      \"tc_id\": \"TC-02\",\n      \"block_id\": \"CASE_02\",\n      \"name\": \"py_func_common NumPy转换\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"func_type\": \"numpy_operation\",\n          \"input_type\": \"numpy_array\",\n          \"dtype\": \"float64\",\n          \"shape\": [3, 2],\n          \"mode\": \"graph\",\n          \"stateful\": true\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"shape_match\", \"dtype_match\", \"numpy_compatible\", \"array_equality\"],\n        \"strong\": [\"precision_validation\", \"memory_layout\", \"type_promotion\"]\n      },\n      \"oracle\": \"direct_numpy_call\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"S\",\n      \"max_lines\": 75,\n      \"max_params\": 5,\n      \"is_parametrized\": true,\n      \"requires_mock\": true,\n      \"mock_targets\": [\n        \"tensorflow.python.framework.func_graph.FuncGraph\",\n        \"tensorflow.python.framework.ops.get_default_graph\"\n      ]\n    },\n    {\n      \"tc_id\": \"TC-03\",\n      \"block_id\": \"CASE_03\",\n      \"name\": \"numpy_function别名验证\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"func_type\": \"string_operation\",\n          \"input_type\": \"string_tensor\",\n          \"dtype\": \"string\",\n          \"shape\": [4],\n          \"mode\": \"eager\",\n          \"stateful\": false\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"function_identity\", \"api_consistency\", \"return_type\", \"error_handling\"],\n        \"strong\": [\"behavior_equivalence\", \"edge_cases\", \"performance_characteristics\"]\n      },\n      \"oracle\": \"py_func_common\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"S\",\n      \"max_lines\": 70,\n      \"max_params\": 4,\n      \"is_parametrized\": false,\n      \"requires_mock\": false,\n      \"mock_targets\": []\n    },\n    {\n      \"tc_id\": \"TC-04\",\n      \"block_id\": \"CASE_04\",\n      \"name\": \"复合张量支持\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"func_type\": \"composite_handler\",\n          \"input_type\": \"ragged_tensor\",\n          \"dtype\": \"int32\",\n          \"shape\": \"ragged\",\n          \"mode\": \"eager\",\n          \"stateful\": true\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"structure_preserved\", \"type_wrapping\", \"basic_access\", \"shape_inference\"],\n        \"strong\": [\"nested_operations\", \"gradient_support\", \"serialization_check\"]\n      },\n      \"oracle\": \"manual_composite\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"M\",\n      \"max_lines\": 90,\n      \"max_params\": 7,\n      \"is_parametrized\": true,\n      \"requires_mock\": true,\n      \"mock_targets\": [\n        \"tensorflow.python.ops.script_ops._wrap_for_composites\",\n        \"tensorflow.python.ops.script_ops._maybe_copy_to_context_device\"\n      ]\n    },\n    {\n      \"tc_id\": \"TC-05\",\n      \"block_id\": \"CASE_05\",\n      \"name\": \"错误处理与类型检查\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"error_type\": \"invalid_func\",\n          \"input_type\": \"tensor\",\n          \"dtype\": \"float32\",\n          \"shape\": [2, 2],\n          \"mode\": \"eager\",\n          \"expected_error\": \"TypeError\"\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"exception_raised\", \"error_type\", \"message_contains\", \"no_side_effects\"],\n        \"strong\": [\"error_context\", \"recovery_behavior\", \"resource_cleanup\"]\n      },\n      \"oracle\": \"python_exception\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"S\",\n      \"max_lines\": 65,\n      \"max_params\": 5,\n      \"is_parametrized\": true,\n      \"requires_mock\": false,\n      \"mock_targets\": []\n    }\n  ],\n  \"param_extensions\": [\n    {\n      \"base_block_id\": \"CASE_01\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"func_type\": \"simple_math\",\n        \"input_type\": \"tensor\",\n        \"dtype\": \"float64\",\n        \"shape\": [5, 5],\n        \"mode\": \"graph\",\n        \"stateful\": true\n      },\n      \"note\": \"作为参数扩展：不同精度和模式\"\n    },\n    {\n      \"base_block_id\": \"CASE_01\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"func_type\": \"simple_math\",\n        \"input_type\": \"tensor\",\n        \"dtype\": \"int32\",\n        \"shape\": [1, 10],\n        \"mode\": \"eager\",\n        \"stateful\": true\n      },\n      \"note\": \"作为参数扩展：整数类型和不同形状\"\n    },\n    {\n      \"base_block_id\": \"CASE_02\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"func_type\": \"numpy_operation\",\n        \"input_type\": \"numpy_array\",\n        \"dtype\": \"float32\",\n        \"shape\": [10, 1],\n        \"mode\": \"graph\",\n        \"stateful\": false\n      },\n      \"note\": \"作为参数扩展：stateful参数测试\"\n    },\n    {\n      \"base_block_id\": \"CASE_04\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"func_type\": \"composite_handler\",\n        \"input_type\": \"sparse_tensor\",\n        \"dtype\": \"float32\",\n        \"shape\": \"sparse\",\n        \"mode\": \"graph\",\n        \"stateful\": true\n      },\n      \"note\": \"作为参数扩展：不同类型复合张量\"\n    },\n    {\n      \"base_block_id\": \"CASE_05\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"error_type\": \"type_mismatch\",\n        \"input_type\": \"tensor\",\n        \"dtype\": \"float32\",\n        \"shape\": [3, 3],\n        \"mode\": \"eager\",\n        \"expected_error\": \"ValueError\"\n      },\n      \"note\": \"作为参数扩展：不同类型错误\"\n    }\n  ],\n  \"smoke_set\": [\"CASE_01\", \"CASE_02\", \"CASE_03\"],\n  \"deferred_set\": [\"CASE_04\", \"CASE_05\"]\n}",
    "test_plan.md": "# tensorflow.python.ops.script_ops 测试计划\n\n## 1. 测试策略\n- 单元测试框架：pytest\n- 隔离策略：mock/monkeypatch/fixtures（针对graph模式、函数注册、设备复制）\n- 随机性处理：固定随机种子，控制NumPy/TensorFlow RNG\n- 执行模式：eager和graph模式双覆盖\n- 设备隔离：CPU环境为主，避免GPU依赖\n\n## 2. 生成规格摘要（来自 test_plan.json）\n- **SMOKE_SET**: CASE_01 (eager_py_func基础调用), CASE_02 (py_func_common NumPy转换), CASE_03 (numpy_function别名验证)\n- **DEFERRED_SET**: CASE_04 (复合张量支持), CASE_05 (错误处理与类型检查)\n- **测试文件路径**: tests/test_tensorflow_python_ops_script_ops.py（单文件）\n- **断言分级策略**: 首轮使用weak断言（形状、类型、基础操作验证），后续启用strong断言（精度、梯度、设备一致性）\n- **预算策略**: \n  - Size S: 65-80行，4-6参数\n  - Size M: 90行，7参数（仅CASE_04）\n  - 参数化：除CASE_03外均为参数化测试\n\n## 3. 数据与边界\n- **正常数据集**: 随机生成浮点/整数张量，形状[2-5, 2-5]，使用固定种子\n- **边界值**: \n  - 空输入列表（func无参数）\n  - 零维标量张量\n  - 极端形状[1, 1000]或[1000, 1]\n  - 空字符串张量\n- **复合张量边界**:\n  - RaggedTensor不规则形状\n  - SparseTensor稀疏表示\n  - 嵌套结构输入\n- **负例与异常场景**:\n  - 无效func（非callable）\n  - 类型不匹配（Tout错误）\n  - 输入非列表\n  - stateful参数误用\n  - 设备上下文错误\n\n## 4. 覆盖映射\n| TC ID | 需求覆盖 | 约束覆盖 | Mock目标 |\n|-------|----------|----------|----------|\n| TC-01 | eager_py_func基础调用 | Tensor输入输出，eager模式 | 无 |\n| TC-02 | py_func_common NumPy转换 | graph模式，NumPy数组转换 | FuncGraph, get_default_graph |\n| TC-03 | numpy_function别名验证 | API一致性，字符串处理 | 无 |\n| TC-04 | 复合张量支持 | CompositeTensor包装，设备复制 | _wrap_for_composites, _maybe_copy_to_context_device |\n| TC-05 | 错误处理 | 类型检查，异常抛出 | 无 |\n\n**尚未覆盖的风险点**:\n- GIL获取对并发性能影响（性能测试范围外）\n- 函数体不序列化到GraphDef（序列化测试范围外）\n- 不支持跨进程分布式（分布式测试范围外）\n- 异步执行限制（异步测试范围外）\n\n## 5. 迭代策略\n- **首轮**: 仅生成SMOKE_SET（3个用例），使用weak断言\n- **后续轮次**: 修复失败用例，从DEFERRED_SET提升用例（每次最多3个）\n- **最终轮**: 启用strong断言，可选覆盖率检查\n\n## 6. 验证参考\n- NumPy等效操作作为oracle（TC-01, TC-02）\n- 直接NumPy调用对比（TC-02）\n- py_func_common行为一致性（TC-03）\n- 手动复合张量处理（TC-04）\n- Python标准异常（TC-05）",
    "tests/test_tensorflow_python_ops_script_ops.py": "\"\"\"\nTest cases for tensorflow.python.ops.script_ops module.\nGenerated by TestAgent-CLI.\n\"\"\"\n\nimport numpy as np\nimport pytest\nimport tensorflow as tf\nfrom tensorflow.python.ops import script_ops\n\n# Set random seeds for reproducibility\nnp.random.seed(42)\ntf.random.set_seed(42)\n\n# ==== BLOCK:HEADER START ====\n# Header block - imports and fixtures\n# ==== BLOCK:HEADER END ====\n\n# ==== BLOCK:CASE_01 START ====\n# CASE_01: eager_py_func基础调用\n# ==== BLOCK:CASE_01 END ====\n\n# ==== BLOCK:CASE_02 START ====\n# CASE_02: py_func_common NumPy转换\n# ==== BLOCK:CASE_02 END ====\n\n# ==== BLOCK:CASE_03 START ====\n# CASE_03: numpy_function别名验证\n# ==== BLOCK:CASE_03 END ====\n\n# ==== BLOCK:CASE_04 START ====\n# CASE_04: 复合张量支持 (DEFERRED - placeholder)\n# ==== BLOCK:CASE_04 END ====\n\n# ==== BLOCK:CASE_05 START ====\n# CASE_05: 错误处理与类型检查 (DEFERRED - placeholder)\n# ==== BLOCK:CASE_05 END ====\n\n# ==== BLOCK:FOOTER START ====\n# Footer block - cleanup and additional helpers\n# ==== BLOCK:FOOTER END ====",
    "execution_log.txt": "=== Run Tests ===\n..............FFFFF....                                                  [100%]\n=================================== FAILURES ===================================\n_ TestCompositeTensorSupport.test_composite_tensor_support[ragged_tensor-dtype0-ragged-eager] _\n\nself = <test_tensorflow_python_ops_script_ops.TestCompositeTensorSupport object at 0x16f9fb3d0>\ninput_type = 'ragged_tensor', dtype = tf.int32, shape = 'ragged', mode = 'eager'\n\n    @pytest.mark.parametrize(\"input_type,dtype,shape,mode\", [\n        (\"ragged_tensor\", tf.int32, \"ragged\", \"eager\"),\n        (\"sparse_tensor\", tf.float32, \"sparse\", \"graph\"),\n    ])\n    def test_composite_tensor_support(self, input_type, dtype, shape, mode):\n        \"\"\"Test composite tensor support with RaggedTensor and SparseTensor.\"\"\"\n        # Mock the internal functions that handle composite tensors\n        with mock.patch.object(script_ops, '_wrap_for_composites') as mock_wrap, \\\n             mock.patch.object(script_ops, '_maybe_copy_to_context_device') as mock_copy:\n    \n            # Setup mock return values\n            mock_wrap.return_value = (lambda *args: args, [], [], None)\n            mock_copy.return_value = lambda x, device: x\n    \n            # Create test composite tensor based on input_type\n            if input_type == \"ragged_tensor\":\n                # Create a ragged tensor: [[1, 2], [3], [4, 5, 6]]\n                values = tf.constant([1, 2, 3, 4, 5, 6], dtype=dtype)\n                row_splits = tf.constant([0, 2, 3, 6], dtype=tf.int64)\n                input_tensor = tf.RaggedTensor.from_row_splits(values, row_splits)\n    \n                # Define function that works with ragged tensors\n                def composite_func(rt):\n                    # Simple operation: add 1 to all values\n                    return rt + 1\n    \n                # Expected output structure\n                expected_structure = tf.RaggedTensorSpec(\n                    shape=[None, None],\n                    dtype=dtype,\n                    ragged_rank=1\n                )\n    \n            elif input_type == \"sparse_tensor\":\n                # Create a sparse tensor: [[0, 0, 3], [0, 2, 0], [0, 0, 0]]\n                indices = tf.constant([[0, 0], [0, 2], [1, 1]], dtype=tf.int64)\n                values = tf.constant([3.0, 2.0, 1.0], dtype=dtype)\n                dense_shape = tf.constant([2, 3], dtype=tf.int64)\n                input_tensor = tf.SparseTensor(indices, values, dense_shape)\n    \n                # Define function that works with sparse tensors\n                def composite_func(st):\n                    # Simple operation: multiply by 2\n                    return tf.SparseTensor(\n                        indices=st.indices,\n                        values=st.values * 2,\n                        dense_shape=st.dense_shape\n                    )\n    \n                # Expected output structure\n                expected_structure = tf.SparseTensorSpec(\n                    shape=[2, 3],\n                    dtype=dtype\n                )\n    \n            else:\n                pytest.skip(f\"Unsupported input_type: {input_type}\")\n    \n            # Test in eager mode\n            if mode == \"eager\":\n                # Call the function with mocked internal functions\n>               result = script_ops.eager_py_func(\n                    func=composite_func,\n                    inp=[input_tensor],\n                    Tout=expected_structure\n                )\n\ntests/test_tensorflow_python_ops_script_ops.py:513: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/util/traceback_utils.py:153: in error_handler\n    raise e.with_traceback(filtered_tb) from None\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nfunc = <tensorflow.python.ops.script_ops.EagerFunc object at 0x1784b4e20>\ninp = [], Tout = [], stateful = None, use_eager_py_func = True\nis_grad_func = False, name = None\n\n    def _internal_py_func(func,\n                          inp,\n                          Tout,\n                          stateful=None,\n                          use_eager_py_func=False,\n                          is_grad_func=False,\n                          name=None):\n      \"\"\"See documentation for py_func and eager_py_func.\"\"\"\n      if not callable(func):\n        raise ValueError(\n            f\"Expected func to be callable. Received func={func} of type \"\n            f\"{type(func)}.\")\n    \n      original_func = func\n      func = autograph.do_not_convert(func)\n      inp = list(inp)\n    \n      # Normalize Tout.\n      is_list_or_tuple = isinstance(Tout, (list, tuple))\n      Tout = Tout if is_list_or_tuple else [Tout]\n      Tout = [_as_dtype_or_type_spec(t) for t in Tout]\n    \n      # Check if we need to handle CompositeTensor inputs or outputs.\n      handle_composite_tensors = (\n          use_eager_py_func and\n          (any(isinstance(v, composite_tensor.CompositeTensor) for v in inp) or\n           any(isinstance(t, type_spec.TypeSpec) for t in Tout)))\n      if handle_composite_tensors:\n        func, inp, Tout, out_structure = _wrap_for_composites(func, inp, Tout)\n    \n      if use_eager_py_func:\n        func = EagerFunc(func, Tout, is_grad_func)\n    \n      # Tying the registered function's lifetime with the current default graph is\n      # not reliable. For example, Estimator-based binaries may switch graphs in\n      # between model training end evaluation, via saved_model. Those binaries work\n      # because the original function is global, and break once the registered\n      # function is an anonymous lambda, like the one produced by do_not_convert.\n      # To avoid breaking those cases, we attach the wrapper to the original\n      # function so that their lifetime is connected.\n      # TODO(b/144286616): Remove this.\n      if tf_inspect.isfunction(original_func):\n        # Note: this check is needed because original_func may be a descriptor\n        # (https://docs.python.org/3/howto/descriptor.html)\n        # and we can't attach attributes to those.\n        original_func.ag_dnc_wrapper__ = func\n    \n      token = _py_funcs.insert(func)\n      # We tie the registered function's lifetime with the current default graph,\n      # i.e., when the current graph is destroyed, we remove its py funcs.\n      graph = ops.get_default_graph()\n    \n      while True:\n        current_graph = graph\n        if isinstance(graph, function._FuncGraph):  # pylint: disable=protected-access\n          graph = graph._outer_graph  # pylint: disable=protected-access\n        elif isinstance(graph, func_graph.FuncGraph):\n          graph = graph.outer_graph\n        if graph is current_graph:\n          break\n    \n      # TODO(zhifengc): Consider adding a Graph method to collect\n      # `cleanup` objects in one of its member.\n      if not hasattr(graph, \"_py_funcs_used_in_graph\"):\n        graph._py_funcs_used_in_graph = []  # pylint: disable=protected-access\n    \n      # Store a reference to the function in the graph to ensure it stays alive\n      # as long as the graph lives. When the graph is destroyed, the function\n      # is left to the garbage collector for destruction as well.\n      graph._py_funcs_used_in_graph.append(func)  # pylint: disable=protected-access\n    \n      if use_eager_py_func:\n        result = gen_script_ops.eager_py_func(\n            input=inp,\n            token=token,\n            is_async=context.is_async(),\n            Tout=Tout,\n            name=name)\n      else:\n        if stateful:\n          result = gen_script_ops.py_func(\n              input=inp, token=token, Tout=Tout, name=name)\n        else:\n          result = gen_script_ops.py_func_stateless(\n              input=inp, token=token, Tout=Tout, name=name)\n    \n      if handle_composite_tensors and Tout:\n        result = nest.pack_sequence_as(\n            out_structure, result, expand_composites=True)\n    \n>     return result if is_list_or_tuple else result[0]\nE     IndexError: list index out of range\n\n/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/ops/script_ops.py:390: IndexError\n_ TestCompositeTensorSupport.test_composite_tensor_support[sparse_tensor-dtype1-sparse-graph] _\n\nself = <test_tensorflow_python_ops_script_ops.TestCompositeTensorSupport object at 0x16f9fb5b0>\ninput_type = 'sparse_tensor', dtype = tf.float32, shape = 'sparse'\nmode = 'graph'\n\n    @pytest.mark.parametrize(\"input_type,dtype,shape,mode\", [\n        (\"ragged_tensor\", tf.int32, \"ragged\", \"eager\"),\n        (\"sparse_tensor\", tf.float32, \"sparse\", \"graph\"),\n    ])\n    def test_composite_tensor_support(self, input_type, dtype, shape, mode):\n        \"\"\"Test composite tensor support with RaggedTensor and SparseTensor.\"\"\"\n        # Mock the internal functions that handle composite tensors\n        with mock.patch.object(script_ops, '_wrap_for_composites') as mock_wrap, \\\n             mock.patch.object(script_ops, '_maybe_copy_to_context_device') as mock_copy:\n    \n            # Setup mock return values\n            mock_wrap.return_value = (lambda *args: args, [], [], None)\n            mock_copy.return_value = lambda x, device: x\n    \n            # Create test composite tensor based on input_type\n            if input_type == \"ragged_tensor\":\n                # Create a ragged tensor: [[1, 2], [3], [4, 5, 6]]\n                values = tf.constant([1, 2, 3, 4, 5, 6], dtype=dtype)\n                row_splits = tf.constant([0, 2, 3, 6], dtype=tf.int64)\n                input_tensor = tf.RaggedTensor.from_row_splits(values, row_splits)\n    \n                # Define function that works with ragged tensors\n                def composite_func(rt):\n                    # Simple operation: add 1 to all values\n                    return rt + 1\n    \n                # Expected output structure\n                expected_structure = tf.RaggedTensorSpec(\n                    shape=[None, None],\n                    dtype=dtype,\n                    ragged_rank=1\n                )\n    \n            elif input_type == \"sparse_tensor\":\n                # Create a sparse tensor: [[0, 0, 3], [0, 2, 0], [0, 0, 0]]\n                indices = tf.constant([[0, 0], [0, 2], [1, 1]], dtype=tf.int64)\n                values = tf.constant([3.0, 2.0, 1.0], dtype=dtype)\n                dense_shape = tf.constant([2, 3], dtype=tf.int64)\n                input_tensor = tf.SparseTensor(indices, values, dense_shape)\n    \n                # Define function that works with sparse tensors\n                def composite_func(st):\n                    # Simple operation: multiply by 2\n                    return tf.SparseTensor(\n                        indices=st.indices,\n                        values=st.values * 2,\n                        dense_shape=st.dense_shape\n                    )\n    \n                # Expected output structure\n                expected_structure = tf.SparseTensorSpec(\n                    shape=[2, 3],\n                    dtype=dtype\n                )\n    \n            else:\n                pytest.skip(f\"Unsupported input_type: {input_type}\")\n    \n            # Test in eager mode\n            if mode == \"eager\":\n                # Call the function with mocked internal functions\n                result = script_ops.eager_py_func(\n                    func=composite_func,\n                    inp=[input_tensor],\n                    Tout=expected_structure\n                )\n    \n                # Verify that _wrap_for_composites was called\n                mock_wrap.assert_called_once()\n    \n                # Weak assertions\n                # Check that structure is preserved\n                assert type(result) == type(input_tensor), \\\n                    f\"Structure not preserved: {type(result)} != {type(input_tensor)}\"\n    \n                # Check type wrapping\n                if input_type == \"ragged_tensor\":\n                    assert isinstance(result, tf.RaggedTensor), \\\n                        \"Result should be a RaggedTensor\"\n                    assert result.dtype == dtype, \\\n                        f\"Dtype mismatch: {result.dtype} != {dtype}\"\n                    # Basic access check\n                    assert result.shape[0] == input_tensor.shape[0], \\\n                        f\"Row count mismatch: {result.shape[0]} != {input_tensor.shape[0]}\"\n    \n                elif input_type == \"sparse_tensor\":\n                    assert isinstance(result, tf.SparseTensor), \\\n                        \"Result should be a SparseTensor\"\n                    assert result.dtype == dtype, \\\n                        f\"Dtype mismatch: {result.dtype} != {dtype}\"\n                    # Basic access check\n                    assert result.shape == input_tensor.shape, \\\n                        f\"Shape mismatch: {result.shape} != {input_tensor.shape}\"\n    \n            # Test in graph mode\n            else:\n                @tf.function\n                def test_graph():\n                    return script_ops.eager_py_func(\n                        func=composite_func,\n                        inp=[input_tensor],\n                        Tout=expected_structure\n                    )\n    \n>               result = test_graph()\n\ntests/test_tensorflow_python_ops_script_ops.py:556: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/util/traceback_utils.py:153: in error_handler\n    raise e.with_traceback(filtered_tb) from None\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n    def tf__test_graph():\n        with ag__.FunctionScope('test_graph', 'fscope', ag__.ConversionOptions(recursive=True, user_requested=True, optional_features=(), internal_convert_user_code=True)) as fscope:\n            do_return = False\n            retval_ = ag__.UndefinedReturnValue()\n            try:\n                do_return = True\n>               retval_ = ag__.converted_call(ag__.ld(script_ops).eager_py_func, (), dict(func=ag__.ld(composite_func), inp=[ag__.ld(input_tensor)], Tout=ag__.ld(expected_structure)), fscope)\nE               TypeError: in user code:\nE               \nE                   File \"/Users/zzf1sh/Documents/Project/TestAgent-CLI-main/exam/tensorflow/python.ops.script_ops/tests/test_tensorflow_python_ops_script_ops.py\", line 553, in test_graph  *\nE                       Tout=expected_structure\nE               \nE                   TypeError: 'Operation' object is not subscriptable\n\n/var/folders/fc/ny_p_wjs10xfzq7xns_lfdc40000gn/T/__autograph_generated_filen46tlfkb.py:15: TypeError\n________ TestCompositeTensorSupport.test_ragged_tensor_shape_inference _________\n\nself = <test_tensorflow_python_ops_script_ops.TestCompositeTensorSupport object at 0x16f9fb910>\n\n    def test_ragged_tensor_shape_inference(self):\n        \"\"\"Test shape inference with RaggedTensor.\"\"\"\n        # Create a ragged tensor\n        values = tf.constant([1, 2, 3, 4, 5], dtype=tf.int32)\n        row_splits = tf.constant([0, 2, 5], dtype=tf.int64)\n        ragged_tensor = tf.RaggedTensor.from_row_splits(values, row_splits)\n    \n        # Define a simple function\n        def add_one(rt):\n            return rt + 1\n    \n        # Mock internal functions\n        with mock.patch.object(script_ops, '_wrap_for_composites') as mock_wrap:\n            mock_wrap.return_value = (lambda *args: args, [], [], None)\n    \n            # Call eager_py_func\n>           result = script_ops.eager_py_func(\n                func=add_one,\n                inp=[ragged_tensor],\n                Tout=tf.RaggedTensorSpec(shape=[None, None], dtype=tf.int32, ragged_rank=1)\n            )\n\ntests/test_tensorflow_python_ops_script_ops.py:595: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/util/traceback_utils.py:153: in error_handler\n    raise e.with_traceback(filtered_tb) from None\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nfunc = <tensorflow.python.ops.script_ops.EagerFunc object at 0x1784b7370>\ninp = [], Tout = [], stateful = None, use_eager_py_func = True\nis_grad_func = False, name = None\n\n    def _internal_py_func(func,\n                          inp,\n                          Tout,\n                          stateful=None,\n                          use_eager_py_func=False,\n                          is_grad_func=False,\n                          name=None):\n      \"\"\"See documentation for py_func and eager_py_func.\"\"\"\n      if not callable(func):\n        raise ValueError(\n            f\"Expected func to be callable. Received func={func} of type \"\n            f\"{type(func)}.\")\n    \n      original_func = func\n      func = autograph.do_not_convert(func)\n      inp = list(inp)\n    \n      # Normalize Tout.\n      is_list_or_tuple = isinstance(Tout, (list, tuple))\n      Tout = Tout if is_list_or_tuple else [Tout]\n      Tout = [_as_dtype_or_type_spec(t) for t in Tout]\n    \n      # Check if we need to handle CompositeTensor inputs or outputs.\n      handle_composite_tensors = (\n          use_eager_py_func and\n          (any(isinstance(v, composite_tensor.CompositeTensor) for v in inp) or\n           any(isinstance(t, type_spec.TypeSpec) for t in Tout)))\n      if handle_composite_tensors:\n        func, inp, Tout, out_structure = _wrap_for_composites(func, inp, Tout)\n    \n      if use_eager_py_func:\n        func = EagerFunc(func, Tout, is_grad_func)\n    \n      # Tying the registered function's lifetime with the current default graph is\n      # not reliable. For example, Estimator-based binaries may switch graphs in\n      # between model training end evaluation, via saved_model. Those binaries work\n      # because the original function is global, and break once the registered\n      # function is an anonymous lambda, like the one produced by do_not_convert.\n      # To avoid breaking those cases, we attach the wrapper to the original\n      # function so that their lifetime is connected.\n      # TODO(b/144286616): Remove this.\n      if tf_inspect.isfunction(original_func):\n        # Note: this check is needed because original_func may be a descriptor\n        # (https://docs.python.org/3/howto/descriptor.html)\n        # and we can't attach attributes to those.\n        original_func.ag_dnc_wrapper__ = func\n    \n      token = _py_funcs.insert(func)\n      # We tie the registered function's lifetime with the current default graph,\n      # i.e., when the current graph is destroyed, we remove its py funcs.\n      graph = ops.get_default_graph()\n    \n      while True:\n        current_graph = graph\n        if isinstance(graph, function._FuncGraph):  # pylint: disable=protected-access\n          graph = graph._outer_graph  # pylint: disable=protected-access\n        elif isinstance(graph, func_graph.FuncGraph):\n          graph = graph.outer_graph\n        if graph is current_graph:\n          break\n    \n      # TODO(zhifengc): Consider adding a Graph method to collect\n      # `cleanup` objects in one of its member.\n      if not hasattr(graph, \"_py_funcs_used_in_graph\"):\n        graph._py_funcs_used_in_graph = []  # pylint: disable=protected-access\n    \n      # Store a reference to the function in the graph to ensure it stays alive\n      # as long as the graph lives. When the graph is destroyed, the function\n      # is left to the garbage collector for destruction as well.\n      graph._py_funcs_used_in_graph.append(func)  # pylint: disable=protected-access\n    \n      if use_eager_py_func:\n        result = gen_script_ops.eager_py_func(\n            input=inp,\n            token=token,\n            is_async=context.is_async(),\n            Tout=Tout,\n            name=name)\n      else:\n        if stateful:\n          result = gen_script_ops.py_func(\n              input=inp, token=token, Tout=Tout, name=name)\n        else:\n          result = gen_script_ops.py_func_stateless(\n              input=inp, token=token, Tout=Tout, name=name)\n    \n      if handle_composite_tensors and Tout:\n        result = nest.pack_sequence_as(\n            out_structure, result, expand_composites=True)\n    \n>     return result if is_list_or_tuple else result[0]\nE     IndexError: list index out of range\n\n/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/ops/script_ops.py:390: IndexError\n________ TestCompositeTensorSupport.test_sparse_tensor_basic_operation _________\n\nself = <test_tensorflow_python_ops_script_ops.TestCompositeTensorSupport object at 0x16f9fbbe0>\n\n    def test_sparse_tensor_basic_operation(self):\n        \"\"\"Test basic operations with SparseTensor.\"\"\"\n        # Create a sparse tensor\n        indices = tf.constant([[0, 0], [1, 2]], dtype=tf.int64)\n        values = tf.constant([10.0, 20.0], dtype=tf.float32)\n        dense_shape = tf.constant([2, 3], dtype=tf.int64)\n        sparse_tensor = tf.SparseTensor(indices, values, dense_shape)\n    \n        # Define function that doubles sparse values\n        def double_sparse(st):\n            return tf.SparseTensor(\n                indices=st.indices,\n                values=st.values * 2,\n                dense_shape=st.dense_shape\n            )\n    \n        # Mock internal functions\n        with mock.patch.object(script_ops, '_wrap_for_composites') as mock_wrap:\n            mock_wrap.return_value = (lambda *args: args, [], [], None)\n    \n            # Call eager_py_func\n>           result = script_ops.eager_py_func(\n                func=double_sparse,\n                inp=[sparse_tensor],\n                Tout=tf.SparseTensorSpec(shape=[2, 3], dtype=tf.float32)\n            )\n\ntests/test_tensorflow_python_ops_script_ops.py:627: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/util/traceback_utils.py:153: in error_handler\n    raise e.with_traceback(filtered_tb) from None\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nfunc = <tensorflow.python.ops.script_ops.EagerFunc object at 0x17886faf0>\ninp = [], Tout = [], stateful = None, use_eager_py_func = True\nis_grad_func = False, name = None\n\n    def _internal_py_func(func,\n                          inp,\n                          Tout,\n                          stateful=None,\n                          use_eager_py_func=False,\n                          is_grad_func=False,\n                          name=None):\n      \"\"\"See documentation for py_func and eager_py_func.\"\"\"\n      if not callable(func):\n        raise ValueError(\n            f\"Expected func to be callable. Received func={func} of type \"\n            f\"{type(func)}.\")\n    \n      original_func = func\n      func = autograph.do_not_convert(func)\n      inp = list(inp)\n    \n      # Normalize Tout.\n      is_list_or_tuple = isinstance(Tout, (list, tuple))\n      Tout = Tout if is_list_or_tuple else [Tout]\n      Tout = [_as_dtype_or_type_spec(t) for t in Tout]\n    \n      # Check if we need to handle CompositeTensor inputs or outputs.\n      handle_composite_tensors = (\n          use_eager_py_func and\n          (any(isinstance(v, composite_tensor.CompositeTensor) for v in inp) or\n           any(isinstance(t, type_spec.TypeSpec) for t in Tout)))\n      if handle_composite_tensors:\n        func, inp, Tout, out_structure = _wrap_for_composites(func, inp, Tout)\n    \n      if use_eager_py_func:\n        func = EagerFunc(func, Tout, is_grad_func)\n    \n      # Tying the registered function's lifetime with the current default graph is\n      # not reliable. For example, Estimator-based binaries may switch graphs in\n      # between model training end evaluation, via saved_model. Those binaries work\n      # because the original function is global, and break once the registered\n      # function is an anonymous lambda, like the one produced by do_not_convert.\n      # To avoid breaking those cases, we attach the wrapper to the original\n      # function so that their lifetime is connected.\n      # TODO(b/144286616): Remove this.\n      if tf_inspect.isfunction(original_func):\n        # Note: this check is needed because original_func may be a descriptor\n        # (https://docs.python.org/3/howto/descriptor.html)\n        # and we can't attach attributes to those.\n        original_func.ag_dnc_wrapper__ = func\n    \n      token = _py_funcs.insert(func)\n      # We tie the registered function's lifetime with the current default graph,\n      # i.e., when the current graph is destroyed, we remove its py funcs.\n      graph = ops.get_default_graph()\n    \n      while True:\n        current_graph = graph\n        if isinstance(graph, function._FuncGraph):  # pylint: disable=protected-access\n          graph = graph._outer_graph  # pylint: disable=protected-access\n        elif isinstance(graph, func_graph.FuncGraph):\n          graph = graph.outer_graph\n        if graph is current_graph:\n          break\n    \n      # TODO(zhifengc): Consider adding a Graph method to collect\n      # `cleanup` objects in one of its member.\n      if not hasattr(graph, \"_py_funcs_used_in_graph\"):\n        graph._py_funcs_used_in_graph = []  # pylint: disable=protected-access\n    \n      # Store a reference to the function in the graph to ensure it stays alive\n      # as long as the graph lives. When the graph is destroyed, the function\n      # is left to the garbage collector for destruction as well.\n      graph._py_funcs_used_in_graph.append(func)  # pylint: disable=protected-access\n    \n      if use_eager_py_func:\n        result = gen_script_ops.eager_py_func(\n            input=inp,\n            token=token,\n            is_async=context.is_async(),\n            Tout=Tout,\n            name=name)\n      else:\n        if stateful:\n          result = gen_script_ops.py_func(\n              input=inp, token=token, Tout=Tout, name=name)\n        else:\n          result = gen_script_ops.py_func_stateless(\n              input=inp, token=token, Tout=Tout, name=name)\n    \n      if handle_composite_tensors and Tout:\n        result = nest.pack_sequence_as(\n            out_structure, result, expand_composites=True)\n    \n>     return result if is_list_or_tuple else result[0]\nE     IndexError: list index out of range\n\n/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/ops/script_ops.py:390: IndexError\n______ TestCompositeTensorSupport.test_composite_tensor_nested_operations ______\n\nself = <test_tensorflow_python_ops_script_ops.TestCompositeTensorSupport object at 0x16f9fbeb0>\n\n    def test_composite_tensor_nested_operations(self):\n        \"\"\"Test nested operations with composite tensors.\"\"\"\n        # Create a ragged tensor\n        values = tf.constant([[1, 2], [3, 4], [5, 6]], dtype=tf.float32)\n        row_splits = tf.constant([0, 2, 3], dtype=tf.int64)\n        ragged_tensor = tf.RaggedTensor.from_row_splits(values, row_splits)\n    \n        # Define a more complex function\n        def complex_operation(rt):\n            # Apply multiple operations\n            rt_squared = rt * rt\n            rt_shifted = rt_squared + 10\n            return rt_shifted\n    \n        # Mock internal functions\n        with mock.patch.object(script_ops, '_wrap_for_composites') as mock_wrap:\n            mock_wrap.return_value = (lambda *args: args, [], [], None)\n    \n            # Call eager_py_func\n>           result = script_ops.eager_py_func(\n                func=complex_operation,\n                inp=[ragged_tensor],\n                Tout=tf.RaggedTensorSpec(shape=[None, None, 2], dtype=tf.float32, ragged_rank=1)\n            )\n\ntests/test_tensorflow_python_ops_script_ops.py:662: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/util/traceback_utils.py:153: in error_handler\n    raise e.with_traceback(filtered_tb) from None\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nfunc = <tensorflow.python.ops.script_ops.EagerFunc object at 0x104be2350>\ninp = [], Tout = [], stateful = None, use_eager_py_func = True\nis_grad_func = False, name = None\n\n    def _internal_py_func(func,\n                          inp,\n                          Tout,\n                          stateful=None,\n                          use_eager_py_func=False,\n                          is_grad_func=False,\n                          name=None):\n      \"\"\"See documentation for py_func and eager_py_func.\"\"\"\n      if not callable(func):\n        raise ValueError(\n            f\"Expected func to be callable. Received func={func} of type \"\n            f\"{type(func)}.\")\n    \n      original_func = func\n      func = autograph.do_not_convert(func)\n      inp = list(inp)\n    \n      # Normalize Tout.\n      is_list_or_tuple = isinstance(Tout, (list, tuple))\n      Tout = Tout if is_list_or_tuple else [Tout]\n      Tout = [_as_dtype_or_type_spec(t) for t in Tout]\n    \n      # Check if we need to handle CompositeTensor inputs or outputs.\n      handle_composite_tensors = (\n          use_eager_py_func and\n          (any(isinstance(v, composite_tensor.CompositeTensor) for v in inp) or\n           any(isinstance(t, type_spec.TypeSpec) for t in Tout)))\n      if handle_composite_tensors:\n        func, inp, Tout, out_structure = _wrap_for_composites(func, inp, Tout)\n    \n      if use_eager_py_func:\n        func = EagerFunc(func, Tout, is_grad_func)\n    \n      # Tying the registered function's lifetime with the current default graph is\n      # not reliable. For example, Estimator-based binaries may switch graphs in\n      # between model training end evaluation, via saved_model. Those binaries work\n      # because the original function is global, and break once the registered\n      # function is an anonymous lambda, like the one produced by do_not_convert.\n      # To avoid breaking those cases, we attach the wrapper to the original\n      # function so that their lifetime is connected.\n      # TODO(b/144286616): Remove this.\n      if tf_inspect.isfunction(original_func):\n        # Note: this check is needed because original_func may be a descriptor\n        # (https://docs.python.org/3/howto/descriptor.html)\n        # and we can't attach attributes to those.\n        original_func.ag_dnc_wrapper__ = func\n    \n      token = _py_funcs.insert(func)\n      # We tie the registered function's lifetime with the current default graph,\n      # i.e., when the current graph is destroyed, we remove its py funcs.\n      graph = ops.get_default_graph()\n    \n      while True:\n        current_graph = graph\n        if isinstance(graph, function._FuncGraph):  # pylint: disable=protected-access\n          graph = graph._outer_graph  # pylint: disable=protected-access\n        elif isinstance(graph, func_graph.FuncGraph):\n          graph = graph.outer_graph\n        if graph is current_graph:\n          break\n    \n      # TODO(zhifengc): Consider adding a Graph method to collect\n      # `cleanup` objects in one of its member.\n      if not hasattr(graph, \"_py_funcs_used_in_graph\"):\n        graph._py_funcs_used_in_graph = []  # pylint: disable=protected-access\n    \n      # Store a reference to the function in the graph to ensure it stays alive\n      # as long as the graph lives. When the graph is destroyed, the function\n      # is left to the garbage collector for destruction as well.\n      graph._py_funcs_used_in_graph.append(func)  # pylint: disable=protected-access\n    \n      if use_eager_py_func:\n        result = gen_script_ops.eager_py_func(\n            input=inp,\n            token=token,\n            is_async=context.is_async(),\n            Tout=Tout,\n            name=name)\n      else:\n        if stateful:\n          result = gen_script_ops.py_func(\n              input=inp, token=token, Tout=Tout, name=name)\n        else:\n          result = gen_script_ops.py_func_stateless(\n              input=inp, token=token, Tout=Tout, name=name)\n    \n      if handle_composite_tensors and Tout:\n        result = nest.pack_sequence_as(\n            out_structure, result, expand_composites=True)\n    \n>     return result if is_list_or_tuple else result[0]\nE     IndexError: list index out of range\n\n/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/ops/script_ops.py:390: IndexError\n=============================== warnings summary ===============================\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:18\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:18: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:36\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:36: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:43\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:43: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:29\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:29: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _TENSORSHAPEPROTO_DIM = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:73\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:73: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:80\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:80: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:66\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:66: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _TENSORSHAPEPROTO = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:19\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:19: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:33\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:33: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:37\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:37: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:41\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:41: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:45\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:45: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:49\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:49: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:53\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:53: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:57\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:57: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:61\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:61: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:65\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:65: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:69\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:69: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:73\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:73: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:77\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:77: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:81\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:81: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:85\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:85: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:89\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:89: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:93\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:93: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:97\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:97: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:101\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:101: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:105\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:105: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:109\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:109: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:113\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:113: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:117\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:117: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:121\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:121: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:125\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:125: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:129\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:129: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:133\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:133: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:137\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:137: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:141\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:141: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:145\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:145: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:149\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:149: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:153\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:153: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:157\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:157: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:161\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:161: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:165\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:165: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:169\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:169: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:173\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:173: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:177\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:177: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:181\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:181: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:185\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:185: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:189\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:189: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:193\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:193: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:197\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:197: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:201\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:201: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:205\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:205: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:209\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:209: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:213\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:213: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:217\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:217: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:27\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:27: DeprecationWarning: Call to deprecated create function EnumDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _DATATYPE = _descriptor.EnumDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:20\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:20: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:39\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:39: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:46\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:46: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:32\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:32: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _RESOURCEHANDLEPROTO_DTYPEANDSHAPE = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:76\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:76: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:83\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:83: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:90\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:90: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:97\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:97: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:104\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:104: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:111\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:111: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:69\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:69: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _RESOURCEHANDLEPROTO = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:21\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:21: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:40\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:40: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:47\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:47: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:54\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:54: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:61\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:61: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:68\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:68: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:75\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:75: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:82\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:82: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:89\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:89: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:96\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:96: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:103\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:103: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:110\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:110: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:117\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:117: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:124\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:124: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:131\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:131: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:138\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:138: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:145\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:145: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:152\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:152: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:33\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:33: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _TENSORPROTO = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:183\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:183: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:190\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:190: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:197\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:197: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:176\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:176: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _VARIANTTENSORDATAPROTO = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:21\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:21: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:40\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:40: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:47\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:47: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:54\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:54: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:61\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:61: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:68\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:68: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:75\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:75: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:82\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:82: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:89\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:89: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:33\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:33: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _ATTRVALUE_LISTVALUE = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/framework/dtypes.py:205\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/framework/dtypes.py:205: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)\n    np.bool8: (False, True),\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/flatbuffers/compat.py:19\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/flatbuffers/compat.py:19: DeprecationWarning: the imp module is deprecated in favour of importlib and slated for removal in Python 3.12; see the module's documentation for alternative uses\n    import imp\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:326\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:326: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)\n    np.bool8: (False, True),\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n================================ tests coverage ================================\n______________ coverage: platform darwin, python 3.10.19-final-0 _______________\n\nName                                             Stmts   Miss Branch BrPart  Cover   Missing\n--------------------------------------------------------------------------------------------\ntests/test_tensorflow_python_ops_script_ops.py     303     56     46      8    78%   24-27, 31, 35, 41-42, 92, 105->109, 114, 177-180, 194, 218, 318, 476, 495, 508, 520-543, 550, 559-576, 588, 602-603, 616, 634-641, 653-655, 669-677, 762\n--------------------------------------------------------------------------------------------\nTOTAL                                              303     56     46      8    78%\nCoverage XML written to file coverage.xml\n=========================== short test summary info ============================\nFAILED tests/test_tensorflow_python_ops_script_ops.py::TestCompositeTensorSupport::test_composite_tensor_support[ragged_tensor-dtype0-ragged-eager]\nFAILED tests/test_tensorflow_python_ops_script_ops.py::TestCompositeTensorSupport::test_composite_tensor_support[sparse_tensor-dtype1-sparse-graph]\nFAILED tests/test_tensorflow_python_ops_script_ops.py::TestCompositeTensorSupport::test_ragged_tensor_shape_inference\nFAILED tests/test_tensorflow_python_ops_script_ops.py::TestCompositeTensorSupport::test_sparse_tensor_basic_operation\nFAILED tests/test_tensorflow_python_ops_script_ops.py::TestCompositeTensorSupport::test_composite_tensor_nested_operations\n5 failed, 18 passed, 103 warnings in 1.69s\n\nError: exit 1",
    "exit_code.txt": "1",
    "analysis_plan.json": "{\n  \"status\": \"未完全通过\",\n  \"passed\": 18,\n  \"failed\": 5,\n  \"errors\": 0,\n  \"collection_errors\": false,\n  \"block_limit\": 3,\n  \"failures\": [\n    {\n      \"test\": \"TestCompositeTensorSupport.test_composite_tensor_support[ragged_tensor-dtype0-ragged-eager]\",\n      \"block_id\": \"CASE_04\",\n      \"error_type\": \"IndexError\",\n      \"action\": \"rewrite_block\",\n      \"note\": \"IndexError: list index out of range at script_ops.py:390\"\n    },\n    {\n      \"test\": \"TestCompositeTensorSupport.test_composite_tensor_support[sparse_tensor-dtype1-sparse-graph]\",\n      \"block_id\": \"CASE_04\",\n      \"error_type\": \"TypeError\",\n      \"action\": \"rewrite_block\",\n      \"note\": \"TypeError: 'Operation' object is not subscriptable\"\n    },\n    {\n      \"test\": \"TestCompositeTensorSupport.test_ragged_tensor_shape_inference\",\n      \"block_id\": \"CASE_04\",\n      \"error_type\": \"IndexError\",\n      \"action\": \"rewrite_block\",\n      \"note\": \"IndexError: list index out of range at script_ops.py:390\"\n    }\n  ],\n  \"deferred\": [\n    {\n      \"test\": \"TestCompositeTensorSupport.test_sparse_tensor_basic_operation\",\n      \"reason\": \"错误类型重复，跳过该块\"\n    },\n    {\n      \"test\": \"TestCompositeTensorSupport.test_composite_tensor_nested_operations\",\n      \"reason\": \"错误类型重复，跳过该块\"\n    }\n  ],\n  \"stop_recommended\": false,\n  \"stop_reason\": \"\"\n}",
    "analysis.md": "## 测试执行结果分析\n\n### 状态与统计\n- **状态**: 未完全通过\n- **通过**: 18 个测试\n- **失败**: 5 个测试\n- **错误**: 0 个测试\n- **集合错误**: 无\n\n### 待修复 BLOCK 列表 (≤3)\n\n1. **BLOCK_ID**: CASE_04\n   - **测试**: TestCompositeTensorSupport.test_composite_tensor_support[ragged_tensor-dtype0-ragged-eager]\n   - **错误类型**: IndexError\n   - **Action**: rewrite_block\n   - **说明**: IndexError: list index out of range at script_ops.py:390\n\n2. **BLOCK_ID**: CASE_04\n   - **测试**: TestCompositeTensorSupport.test_composite_tensor_support[sparse_tensor-dtype1-sparse-graph]\n   - **错误类型**: TypeError\n   - **Action**: rewrite_block\n   - **说明**: TypeError: 'Operation' object is not subscriptable\n\n3. **BLOCK_ID**: CASE_04\n   - **测试**: TestCompositeTensorSupport.test_ragged_tensor_shape_inference\n   - **错误类型**: IndexError\n   - **Action**: rewrite_block\n   - **说明**: IndexError: list index out of range at script_ops.py:390\n\n### 停止建议\n- **stop_recommended**: false\n- **stop_reason**: 无",
    "final_report.md": "# tensorflow.python.ops.script_ops 测试报告\n\n## 1. 执行摘要\n**脚本操作模块基础功能基本可用，但复合张量支持存在实现缺陷**。关键发现：SMOKE_SET用例全部通过，DEFERRED_SET中的复合张量测试出现IndexError和TypeError，表明`_wrap_for_composites`或`_maybe_copy_to_context_device`内部逻辑对RaggedTensor和SparseTensor处理不完整。\n\n## 2. 测试范围\n- **目标FQN**: tensorflow.python.ops.script_ops\n- **测试环境**: pytest + TensorFlow + NumPy，CPU环境，固定随机种子\n- **覆盖场景**:\n  - eager_py_func基础调用（Tensor输入输出）\n  - py_func_common NumPy数组转换（graph模式）\n  - numpy_function别名验证\n  - 复合张量支持（RaggedTensor、SparseTensor）\n  - 错误处理与类型检查\n- **未覆盖项**:\n  - 多返回值场景（Tout为列表）\n  - stateful参数影响（True/False）\n  - 梯度计算支持（EagerFunc）\n  - 函数注册表管理（FuncRegistry）\n  - 设备间数据复制详细验证\n\n## 3. 结果概览\n- **用例总数**: 23个（18通过 + 5失败）\n- **通过率**: 78.3%\n- **主要失败点**:\n  1. RaggedTensor在eager模式下的IndexError（script_ops.py:390）\n  2. SparseTensor在graph模式下的TypeError（Operation对象不可下标）\n  3. RaggedTensor形状推断失败（同IndexError）\n\n## 4. 详细发现\n\n### 严重级别：高\n**问题1**: RaggedTensor处理导致IndexError\n- **根因**: `script_ops.py`第390行访问空列表或索引越界，推测`_wrap_for_composites`函数对RaggedTensor的嵌套结构处理不当\n- **影响**: RaggedTensor无法在eager模式下正常使用\n- **建议修复**: 检查`_wrap_for_composites`函数对CompositeTensor类型的识别和包装逻辑，确保正确处理RaggedTensor的嵌套维度\n\n**问题2**: SparseTensor在graph模式下返回Operation对象\n- **根因**: graph模式下SparseTensor处理返回Operation而非Tensor，导致下标操作失败\n- **影响**: SparseTensor在graph模式下无法正常使用\n- **建议修复**: 验证`_maybe_copy_to_context_device`函数对SparseTensor的设备复制逻辑，确保返回正确的Tensor对象\n\n### 严重级别：中\n**问题3**: 复合张量形状推断失败\n- **根因**: 与问题1同源，RaggedTensor的形状推断路径存在相同索引越界问题\n- **影响**: 复合张量的形状信息无法正确推断\n- **建议修复**: 统一修复复合张量处理逻辑，确保形状推断路径与执行路径一致\n\n## 5. 覆盖与风险\n- **需求覆盖情况**:\n  - ✅ eager_py_func基础调用（完全覆盖）\n  - ✅ py_func_common NumPy转换（完全覆盖）\n  - ✅ numpy_function别名验证（完全覆盖）\n  - ⚠️ 复合张量支持（部分失败）\n  - ✅ 错误处理与类型检查（基本覆盖）\n\n- **尚未覆盖的边界**:\n  - 嵌套CompositeTensor结构（如RaggedTensor of RaggedTensor）\n  - 混合类型输入（Tensor + CompositeTensor组合）\n  - 极端形状的复合张量（超大稀疏矩阵）\n  - 多设备环境下的复合张量复制\n\n- **残留风险**:\n  - 复合张量处理逻辑的完整性未验证\n  - 设备间复制对复合张量的影响未知\n  - 性能影响：复合张量可能增加额外的序列化开销\n\n## 6. 后续动作\n\n### 优先级：P0（立即修复）\n1. **修复复合张量IndexError**\n   - 定位`script_ops.py:390`的具体代码\n   - 分析`_wrap_for_composites`函数对RaggedTensor的处理逻辑\n   - 添加边界检查，确保列表访问安全\n   - 验证修复后所有RaggedTensor测试通过\n\n2. **修复SparseTensor TypeErro**\n   - 分析graph模式下SparseTensor的返回类型\n   - 检查`_maybe_copy_to_context_device`函数实现\n   - 确保SparseTensor在graph模式下返回正确的Tensor对象\n   - 添加类型断言测试\n\n### 优先级：P1（本周内）\n3. **补充复合张量测试用例**\n   - 添加嵌套CompositeTensor测试\n   - 添加混合类型输入测试\n   - 验证形状推断的完整性\n   - 覆盖更多边界情况（空复合张量、单元素等）\n\n4. **增强错误处理测试**\n   - 添加CompositeTensor类型不匹配的异常测试\n   - 验证无效CompositeTensor结构的错误处理\n   - 测试设备不兼容场景\n\n### 优先级：P2（后续迭代）\n5. **扩展功能覆盖**\n   - 实现多返回值场景测试\n   - 验证stateful参数影响\n   - 测试梯度计算支持（EagerFunc）\n   - 验证函数注册表管理\n\n6. **环境与性能验证**\n   - 添加设备间复制验证\n   - 评估复合张量处理的性能影响\n   - 验证内存使用情况\n\n**预计工作量**: P0修复需1-2人日，P1补充测试需2-3人日，P2扩展功能需3-5人日。\n\n**风险提示**: 复合张量修复可能涉及TensorFlow核心逻辑修改，需谨慎评估向后兼容性。"
  },
  "stage_history": [
    {
      "stage": "understand_function",
      "status": "completed",
      "timestamp": "2026-01-25T10:55:18.118292",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "generate_requirements",
      "status": "completed",
      "timestamp": "2026-01-25T10:56:06.248678",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "design_test_plan",
      "status": "completed",
      "timestamp": "2026-01-25T10:57:55.615896",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-25T11:02:08.650694",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-25T11:02:12.198535",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-25T11:03:49.046357",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-25T11:07:41.351570",
      "attempts": 2,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-25T11:07:44.086027",
      "attempts": 2,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-25T11:08:44.633782",
      "attempts": 2,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-25T11:10:56.528511",
      "attempts": 3,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-25T11:10:58.507418",
      "attempts": 3,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-25T11:12:19.248577",
      "attempts": 3,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-25T11:14:44.685953",
      "attempts": 4,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-25T11:14:47.672184",
      "attempts": 4,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-25T11:16:06.240733",
      "attempts": 4,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-25T11:19:50.253787",
      "attempts": 5,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-25T11:19:52.550344",
      "attempts": 5,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-25T11:21:20.453433",
      "attempts": 5,
      "error": null
    },
    {
      "stage": "generate_report",
      "status": "completed",
      "timestamp": "2026-01-25T11:22:18.380189",
      "attempts": 1,
      "error": null
    }
  ],
  "user_feedback": []
}