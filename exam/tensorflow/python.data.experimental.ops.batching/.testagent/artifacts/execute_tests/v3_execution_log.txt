=== Run Tests ===
F.F.                                                                     [100%]
================================== FAILURES ===================================
_ TestDenseToRaggedBatch.test_dense_to_ragged_batch_basic[2-False-row_splits_dtype0-varying-data_type0] _

self = <test_tensorflow_python_data_experimental_ops_batching_g1.TestDenseToRaggedBatch object at 0x0000025BD2F6FDC0>
batch_size = 2, drop_remainder = False, row_splits_dtype = tf.int64
input_shape = 'varying', data_type = tf.float32
random_tensor_generator = <function random_tensor_generator.<locals>._generator at 0x0000025BD2F7ADC0>

    @pytest.mark.parametrize("batch_size,drop_remainder,row_splits_dtype,input_shape,data_type", [
        (2, False, tf.int64, "varying", tf.float32),
        (1, False, tf.int64, "single_element", tf.float32),  # param extension
        (5, False, tf.int32, "large_variation", tf.int32),   # param extension
    ])
    def test_dense_to_ragged_batch_basic(self, batch_size, drop_remainder,
                                        row_splits_dtype, input_shape, data_type,
                                        random_tensor_generator):
        """Test basic functionality of dense_to_ragged_batch (CASE_01)."""
        # Generate test data
        tensors = random_tensor_generator(shape_type=input_shape, dtype=data_type)
>       dataset = tf.data.Dataset.from_tensor_slices(tensors)

tests\test_tensorflow_python_data_experimental_ops_batching_g1.py:40: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:793: in from_tensor_slices
    return TensorSliceDataset(tensors, name=name)
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:4477: in __init__
    element = structure.normalize_element(element)
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\data\util\structure.py:125: in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i, dtype=dtype))
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\profiler\trace.py:183: in wrapped
    return func(*args, **kwargs)
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\framework\ops.py:1695: in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\ops\array_ops.py:1547: in _autopacking_conversion_function
    return _autopacking_helper(v, dtype, name or "packed")
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\ops\array_ops.py:1454: in _autopacking_helper
    return gen_array_ops.pack(list_or_tuple, name=name)
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\ops\gen_array_ops.py:6547: in pack
    _ops.raise_from_not_ok_status(e, name)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

e = _NotOkStatusException(), name = 'component_0'

    def raise_from_not_ok_status(e, name):
      e.message += (" name: " + name if name is not None else "")
>     raise core._status_to_exception(e) from None  # pylint: disable=protected-access
E     tensorflow.python.framework.errors_impl.InvalidArgumentError: Shapes of all inputs must match: values[0].shape = [2] != values[1].shape = [3,4] [Op:Pack] name: component_0

D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\framework\ops.py:7186: InvalidArgumentError
---------------------------- Captured stderr call -----------------------------
2026-01-18 16:05:59.518455: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
_ TestDenseToRaggedBatch.test_dense_to_ragged_batch_basic[5-False-row_splits_dtype2-large_variation-data_type2] _

self = <test_tensorflow_python_data_experimental_ops_batching_g1.TestDenseToRaggedBatch object at 0x0000025BD2F8B040>
batch_size = 5, drop_remainder = False, row_splits_dtype = tf.int32
input_shape = 'large_variation', data_type = tf.int32
random_tensor_generator = <function random_tensor_generator.<locals>._generator at 0x0000025BD43A2700>

    @pytest.mark.parametrize("batch_size,drop_remainder,row_splits_dtype,input_shape,data_type", [
        (2, False, tf.int64, "varying", tf.float32),
        (1, False, tf.int64, "single_element", tf.float32),  # param extension
        (5, False, tf.int32, "large_variation", tf.int32),   # param extension
    ])
    def test_dense_to_ragged_batch_basic(self, batch_size, drop_remainder,
                                        row_splits_dtype, input_shape, data_type,
                                        random_tensor_generator):
        """Test basic functionality of dense_to_ragged_batch (CASE_01)."""
        # Generate test data
        tensors = random_tensor_generator(shape_type=input_shape, dtype=data_type)
>       dataset = tf.data.Dataset.from_tensor_slices(tensors)

tests\test_tensorflow_python_data_experimental_ops_batching_g1.py:40: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:793: in from_tensor_slices
    return TensorSliceDataset(tensors, name=name)
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:4477: in __init__
    element = structure.normalize_element(element)
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\data\util\structure.py:125: in normalize_element
    ops.convert_to_tensor(t, name="component_%d" % i, dtype=dtype))
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\profiler\trace.py:183: in wrapped
    return func(*args, **kwargs)
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\framework\ops.py:1695: in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\ops\array_ops.py:1547: in _autopacking_conversion_function
    return _autopacking_helper(v, dtype, name or "packed")
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\ops\array_ops.py:1454: in _autopacking_helper
    return gen_array_ops.pack(list_or_tuple, name=name)
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\ops\gen_array_ops.py:6547: in pack
    _ops.raise_from_not_ok_status(e, name)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

e = _NotOkStatusException(), name = 'component_0'

    def raise_from_not_ok_status(e, name):
      e.message += (" name: " + name if name is not None else "")
>     raise core._status_to_exception(e) from None  # pylint: disable=protected-access
E     tensorflow.python.framework.errors_impl.InvalidArgumentError: Shapes of all inputs must match: values[0].shape = [1] != values[1].shape = [10] [Op:Pack] name: component_0

D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\framework\ops.py:7186: InvalidArgumentError

---------- coverage: platform win32, python 3.9.25-final-0 -----------
Name                                                                Stmts   Miss Branch BrPart  Cover   Missing
---------------------------------------------------------------------------------------------------------------
test_import.py                                                         27     27      8      0     0%   4-43
tests\test_tensorflow_python_data_experimental_ops_batching_g1.py     107     28     54     10    68%   64-77, 83, 91, 139-144, 148->157, 153, 170->exit, 173-176, 212, 220-225, 233-237
---------------------------------------------------------------------------------------------------------------
TOTAL                                                                 134     55     62     10    56%
Coverage XML written to file coverage.xml

=========================== short test summary info ===========================
FAILED tests\test_tensorflow_python_data_experimental_ops_batching_g1.py::TestDenseToRaggedBatch::test_dense_to_ragged_batch_basic[2-False-row_splits_dtype0-varying-data_type0]
FAILED tests\test_tensorflow_python_data_experimental_ops_batching_g1.py::TestDenseToRaggedBatch::test_dense_to_ragged_batch_basic[5-False-row_splits_dtype2-large_variation-data_type2]
2 failed, 2 passed in 2.86s

Error: exit 1