=== Run Tests ===
....................F..sss.....F                                         [100%]
================================== FAILURES ===================================
_ test_constant_shape_reshape_and_broadcast[value2-shape2-None-expected_shape2-expected_value2] _

value = [1, 2, 3], shape = [2, 3], dtype_str = None, expected_shape = (2, 3)
expected_value = [[1, 2, 3], [1, 2, 3]]

    @pytest.mark.parametrize("value, shape, dtype_str, expected_shape, expected_value", [
        # Test 1: Scalar broadcast to 2x3 matrix (from spec)
        (5, [2, 3], None, (2, 3), [[5, 5, 5], [5, 5, 5]]),
    
        # Test 2: Scalar broadcast to 3D tensor
        (3.14, [2, 2, 2], "float32", (2, 2, 2),
         [[[3.14, 3.14], [3.14, 3.14]], [[3.14, 3.14], [3.14, 3.14]]]),
    
        # Test 3: 1D array broadcast to 2D matrix
        ([1, 2, 3], [2, 3], None, (2, 3), [[1, 2, 3], [1, 2, 3]]),
    
        # Test 4: Reshape 1D to 2D with explicit shape
        ([1, 2, 3, 4, 5, 6], [2, 3], None, (2, 3), [[1, 2, 3], [4, 5, 6]]),
    
        # Test 5: Reshape 2D to 3D
        ([[1, 2], [3, 4], [5, 6], [7, 8]], [2, 2, 2], None, (2, 2, 2),
         [[[1, 2], [3, 4]], [[5, 6], [7, 8]]]),
    ])
    def test_constant_shape_reshape_and_broadcast(value, shape, dtype_str, expected_shape, expected_value):
        """Test shape reshaping and broadcasting (CASE_05)."""
    
        # Convert dtype string to tf.DType if provided
        dtype = tf.dtypes.as_dtype(dtype_str) if dtype_str else None
    
        # Create constant tensor with shape parameter
>       tensor = constant_op.constant(value, dtype=dtype, shape=shape)

tests\test_tensorflow_python_framework_constant_op.py:431: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\framework\constant_op.py:267: in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\framework\constant_op.py:279: in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

ctx = <tensorflow.python.eager.context.Context object at 0x00000184444D5100>
value = [1, 2, 3], dtype = None, shape = TensorShape([2, 3])
verify_shape = False

    def _constant_eager_impl(ctx, value, dtype, shape, verify_shape):
      """Creates a constant on the current device."""
      t = convert_to_eager_tensor(value, ctx, dtype)
      if shape is None:
        return t
      shape = tensor_shape.as_shape(shape)
      if shape == t.shape:
        return t
      if verify_shape:
        raise TypeError(f"Expected Tensor {t} (converted from {value}) with shape "
                        f"{tuple(shape)}, but got shape {tuple(t.shape)}.")
      num_t = t.shape.num_elements()
      # TODO(josh11b): Implement shape -> eager tensor conversion.
      if num_t == shape.num_elements():
        return _eager_reshape(t, shape.as_list(), ctx)
      if num_t == 1:
        if t.dtype == dtypes.bool:
          # We don't have a Fill kernel for bool dtype on GPU. So we first run
          # Fill on CPU and then copy to GPU if needed.
          with ops.device("/device:CPU:0"):
            x = _eager_fill(shape.as_list(), _eager_identity(t, ctx), ctx)
          return _eager_identity(x, ctx)
        else:
          return _eager_fill(shape.as_list(), t, ctx)
>     raise TypeError("Eager execution of tf.constant with unsupported shape. "
                      f"Tensor {t} (converted from {value}) has {num_t:d} "
                      f"elements, but got `shape` {shape} with "
                      f"{shape.num_elements()} elements).")
E     TypeError: Eager execution of tf.constant with unsupported shape. Tensor [1 2 3] (converted from [1, 2, 3]) has 3 elements, but got `shape` (2, 3) with 6 elements).

D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\framework\constant_op.py:326: TypeError
___________________ test_constant_with_special_numpy_dtypes ___________________

    def test_constant_with_special_numpy_dtypes():
        """Test constant with special numpy dtypes (coverage gap)."""
        # Test with numpy datetime64
        arr_datetime = np.array(['2023-01-01', '2023-01-02'], dtype='datetime64[s]')
>       tensor1 = constant_op.constant(arr_datetime)

tests\test_tensorflow_python_framework_constant_op.py:711: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\framework\constant_op.py:267: in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\framework\constant_op.py:279: in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\framework\constant_op.py:304: in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

value = array(['2023-01-01T00:00:00', '2023-01-02T00:00:00'],
      dtype='datetime64[s]')
ctx = <tensorflow.python.eager.context.Context object at 0x00000184444D5100>
dtype = None

    def convert_to_eager_tensor(value, ctx, dtype=None):
      """Converts the given `value` to an `EagerTensor`.
    
      Note that this function could return cached copies of created constants for
      performance reasons.
    
      Args:
        value: value to convert to EagerTensor.
        ctx: value of context.context().
        dtype: optional desired dtype of the converted EagerTensor.
    
      Returns:
        EagerTensor created from value.
    
      Raises:
        TypeError: if `dtype` is not compatible with the type of t.
      """
      if isinstance(value, ops.EagerTensor):
        if dtype is not None and value.dtype != dtype:
          raise TypeError(f"Expected tensor {value} with dtype {dtype!r}, but got "
                          f"dtype {value.dtype!r}.")
        return value
      if dtype is not None:
        try:
          dtype = dtype.as_datatype_enum
        except AttributeError:
          dtype = dtypes.as_dtype(dtype).as_datatype_enum
      ctx.ensure_initialized()
>     return ops.EagerTensor(value, ctx.device_name, dtype)
E     ValueError: Failed to convert a NumPy array to a Tensor (Unsupported numpy type: NPY_DATETIME).

D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\framework\constant_op.py:102: ValueError

---------- coverage: platform win32, python 3.9.25-final-0 -----------
Name                                                    Stmts   Miss Branch BrPart  Cover   Missing
---------------------------------------------------------------------------------------------------
tests\test_tensorflow_python_framework_constant_op.py     221     26     56      9    84%   41->57, 62, 76, 83-92, 223-227, 281->exit, 455->461, 465->exit, 470, 479, 486, 493, 713-726
---------------------------------------------------------------------------------------------------
TOTAL                                                     221     26     56      9    84%
Coverage XML written to file coverage.xml

=========================== short test summary info ===========================
FAILED tests\test_tensorflow_python_framework_constant_op.py::test_constant_shape_reshape_and_broadcast[value2-shape2-None-expected_shape2-expected_value2]
FAILED tests\test_tensorflow_python_framework_constant_op.py::test_constant_with_special_numpy_dtypes
2 failed, 27 passed, 3 skipped in 1.71s

Error: exit 1