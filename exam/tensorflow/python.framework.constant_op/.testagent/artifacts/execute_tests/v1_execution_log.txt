=== Run Tests ===
.............Fssss..F                                                    [100%]
================================== FAILURES ===================================
___________________ test_constant_v1_verify_shape_parameter ___________________

    def test_constant_v1_verify_shape_parameter():
        """Test verify_shape parameter validation (CASE_04)."""
    
        # Test 1: verify_shape=True with matching shape
        tensor1 = constant_op.constant_v1(
            value=[1, 2, 3],
            shape=[3],
            verify_shape=True
        )
        assert_tensor_properties(
            tensor=tensor1,
            expected_shape=(3,),
            expected_dtype=tf.int32,
            expected_value=[1, 2, 3]
        )
    
        # Test 2: verify_shape=False with matching shape (should work)
        tensor2 = constant_op.constant_v1(
            value=[[1, 2], [3, 4]],
            shape=[2, 2],
            verify_shape=False
        )
        assert_tensor_properties(
            tensor=tensor2,
            expected_shape=(2, 2),
            expected_dtype=tf.int32,
            expected_value=[[1, 2], [3, 4]]
        )
    
        # Test 3: verify_shape=True with mismatching shape (should raise error)
        with pytest.raises((ValueError, TypeError)) as exc_info:
            constant_op.constant_v1(
                value=[1, 2, 3],
                shape=[4],  # Shape doesn't match value length
                verify_shape=True
            )
        # Verify error message contains shape information
        error_msg = str(exc_info.value).lower()
        assert any(keyword in error_msg for keyword in ['shape', 'size', 'dimension', 'length'])
    
        # Test 4: verify_shape=False with mismatching shape (should work with broadcasting/filling)
        # Note: constant_v1 with allow_broadcast=False may behave differently
>       tensor4 = constant_op.constant_v1(
            value=[1, 2],
            shape=[3],
            verify_shape=False
        )

tests\test_tensorflow_python_framework_constant_op.py:299: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\framework\constant_op.py:166: in constant_v1
    return _constant_impl(value, dtype, shape, name, verify_shape=verify_shape,
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\framework\constant_op.py:279: in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

ctx = <tensorflow.python.eager.context.Context object at 0x00000202364CFFA0>
value = [1, 2], dtype = None, shape = TensorShape([3]), verify_shape = False

    def _constant_eager_impl(ctx, value, dtype, shape, verify_shape):
      """Creates a constant on the current device."""
      t = convert_to_eager_tensor(value, ctx, dtype)
      if shape is None:
        return t
      shape = tensor_shape.as_shape(shape)
      if shape == t.shape:
        return t
      if verify_shape:
        raise TypeError(f"Expected Tensor {t} (converted from {value}) with shape "
                        f"{tuple(shape)}, but got shape {tuple(t.shape)}.")
      num_t = t.shape.num_elements()
      # TODO(josh11b): Implement shape -> eager tensor conversion.
      if num_t == shape.num_elements():
        return _eager_reshape(t, shape.as_list(), ctx)
      if num_t == 1:
        if t.dtype == dtypes.bool:
          # We don't have a Fill kernel for bool dtype on GPU. So we first run
          # Fill on CPU and then copy to GPU if needed.
          with ops.device("/device:CPU:0"):
            x = _eager_fill(shape.as_list(), _eager_identity(t, ctx), ctx)
          return _eager_identity(x, ctx)
        else:
          return _eager_fill(shape.as_list(), t, ctx)
>     raise TypeError("Eager execution of tf.constant with unsupported shape. "
                      f"Tensor {t} (converted from {value}) has {num_t:d} "
                      f"elements, but got `shape` {shape} with "
                      f"{shape.num_elements()} elements).")
E     TypeError: Eager execution of tf.constant with unsupported shape. Tensor [1 2] (converted from [1, 2]) has 2 elements, but got `shape` (3,) with 3 elements).

D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\framework\constant_op.py:326: TypeError
__________________________ test_constant_error_cases __________________________

    def test_constant_error_cases():
        """Test error cases for constant creation."""
        # Test with invalid shape parameter
        with pytest.raises((ValueError, TypeError)) as exc_info:
            constant_op.constant([1, 2, 3], shape=[-1, 2])
>       assert "shape" in str(exc_info.value).lower() or "invalid" in str(exc_info.value).lower()
E       AssertionError: assert ('shape' in 'dimension -1 must be >= 0' or 'invalid' in 'dimension -1 must be >= 0')
E        +  where 'dimension -1 must be >= 0' = <built-in method lower of str object at 0x0000020238335350>()
E        +    where <built-in method lower of str object at 0x0000020238335350> = 'Dimension -1 must be >= 0'.lower
E        +      where 'Dimension -1 must be >= 0' = str(ValueError('Dimension -1 must be >= 0'))
E        +        where ValueError('Dimension -1 must be >= 0') = <ExceptionInfo ValueError('Dimension -1 must be >= 0') tblen=8>.value
E        +  and   'dimension -1 must be >= 0' = <built-in method lower of str object at 0x0000020238335350>()
E        +    where <built-in method lower of str object at 0x0000020238335350> = 'Dimension -1 must be >= 0'.lower
E        +      where 'Dimension -1 must be >= 0' = str(ValueError('Dimension -1 must be >= 0'))
E        +        where ValueError('Dimension -1 must be >= 0') = <ExceptionInfo ValueError('Dimension -1 must be >= 0') tblen=8>.value

tests\test_tensorflow_python_framework_constant_op.py:426: AssertionError

---------- coverage: platform win32, python 3.9.25-final-0 -----------
Name                                                    Stmts   Miss Branch BrPart  Cover   Missing
---------------------------------------------------------------------------------------------------
tests\test_tensorflow_python_framework_constant_op.py     126     22     24      6    81%   41->57, 62, 68, 76, 183-185, 239->exit, 305-340, 353, 360, 367, 374, 429-434
---------------------------------------------------------------------------------------------------
TOTAL                                                     126     22     24      6    81%
Coverage XML written to file coverage.xml

=========================== short test summary info ===========================
FAILED tests\test_tensorflow_python_framework_constant_op.py::test_constant_v1_verify_shape_parameter
FAILED tests\test_tensorflow_python_framework_constant_op.py::test_constant_error_cases
2 failed, 15 passed, 4 skipped in 1.65s

Error: exit 1