{
  "workflow_id": "dfe69335",
  "created_at": "2026-01-24T14:29:09.550022",
  "op": "tensorflow_python_ops_gen_linalg_ops",
  "arch": "python",
  "soc": "python",
  "vendor": "python",
  "project_root": "/Users/zzf1sh/Documents/Project/TestAgent-CLI-main/exam/tensorflow/python.ops.gen_linalg_ops",
  "target": "tensorflow.python.ops.gen_linalg_ops",
  "target_slug": "tensorflow_python_ops_gen_linalg_ops",
  "current_stage": "complete",
  "stage_index": 6,
  "mode": "full-auto",
  "epoch_total": 5,
  "epoch_current": 5,
  "last_failure_signature": "",
  "last_error_signature": "",
  "last_block_errors": {},
  "auto_stop_reason": "",
  "artifacts": {
    "function_doc.md": "# tensorflow.python.ops.gen_linalg_ops - 函数说明\n\n## 1. 基本信息\n- **FQN**: tensorflow.python.ops.gen_linalg_ops\n- **模块文件**: `/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/ops/gen_linalg_ops.py`\n- **签名**: 模块（包含多个函数）\n- **对象类型**: module\n- **模块说明**: Python wrappers around TensorFlow ops. This file is MACHINE GENERATED! Do not edit. Original C++ source file: linalg_ops.cc\n\n## 2. 功能概述\n- 提供TensorFlow线性代数操作的Python包装器\n- 包含矩阵分解、求解、特征值计算等核心线性代数函数\n- 支持批量操作和多种数值类型（浮点、复数）\n\n## 3. 核心函数列表\n- **Cholesky**: 计算一个或多个方阵的Cholesky分解\n- **MatrixInverse**: 计算一个或多个方阵的逆矩阵\n- **QR**: 计算一个或多个矩阵的QR分解\n- **Svd**: 计算奇异值分解\n- **Eig**: 计算特征值和特征向量\n- **MatrixSolve**: 求解线性方程组\n- **MatrixDeterminant**: 计算矩阵行列式\n- **Lu**: 计算LU分解\n\n## 4. 主要函数参数模式\n- **输入张量**: 支持 `float64`, `float32`, `half`, `complex64`, `complex128` 类型\n- **形状约束**: 通常为 `[..., M, M]` 或 `[..., M, N]` 格式\n- **可选参数**: 如 `adjoint`, `full_matrices`, `lower` 等布尔标志\n- **name参数**: 操作名称（可选）\n\n## 5. 文档要点\n- **Cholesky**: 输入必须对称正定，只使用下三角部分\n- **MatrixInverse**: 使用LU分解计算，不可逆矩阵行为未定义\n- **QR**: 梯度仅在矩阵前P列线性独立时定义良好\n- **批量支持**: 所有函数支持批量操作（前导维度为批量维度）\n- **设备性能**: GPU上大矩阵梯度计算更快，小批量小矩阵可能CPU更快\n\n## 6. 源码摘要\n- **代码生成**: 机器生成文件，不应手动编辑\n- **执行路径**: 支持eager模式和graph模式\n- **依赖**: 使用 `pywrap_tfe.TFE_Py_FastPathExecute` 进行快速执行\n- **错误处理**: 通过 `_core._NotOkStatusException` 捕获C++层错误\n- **梯度记录**: 使用 `_execute.record_gradient` 记录梯度\n\n## 7. 示例与用法\n```python\n# Cholesky分解示例\nimport tensorflow as tf\ninput = tf.constant([[4., 1.], [1., 3.]], dtype=tf.float32)\nresult = tf.linalg.cholesky(input)  # 使用公开API\n\n# QR分解示例\na = tf.constant([[1., 2.], [3., 4.]], dtype=tf.float32)\nq, r = tf.linalg.qr(a)\n\n# 矩阵求逆示例\nmatrix = tf.constant([[1., 2.], [3., 4.]], dtype=tf.float32)\ninverse = tf.linalg.inv(matrix)\n```\n\n## 8. 风险与空白\n- **文档缺失**: 部分函数（如 `banded_triangular_solve`）只有\"TODO: add doc\"\n- **错误处理**: 不可逆矩阵的行为未明确定义（可能返回垃圾结果或异常）\n- **数值稳定性**: 未详细说明数值精度和稳定性保证\n- **边界条件**: 奇异矩阵、病态矩阵的处理方式未明确\n- **类型约束**: 仅列出支持的数据类型，未说明类型转换规则\n- **形状验证**: 输入形状验证的详细规则未在Python层说明\n- **多实体情况**: 模块包含30+个函数，测试需覆盖主要API\n- **C++依赖**: 实际实现在C++层（linalg_ops.cc），Python层为包装器",
    "requirements.md": "# tensorflow.python.ops.gen_linalg_ops 测试需求\n\n## 1. 目标与范围\n- 验证线性代数操作（Cholesky、QR、SVD、矩阵求逆、求解、特征值等）的正确性\n- 确保批量操作、多种数值类型（浮点、复数）支持\n- 验证形状约束、设备兼容性、梯度计算\n- 不在范围：底层C++实现细节、性能基准测试、第三方库集成\n\n## 2. 输入与约束\n- 参数：输入张量（float64/float32/half/complex64/complex128）、可选布尔标志（adjoint/full_matrices/lower等）、name\n- 形状约束：方阵 `[..., M, M]` 或一般矩阵 `[..., M, N]`，前导维度为批量维度\n- 设备要求：CPU/GPU兼容，大矩阵GPU性能更优\n- 必需组合：Cholesky输入必须对称正定，MatrixSolve需要可逆系数矩阵\n- 随机性：无全局状态要求，操作应为确定性\n\n## 3. 输出与判定\n- 返回结构：单个张量（Cholesky、MatrixInverse）或多个张量（QR、SVD、Eig）\n- 容差：浮点误差在1e-6内，复数误差需验证实部虚部分别\n- 状态变化：无副作用，纯函数行为\n- 检查点：输出形状匹配输入形状约束，数值正确性验证\n\n## 4. 错误与异常场景\n- 非法输入：非正定矩阵调用Cholesky，奇异矩阵求逆\n- 维度错误：非方阵调用Cholesky/MatrixInverse，形状不匹配\n- 类型错误：不支持的数据类型（如int32）\n- 边界值：空张量、零维张量、零大小矩阵\n- 极端形状：超大矩阵（内存限制）、极小矩阵（1x1）\n- 极端数值：极大/极小浮点数、NaN、Inf\n\n## 5. 依赖与环境\n- 外部依赖：TensorFlow C++核心库（linalg_ops.cc）\n- 设备依赖：CUDA GPU支持（可选）\n- 需要mock：`pywrap_tfe.TFE_Py_FastPathExecute`（执行路径）\n- 需要monkeypatch：`_execute.record_gradient`（梯度记录）\n- 需要监控：`_core._NotOkStatusException`（C++错误传播）\n\n## 6. 覆盖与优先级\n- 必测路径（高优先级）：\n  1. Cholesky分解对称正定矩阵验证\n  2. QR分解形状保持与正交性验证\n  3. 矩阵求逆可逆性验证与逆矩阵性质\n  4. SVD分解重构误差验证\n  5. 批量操作跨批次一致性验证\n\n- 可选路径（中/低优先级）：\n  - 复数矩阵操作正确性\n  - 不同数值类型（half/float32/float64）精度差异\n  - GPU与CPU结果一致性\n  - 梯度计算正确性（前向/反向传播）\n  - 病态矩阵数值稳定性\n  - 边缘形状（1x1, 2x2, 大尺寸）处理\n  - 可选参数（adjoint, full_matrices, lower）组合\n\n- 已知风险/缺失信息：\n  - 不可逆矩阵行为未定义\n  - 奇异矩阵处理方式未明确\n  - 数值精度保证未详细说明\n  - 部分函数文档缺失（如banded_triangular_solve）\n  - 类型转换规则未明确\n  - 形状验证详细规则未说明",
    "test_plan.json": "{\n  \"plan_version\": 2,\n  \"target\": \"tensorflow.python.ops.gen_linalg_ops\",\n  \"block_rules\": {\n    \"header_block\": \"HEADER\",\n    \"footer_block\": \"FOOTER\",\n    \"case_prefix\": \"CASE_\",\n    \"case_format\": \"CASE_01\"\n  },\n  \"iteration_strategy\": {\n    \"round1\": {\n      \"include\": \"SMOKE_SET\",\n      \"assert_level\": \"weak\",\n      \"max_blocks\": 5\n    },\n    \"roundN\": {\n      \"only_fix_failed_blocks\": true,\n      \"block_limit\": 3,\n      \"promote_deferred\": true\n    },\n    \"final\": {\n      \"enable_strong_asserts\": true,\n      \"coverage_optional\": true\n    }\n  },\n  \"test_files\": {\n    \"default\": \"tests/test_tensorflow_python_ops_gen_linalg_ops.py\",\n    \"all_pattern\": \"tests/test_tensorflow_python_ops_gen_linalg_ops.py\"\n  },\n  \"cases\": [\n    {\n      \"tc_id\": \"TC-01\",\n      \"block_id\": \"CASE_01\",\n      \"name\": \"Cholesky分解核心路径\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"dtype\": \"float32\",\n          \"device\": \"cpu\",\n          \"shape\": [3, 3],\n          \"flags\": [],\n          \"matrix_type\": \"symmetric_positive_definite\"\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"shape_match\", \"dtype_match\", \"finite_values\", \"lower_triangular\"],\n        \"strong\": [\"cholesky_reconstruction\", \"numerical_stability\", \"batch_consistency\"]\n      },\n      \"oracle\": \"torch.linalg.cholesky\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"S\",\n      \"max_lines\": 80,\n      \"max_params\": 6,\n      \"is_parametrized\": true,\n      \"requires_mock\": true,\n      \"mock_targets\": [\"pywrap_tfe.TFE_Py_FastPathExecute\", \"_execute.record_gradient\"]\n    },\n    {\n      \"tc_id\": \"TC-02\",\n      \"block_id\": \"CASE_02\",\n      \"name\": \"QR分解正交性验证\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"dtype\": \"float64\",\n          \"device\": \"cpu\",\n          \"shape\": [4, 3],\n          \"flags\": [],\n          \"matrix_type\": \"full_rank\"\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"shape_match_q\", \"shape_match_r\", \"dtype_match\", \"finite_values\"],\n        \"strong\": [\"q_orthogonality\", \"r_upper_triangular\", \"qr_reconstruction\", \"batch_consistency\"]\n      },\n      \"oracle\": \"torch.linalg.qr\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"S\",\n      \"max_lines\": 85,\n      \"max_params\": 6,\n      \"is_parametrized\": true,\n      \"requires_mock\": true,\n      \"mock_targets\": [\"pywrap_tfe.TFE_Py_FastPathExecute\", \"_execute.record_gradient\"]\n    },\n    {\n      \"tc_id\": \"TC-03\",\n      \"block_id\": \"CASE_03\",\n      \"name\": \"矩阵求逆可逆性验证\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"dtype\": \"float32\",\n          \"device\": \"cpu\",\n          \"shape\": [2, 2],\n          \"flags\": [],\n          \"matrix_type\": \"well_conditioned\"\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"shape_match\", \"dtype_match\", \"finite_values\", \"inverse_shape\"],\n        \"strong\": [\"inverse_property\", \"identity_reconstruction\", \"numerical_accuracy\", \"batch_consistency\"]\n      },\n      \"oracle\": \"torch.linalg.inv\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"S\",\n      \"max_lines\": 75,\n      \"max_params\": 6,\n      \"is_parametrized\": true,\n      \"requires_mock\": true,\n      \"mock_targets\": [\"pywrap_tfe.TFE_Py_FastPathExecute\", \"_execute.record_gradient\"]\n    },\n    {\n      \"tc_id\": \"TC-04\",\n      \"block_id\": \"CASE_04\",\n      \"name\": \"SVD分解重构验证\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"dtype\": \"float64\",\n          \"device\": \"cpu\",\n          \"shape\": [3, 5],\n          \"flags\": [\"full_matrices\"],\n          \"matrix_type\": \"full_rank\"\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"shape_match_u\", \"shape_match_s\", \"shape_match_v\", \"dtype_match\", \"finite_values\"],\n        \"strong\": [\"u_orthogonality\", \"v_orthogonality\", \"svd_reconstruction\", \"singular_values_order\", \"batch_consistency\"]\n      },\n      \"oracle\": \"torch.linalg.svd\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"M\",\n      \"max_lines\": 90,\n      \"max_params\": 7,\n      \"is_parametrized\": true,\n      \"requires_mock\": true,\n      \"mock_targets\": [\"pywrap_tfe.TFE_Py_FastPathExecute\", \"_execute.record_gradient\"]\n    },\n    {\n      \"tc_id\": \"TC-05\",\n      \"block_id\": \"CASE_05\",\n      \"name\": \"批量操作一致性验证\",\n      \"priority\": \"High\",\n      \"param_matrix\": [\n        {\n          \"dtype\": \"float32\",\n          \"device\": \"cpu\",\n          \"shape\": [2, 3, 3],\n          \"flags\": [],\n          \"matrix_type\": \"symmetric_positive_definite\",\n          \"operation\": \"cholesky\"\n        }\n      ],\n      \"asserts\": {\n        \"weak\": [\"batch_shape_match\", \"dtype_match\", \"finite_values\", \"batch_dimension_preserved\"],\n        \"strong\": [\"batch_consistency\", \"independent_batch_processing\", \"gradient_batch_support\"]\n      },\n      \"oracle\": \"torch.linalg.cholesky\",\n      \"assertion_level\": \"weak\",\n      \"size\": \"S\",\n      \"max_lines\": 80,\n      \"max_params\": 6,\n      \"is_parametrized\": true,\n      \"requires_mock\": true,\n      \"mock_targets\": [\"pywrap_tfe.TFE_Py_FastPathExecute\", \"_execute.record_gradient\"]\n    }\n  ],\n  \"param_extensions\": [\n    {\n      \"base_block_id\": \"CASE_01\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"dtype\": \"float64\",\n        \"device\": \"cpu\",\n        \"shape\": [5, 5],\n        \"flags\": [],\n        \"matrix_type\": \"symmetric_positive_definite\"\n      },\n      \"note\": \"作为参数扩展：更高精度类型\"\n    },\n    {\n      \"base_block_id\": \"CASE_01\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"dtype\": \"float32\",\n        \"device\": \"cpu\",\n        \"shape\": [1, 1],\n        \"flags\": [],\n        \"matrix_type\": \"symmetric_positive_definite\"\n      },\n      \"note\": \"作为参数扩展：最小形状\"\n    },\n    {\n      \"base_block_id\": \"CASE_02\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"dtype\": \"float32\",\n        \"device\": \"cpu\",\n        \"shape\": [2, 2],\n        \"flags\": [\"full_matrices\"],\n        \"matrix_type\": \"full_rank\"\n      },\n      \"note\": \"作为参数扩展：方阵QR分解\"\n    },\n    {\n      \"base_block_id\": \"CASE_03\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"dtype\": \"float64\",\n        \"device\": \"cpu\",\n        \"shape\": [4, 4],\n        \"flags\": [],\n        \"matrix_type\": \"well_conditioned\"\n      },\n      \"note\": \"作为参数扩展：更大尺寸矩阵\"\n    },\n    {\n      \"base_block_id\": \"CASE_04\",\n      \"priority\": \"Medium\",\n      \"params\": {\n        \"dtype\": \"float32\",\n        \"device\": \"cpu\",\n        \"shape\": [2, 2],\n        \"flags\": [],\n        \"matrix_type\": \"full_rank\"\n      },\n      \"note\": \"作为参数扩展：方阵SVD\"\n    }\n  ],\n  \"smoke_set\": [\"CASE_01\", \"CASE_02\", \"CASE_03\"],\n  \"deferred_set\": [\"CASE_04\", \"CASE_05\"]\n}",
    "test_plan.md": "# tensorflow.python.ops.gen_linalg_ops 测试计划\n\n## 1. 测试策略\n- **单元测试框架**：pytest\n- **隔离策略**：mock/monkeypatch/fixtures\n  - 核心执行路径：`pywrap_tfe.TFE_Py_FastPathExecute`\n  - 梯度记录：`_execute.record_gradient`\n  - 错误传播：`_core._NotOkStatusException`\n- **随机性处理**：固定随机种子，控制RNG生成确定性测试数据\n- **设备兼容性**：优先CPU测试，GPU作为可选扩展\n- **数值类型覆盖**：float32/float64优先，half/complex作为后续扩展\n\n## 2. 生成规格摘要（来自 test_plan.json）\n- **SMOKE_SET**: CASE_01 (Cholesky), CASE_02 (QR), CASE_03 (MatrixInverse)\n- **DEFERRED_SET**: CASE_04 (SVD), CASE_05 (Batch Operations)\n- **测试文件路径**：`tests/test_tensorflow_python_ops_gen_linalg_ops.py`（单文件）\n- **断言分级策略**：\n  - weak：形状匹配、数据类型、有限值、基本属性\n  - strong：数值精度、正交性、重构误差、批量一致性\n- **预算策略**：\n  - size：S（小型测试，80-90行）\n  - max_lines：75-90行\n  - max_params：6-7个参数\n  - is_parametrized：true（支持参数化扩展）\n  - requires_mock：true（需要mock底层执行）\n\n## 3. 数据与边界\n- **正常数据集**：随机生成对称正定矩阵、满秩矩阵、良态矩阵\n- **随机生成策略**：固定种子，控制条件数，避免病态矩阵\n- **边界值**：\n  - 最小形状：1x1矩阵\n  - 小尺寸：2x2, 3x3\n  - 非方阵：3x5, 4x3\n  - 批量操作：2x3x3\n- **极端形状**：\n  - 空张量（后续扩展）\n  - 零维张量（后续扩展）\n  - 超大矩阵（内存限制，后续扩展）\n- **负例与异常场景**：\n  - 非正定矩阵调用Cholesky\n  - 奇异矩阵求逆\n  - 非方阵调用Cholesky/MatrixInverse\n  - 不支持的数据类型\n  - 形状不匹配\n  - NaN/Inf输入\n  - 病态矩阵数值稳定性\n\n## 4. 覆盖映射\n| TC ID | 对应需求/约束 | 覆盖函数 | 优先级 |\n|-------|--------------|----------|--------|\n| TC-01 | Cholesky对称正定验证 | gen_linalg_ops.cholesky | High |\n| TC-02 | QR分解正交性验证 | gen_linalg_ops.qr | High |\n| TC-03 | 矩阵求逆可逆性验证 | gen_linalg_ops.matrix_inverse | High |\n| TC-04 | SVD分解重构验证 | gen_linalg_ops.svd | High |\n| TC-05 | 批量操作一致性验证 | 多个函数批量支持 | High |\n\n### 尚未覆盖的风险点\n1. **复数矩阵操作**：complex64/complex128类型支持\n2. **GPU-CPU一致性**：设备间结果差异\n3. **梯度计算验证**：前向/反向传播正确性\n4. **病态矩阵处理**：数值稳定性边界\n5. **文档缺失函数**：banded_triangular_solve等\n6. **类型转换规则**：隐式类型转换行为\n7. **形状验证细节**：Python层验证规则\n8. **不可逆矩阵行为**：错误处理未定义\n\n## 5. 迭代策略\n- **首轮（round1）**：仅生成SMOKE_SET（3个核心用例），使用weak断言\n- **后续迭代（roundN）**：修复失败用例，提升deferred_set优先级\n- **最终轮（final）**：启用strong断言，可选覆盖率目标\n\n## 6. Mock策略\n所有用例需要mock以下目标：\n- `pywrap_tfe.TFE_Py_FastPathExecute`：核心执行路径\n- `_execute.record_gradient`：梯度记录\n- 通过monkeypatch监控`_core._NotOkStatusException`异常传播",
    "tests/test_tensorflow_python_ops_gen_linalg_ops.py": "\"\"\"\nTest cases for tensorflow.python.ops.gen_linalg_ops module.\nGenerated with TestAgent-CLI.\n\"\"\"\n\nimport math\nimport numpy as np\nimport pytest\nimport torch\nimport tensorflow as tf\nfrom unittest.mock import patch, MagicMock\n\n# Import target functions\nfrom tensorflow.python.ops.gen_linalg_ops import (\n    Cholesky,\n    Qr,\n    MatrixInverse,\n    Svd,\n    BatchCholesky,\n    batch_cholesky,\n    qr,\n    matrix_inverse,\n    svd\n)\n\n# Set random seed for reproducibility\nnp.random.seed(42)\ntorch.manual_seed(42)\ntf.random.set_seed(42)\n\n# ==== BLOCK:HEADER START ====\n# Header block - imports and fixtures\n# ==== BLOCK:HEADER END ====\n\n# ==== BLOCK:CASE_01 START ====\n# Test case for Cholesky decomposition\n# ==== BLOCK:CASE_01 END ====\n\n# ==== BLOCK:CASE_02 START ====\n# Test case for QR decomposition\n# ==== BLOCK:CASE_02 END ====\n\n# ==== BLOCK:CASE_03 START ====\n# Test case for Matrix Inverse\n# ==== BLOCK:CASE_03 END ====\n\n# ==== BLOCK:CASE_04 START ====\n# Test case for SVD decomposition (deferred)\n# ==== BLOCK:CASE_04 END ====\n\n# ==== BLOCK:CASE_05 START ====\n# Test case for Batch operations (deferred)\n# ==== BLOCK:CASE_05 END ====\n\n# ==== BLOCK:FOOTER START ====\n# Footer block - cleanup and additional tests\n# ==== BLOCK:FOOTER END ====",
    "execution_log.txt": "=== Run Tests ===\n....F.......                                                             [100%]\n=================================== FAILURES ===================================\n____________ test_qr_decomposition[float32-shape1-flags1-full_rank] ____________\n\ndtype_str = 'float32', shape = (2, 2), flags = ['full_matrices']\nmatrix_type = 'full_rank'\nmock_tf_internals = {'_execute': <MagicMock id='6028007152'>, 'fastpath': <MagicMock name='mock.TFE_Py_FastPathExecute' id='6028014880'>, 'pywrap_tfe': <MagicMock id='6027950064'>, 'record_grad': <MagicMock name='mock.record_gradient' id='6028022624'>}\n\n    @pytest.mark.parametrize(\"dtype_str,shape,flags,matrix_type\", [\n        (\"float64\", (4, 3), [], \"full_rank\"),  # main test case\n        (\"float32\", (2, 2), [\"full_matrices\"], \"full_rank\"),  # param extension: square matrix\n    ])\n    def test_qr_decomposition(dtype_str, shape, flags, matrix_type, mock_tf_internals):\n        \"\"\"\n        Test QR decomposition with weak assertions:\n        - shape_match_q: Q matrix has correct shape\n        - shape_match_r: R matrix has correct shape\n        - dtype_match: output dtypes match input dtype\n        - finite_values: outputs contain only finite values\n        \"\"\"\n        # Convert dtype string to numpy dtype\n        dtype_map = {\n            \"float32\": np.float32,\n            \"float64\": np.float64\n        }\n        np_dtype = dtype_map[dtype_str]\n        tf_dtype = getattr(tf, dtype_str)\n    \n        # Generate test matrix\n        m, n = shape\n        if matrix_type == \"full_rank\":\n            A_np = generate_full_rank_matrix(m, n, np_dtype)\n        else:\n            raise ValueError(f\"Unsupported matrix_type: {matrix_type}\")\n    \n        # Convert to TensorFlow tensor\n        A_tf = tf.constant(A_np, dtype=tf_dtype)\n    \n        # Determine if full_matrices flag is set\n        full_matrices = \"full_matrices\" in flags\n    \n        # Call QR with mocked internals\n        # Note: TensorFlow's Qr returns (q, r) tuple\n        q_tf, r_tf = Qr(input=A_tf, full_matrices=full_matrices)\n    \n        # Convert to numpy for assertions\n        q_np = q_tf.numpy()\n        r_np = r_tf.numpy()\n    \n        # Weak assertion 1: shape_match_q\n        if full_matrices:\n            expected_q_shape = (m, m)  # full Q matrix\n        else:\n            expected_q_shape = (m, min(m, n))  # economy size Q\n    \n        assert q_np.shape == expected_q_shape, \\\n            f\"Q shape {q_np.shape} doesn't match expected {expected_q_shape}\"\n    \n        # Weak assertion 2: shape_match_r\n        if full_matrices:\n            expected_r_shape = (m, n)  # full R matrix\n        else:\n            expected_r_shape = (min(m, n), n)  # economy size R\n    \n        assert r_np.shape == expected_r_shape, \\\n            f\"R shape {r_np.shape} doesn't match expected {expected_r_shape}\"\n    \n        # Weak assertion 3: dtype_match\n        assert q_np.dtype == A_np.dtype, \\\n            f\"Q dtype {q_np.dtype} doesn't match input dtype {A_np.dtype}\"\n        assert r_np.dtype == A_np.dtype, \\\n            f\"R dtype {r_np.dtype} doesn't match input dtype {A_np.dtype}\"\n    \n        # Weak assertion 4: finite_values\n        assert np.all(np.isfinite(q_np)), \\\n            \"Q matrix contains non-finite values (NaN or Inf)\"\n        assert np.all(np.isfinite(r_np)), \\\n            \"R matrix contains non-finite values (NaN or Inf)\"\n    \n        # Optional: verify with torch oracle (weak assertion level)\n        A_torch = torch.tensor(A_np)\n>       Q_torch, R_torch = torch.linalg.qr(A_torch, mode='full' if full_matrices else 'reduced')\nE       RuntimeError: qr received unrecognized mode 'full' but expected one of 'reduced' (default), 'r', or 'complete'\n\ntests/test_tensorflow_python_ops_gen_linalg_ops.py:288: RuntimeError\n=============================== warnings summary ===============================\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:18\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:18: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:36\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:36: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:43\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:43: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:29\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:29: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _TENSORSHAPEPROTO_DIM = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:73\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:73: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:80\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:80: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:66\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_shape_pb2.py:66: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _TENSORSHAPEPROTO = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:19\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:19: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:33\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:33: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:37\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:37: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:41\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:41: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:45\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:45: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:49\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:49: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:53\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:53: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:57\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:57: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:61\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:61: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:65\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:65: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:69\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:69: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:73\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:73: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:77\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:77: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:81\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:81: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:85\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:85: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:89\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:89: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:93\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:93: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:97\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:97: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:101\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:101: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:105\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:105: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:109\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:109: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:113\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:113: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:117\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:117: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:121\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:121: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:125\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:125: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:129\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:129: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:133\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:133: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:137\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:137: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:141\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:141: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:145\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:145: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:149\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:149: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:153\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:153: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:157\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:157: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:161\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:161: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:165\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:165: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:169\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:169: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:173\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:173: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:177\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:177: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:181\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:181: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:185\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:185: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:189\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:189: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:193\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:193: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:197\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:197: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:201\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:201: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:205\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:205: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:209\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:209: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:213\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:213: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:217\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:217: DeprecationWarning: Call to deprecated create function EnumValueDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.EnumValueDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:27\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/types_pb2.py:27: DeprecationWarning: Call to deprecated create function EnumDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _DATATYPE = _descriptor.EnumDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:20\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:20: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:39\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:39: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:46\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:46: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:32\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:32: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _RESOURCEHANDLEPROTO_DTYPEANDSHAPE = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:76\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:76: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:83\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:83: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:90\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:90: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:97\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:97: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:104\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:104: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:111\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:111: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:69\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/resource_handle_pb2.py:69: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _RESOURCEHANDLEPROTO = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:21\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:21: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:40\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:40: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:47\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:47: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:54\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:54: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:61\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:61: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:68\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:68: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:75\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:75: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:82\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:82: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:89\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:89: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:96\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:96: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:103\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:103: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:110\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:110: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:117\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:117: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:124\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:124: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:131\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:131: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:138\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:138: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:145\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:145: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:152\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:152: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:33\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:33: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _TENSORPROTO = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:183\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:183: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:190\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:190: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:197\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:197: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:176\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/tensor_pb2.py:176: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _VARIANTTENSORDATAPROTO = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:21\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:21: DeprecationWarning: Call to deprecated create function FileDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    DESCRIPTOR = _descriptor.FileDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:40\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:40: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:47\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:47: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:54\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:54: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:61\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:61: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:68\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:68: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:75\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:75: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:82\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:82: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:89\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:89: DeprecationWarning: Call to deprecated create function FieldDescriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _descriptor.FieldDescriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:33\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/core/framework/attr_value_pb2.py:33: DeprecationWarning: Call to deprecated create function Descriptor(). Note: Create unlinked descriptors is going to go away. Please use get/find descriptors from generated code or query the descriptor_pool.\n    _ATTRVALUE_LISTVALUE = _descriptor.Descriptor(\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/framework/dtypes.py:205\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorflow/python/framework/dtypes.py:205: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)\n    np.bool8: (False, True),\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/flatbuffers/compat.py:19\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/flatbuffers/compat.py:19: DeprecationWarning: the imp module is deprecated in favour of importlib and slated for removal in Python 3.12; see the module's documentation for alternative uses\n    import imp\n\n../../../../../../../../opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:326\n  /opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:326: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)\n    np.bool8: (False, True),\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n================================ tests coverage ================================\n______________ coverage: platform darwin, python 3.10.19-final-0 _______________\n\nName                                                 Stmts   Miss Branch BrPart  Cover   Missing\n------------------------------------------------------------------------------------------------\ntests/test_tensorflow_python_ops_gen_linalg_ops.py     241      7     24      8    94%   47->50, 93, 103, 113, 117, 169, 240, 335\n------------------------------------------------------------------------------------------------\nTOTAL                                                  241      7     24      8    94%\nCoverage XML written to file coverage.xml\n=========================== short test summary info ============================\nFAILED tests/test_tensorflow_python_ops_gen_linalg_ops.py::test_qr_decomposition[float32-shape1-flags1-full_rank]\n1 failed, 11 passed, 103 warnings in 2.96s\n\nError: exit 1",
    "exit_code.txt": "1",
    "analysis_plan.json": "{\n  \"status\": \"未完全通过\",\n  \"passed\": 11,\n  \"failed\": 1,\n  \"errors\": 0,\n  \"collection_errors\": false,\n  \"block_limit\": 3,\n  \"failures\": [\n    {\n      \"test\": \"test_qr_decomposition[float32-shape1-flags1-full_rank]\",\n      \"block_id\": \"CASE_02\",\n      \"error_type\": \"RuntimeError\",\n      \"action\": \"adjust_assertion\",\n      \"note\": \"PyTorch QR函数不支持mode='full'参数，应使用'complete'替代\"\n    }\n  ],\n  \"deferred\": [],\n  \"stop_recommended\": false,\n  \"stop_reason\": \"\"\n}",
    "analysis.md": "## 测试结果分析\n\n### 状态与统计\n- **状态**: 未完全通过\n- **通过**: 11个测试\n- **失败**: 1个测试\n- **错误**: 0个\n- **覆盖率**: 94%\n\n### 待修复 BLOCK 列表 (1个)\n\n1. **BLOCK_ID**: CASE_02\n   - **测试**: test_qr_decomposition[float32-shape1-flags1-full_rank]\n   - **错误类型**: RuntimeError\n   - **修复动作**: adjust_assertion\n   - **原因**: PyTorch QR函数不支持mode='full'参数，应使用'complete'替代\n\n### 停止建议\n- **stop_recommended**: false\n- **stop_reason**: 无",
    "final_report.md": "# tensorflow.python.ops.gen_linalg_ops 测试报告\n\n## 1. 执行摘要\n测试基本通过（11/12），仅QR分解测试存在参数兼容性问题；核心线性代数操作（Cholesky、矩阵求逆）验证成功，但复数类型、GPU一致性、梯度计算等关键风险点尚未覆盖。\n\n**关键发现**：\n- QR分解测试因PyTorch API参数不兼容失败（mode='full' vs 'complete'）\n- 测试覆盖了主要API但未验证复数矩阵、梯度计算等高级功能\n- 94%覆盖率表明测试框架有效，但存在重要功能缺口\n\n## 2. 测试范围\n**目标FQN**: `tensorflow.python.ops.gen_linalg_ops`\n\n**测试环境**：\n- 框架：pytest\n- 依赖：TensorFlow Python包装器（mock底层C++执行）\n- 设备：CPU优先（GPU作为可选扩展）\n- 数值类型：float32/float64优先\n\n**覆盖场景**：\n- ✓ Cholesky分解对称正定矩阵验证\n- ✓ QR分解正交性验证（参数兼容性问题）\n- ✓ 矩阵求逆可逆性验证\n- ✓ SVD分解重构验证\n- ✓ 批量操作一致性验证\n\n**未覆盖项**：\n- ✗ 复数矩阵操作（complex64/complex128）\n- ✗ GPU-CPU结果一致性验证\n- ✗ 梯度计算正确性（前向/反向传播）\n- ✗ 病态矩阵数值稳定性\n- ✗ 文档缺失函数（如banded_triangular_solve）\n- ✗ 类型转换规则验证\n- ✗ 不可逆矩阵错误处理\n\n## 3. 结果概览\n**测试统计**：\n- 用例总数：12个（参数化测试）\n- 通过：11个（91.7%）\n- 失败：1个（8.3%）\n- 错误：0个\n- 覆盖率：94%\n\n**主要失败点**：\n1. **CASE_02**：QR分解测试失败\n   - 测试：`test_qr_decomposition[float32-shape1-flags1-full_rank]`\n   - 错误：RuntimeError\n   - 根因：PyTorch QR函数不支持mode='full'参数，应使用'complete'替代\n   - 影响：仅影响QR分解的full_matrices模式验证\n\n## 4. 详细发现\n\n### 高优先级问题（1个）\n**P1：QR分解API参数不兼容**\n- **描述**：测试中使用PyTorch QR函数验证TensorFlow QR结果，但参数命名不一致\n- **根因**：PyTorch使用mode='complete'，测试代码使用mode='full'\n- **影响**：QR分解的full_matrices模式验证失败\n- **建议修复**：\n  ```python\n  # 修复前\n  q_expected, r_expected = torch.linalg.qr(torch_input, mode='full')\n  # 修复后  \n  q_expected, r_expected = torch.linalg.qr(torch_input, mode='complete')\n  ```\n\n### 中优先级风险（8个）\n**P2：复数矩阵操作未验证**\n- **风险**：complex64/complex128类型支持未测试\n- **影响**：复数线性代数操作正确性未知\n- **建议**：添加复数矩阵测试用例\n\n**P3：梯度计算未验证**\n- **风险**：前向/反向传播正确性未测试\n- **影响**：训练过程中梯度计算可能出错\n- **建议**：添加梯度验证测试\n\n**P4：GPU-CPU一致性未验证**\n- **风险**：设备间结果差异未测试\n- **影响**：跨设备部署可能产生不一致结果\n- **建议**：添加设备一致性测试（如可用）\n\n**P5：病态矩阵数值稳定性**\n- **风险**：高条件数矩阵处理未测试\n- **影响**：数值精度可能不满足要求\n- **建议**：添加病态矩阵测试\n\n**P6：文档缺失函数未覆盖**\n- **风险**：banded_triangular_solve等函数未测试\n- **影响**：边缘功能正确性未知\n- **建议**：补充缺失函数测试\n\n**P7：类型转换规则未明确**\n- **风险**：隐式类型转换行为未测试\n- **影响**：类型不匹配时行为不可预测\n- **建议**：添加类型转换测试\n\n**P8：不可逆矩阵错误处理**\n- **风险**：奇异矩阵处理方式未定义\n- **影响**：错误处理行为不一致\n- **建议**：添加异常场景测试\n\n**P9：形状验证细节未覆盖**\n- **风险**：Python层形状验证规则未测试\n- **影响**：非法形状输入可能产生意外行为\n- **建议**：添加形状验证测试\n\n## 5. 覆盖与风险\n\n**需求覆盖评估**：\n- ✓ 核心线性代数操作验证（Cholesky、QR、SVD、求逆）\n- ✓ 批量操作支持验证\n- ✓ 基本数值类型（float32/float64）验证\n- ✗ 复数类型支持验证\n- ✗ 设备兼容性验证\n- ✗ 梯度计算验证\n- ✗ 错误处理场景验证\n\n**尚未覆盖的边界**：\n1. **数值边界**：NaN、Inf、极大/极小浮点数\n2. **形状边界**：空张量、零维张量、超大矩阵\n3. **类型边界**：不支持的数据类型（如int32）\n4. **条件边界**：奇异矩阵、非正定矩阵、病态矩阵\n5. **设备边界**：GPU特定行为、内存限制\n\n**缺失信息风险**：\n- 不可逆矩阵行为未定义（可能返回垃圾结果或异常）\n- 数值精度保证未详细说明\n- 部分函数文档缺失（TODO注释）\n- C++层错误传播机制依赖mock\n\n## 6. 后续动作\n\n### 立即修复（P1）\n1. **修复QR测试参数**：将mode='full'改为mode='complete'\n   - 责任人：测试开发\n   - 预计工时：0.5小时\n   - 验证：重新运行QR分解测试\n\n### 高优先级扩展（P2-P3）\n2. **添加复数矩阵测试**：覆盖complex64/complex128类型\n   - 责任人：测试开发\n   - 预计工时：4小时\n   - 产出：复数矩阵操作测试用例\n\n3. **添加梯度计算验证**：测试前向/反向传播正确性\n   - 责任人：测试开发\n   - 预计工时：6小时\n   - 产出：梯度验证测试套件\n\n### 中优先级扩展（P4-P6）\n4. **添加设备一致性测试**：验证GPU-CPU结果一致性\n   - 责任人：测试开发（需GPU环境）\n   - 预计工时：4小时\n   - 产出：设备一致性测试报告\n\n5. **添加病态矩阵测试**：验证数值稳定性边界\n   - 责任人：测试开发\n   - 预计工时：3小时\n   - 产出：数值稳定性测试用例\n\n6. **补充缺失函数测试**：覆盖banded_triangular_solve等文档缺失函数\n   - 责任人：测试开发\n   - 预计工时：2小时\n   - 产出：边缘函数测试覆盖\n\n### 低优先级完善（P7-P9）\n7. **添加类型转换测试**：验证隐式类型转换行为\n   - 责任人：测试开发\n   - 预计工时：2小时\n   - 产出：类型转换测试矩阵\n\n8. **添加异常场景测试**：覆盖不可逆矩阵、非法输入等场景\n   - 责任人：测试开发\n   - 预计工时：3小时\n   - 产出：错误处理测试套件\n\n9. **添加形状验证测试**：验证Python层形状约束\n   - 责任人：测试开发\n   - 预计工时：2小时\n   - 产出：形状验证测试用例\n\n### 环境调整建议\n10. **GPU测试环境准备**：配置CUDA环境用于设备一致性测试\n    - 责任人：运维/测试\n    - 预计工时：2小时\n    - 产出：可用的GPU测试环境\n\n11. **覆盖率提升目标**：从94%提升至98%+\n    - 责任人：测试开发\n    - 预计工时：8小时\n    - 产出：覆盖率报告\n\n**总计预计工时**：36.5小时\n**优先级排序**：P1 > P2 > P3 > P4 > P5 > P6 > P7 > P8 > P9 > 环境调整\n\n---\n**报告生成时间**：2024年\n**测试状态**：基本通过，需修复1个失败用例\n**风险评估**：中等（核心功能验证通过，但高级功能未覆盖）\n**建议行动**：立即修复QR测试，按优先级扩展测试覆盖"
  },
  "stage_history": [
    {
      "stage": "understand_function",
      "status": "completed",
      "timestamp": "2026-01-24T14:30:29.678979",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "generate_requirements",
      "status": "completed",
      "timestamp": "2026-01-24T14:31:06.969458",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "design_test_plan",
      "status": "completed",
      "timestamp": "2026-01-24T14:32:58.976874",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-24T14:36:49.583224",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-24T14:36:55.394777",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-24T14:38:28.429473",
      "attempts": 1,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-24T14:42:03.037600",
      "attempts": 2,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-24T14:42:07.327274",
      "attempts": 2,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-24T14:43:47.826724",
      "attempts": 2,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-24T14:47:07.776796",
      "attempts": 3,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-24T14:47:12.629048",
      "attempts": 3,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-24T14:48:28.029811",
      "attempts": 3,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-24T14:54:15.808908",
      "attempts": 4,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-24T14:54:20.017715",
      "attempts": 4,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-24T14:55:26.669683",
      "attempts": 4,
      "error": null
    },
    {
      "stage": "generate_code",
      "status": "completed",
      "timestamp": "2026-01-24T14:58:32.320627",
      "attempts": 5,
      "error": null
    },
    {
      "stage": "execute_tests",
      "status": "completed",
      "timestamp": "2026-01-24T14:58:36.135811",
      "attempts": 5,
      "error": null
    },
    {
      "stage": "analyze_results",
      "status": "completed",
      "timestamp": "2026-01-24T14:59:48.608953",
      "attempts": 5,
      "error": null
    },
    {
      "stage": "generate_report",
      "status": "completed",
      "timestamp": "2026-01-24T15:01:13.292160",
      "attempts": 1,
      "error": null
    }
  ],
  "user_feedback": []
}