=== Run Tests ===
F.FFF                                                                    [100%]
================================== FAILURES ===================================
____________________ test_fixed_len_feature_basic_parsing _____________________

    def test_fixed_len_feature_basic_parsing():
        """Test basic parsing with FixedLenFeature (TC-01)."""
        # Create test data
        dataset_size = 10
        serialized_examples = []
    
        for i in range(dataset_size):
            example = create_example_proto({
                'feature1': float(i),
                'feature2': i * 2,
                'feature3': f'string_{i}'.encode('utf-8')
            })
            serialized_examples.append(example)
    
        # Create dataset - 字符串向量，shape=[None]
        dataset = create_string_dataset(serialized_examples)
    
        # 验证输入数据集是字符串向量
        element_spec = dataset.element_spec
        assert isinstance(element_spec, tf.TensorSpec), "输入数据集应该是TensorSpec"
        assert element_spec.dtype == tf.string, "输入数据集应该是字符串类型"
>       assert element_spec.shape.as_list() == [None], "输入数据集应该是字符串向量(shape=[None])"
E       AssertionError: 输入数据集应该是字符串向量(shape=[None])
E       assert [] == [None]
E         
E         Right contains one more item: None
E         Use -v to get more diff

tests\test_tensorflow_python_data_experimental_ops_parsing_ops_g1.py:86: AssertionError
---------------------------- Captured stderr call -----------------------------
2026-01-18 18:56:35.106885: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
__________ test_features_parameter_validation[features1-ValueError] ___________

features = {}, expected_error = <class 'ValueError'>

    @pytest.mark.parametrize("features,expected_error", [
        (None, ValueError),
        ({}, ValueError)
    ])
    def test_features_parameter_validation(features, expected_error):
        """Test features parameter validation (TC-02)."""
        # Create a simple dataset for testing
        serialized_example = create_example_proto({'test': 1.0})
        dataset = create_string_dataset([serialized_example])
    
        with pytest.raises(expected_error) as exc_info:
            parse_fn = parsing_ops.parse_example_dataset(
                features=features,
                num_parallel_calls=1
            )
            # Try to apply the transformation
>           dataset.apply(parse_fn)

tests\test_tensorflow_python_data_experimental_ops_parsing_ops_g1.py:173: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py:2238: in apply
    dataset = transformation_func(self)
D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\data\experimental\ops\parsing_ops.py:146: in _apply_fn
    out_dataset = _ParseExampleDataset(dataset, features, num_parallel_calls,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <[AttributeError("'_ParseExampleDataset' object has no attribute '_element_spec'") raised in repr()] _ParseExampleDataset object at 0x214e88082b0>
input_dataset = <TensorSliceDataset element_spec=TensorSpec(shape=(), dtype=tf.string, name=None)>
features = {}, num_parallel_calls = 1, deterministic = None

    def __init__(self, input_dataset, features, num_parallel_calls,
                 deterministic):
      self._input_dataset = input_dataset
      if not structure.are_compatible(
          input_dataset.element_spec,
          tensor_spec.TensorSpec([None], dtypes.string)):
>       raise TypeError("Input dataset should be a dataset of vectors of "
                        f"strings. Instead it is `{input_dataset.element_spec}`.")
E       TypeError: Input dataset should be a dataset of vectors of strings. Instead it is `TensorSpec(shape=(), dtype=tf.string, name=None)`.

D:\Coding\Anaconda\envs\testagent-experiment\lib\site-packages\tensorflow\python\data\experimental\ops\parsing_ops.py:36: TypeError
_____________________ test_parallel_parsing_functionality _____________________

thing = <module 'tensorflow' from 'D:\\Coding\\Anaconda\\envs\\testagent-experiment\\lib\\site-packages\\tensorflow\\__init__.py'>
comp = 'python', import_path = 'tensorflow.python'

    def _dot_lookup(thing, comp, import_path):
        try:
>           return getattr(thing, comp)
E           AttributeError: module 'tensorflow' has no attribute 'python'

D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1226: AttributeError

During handling of the above exception, another exception occurred:

args = (), keywargs = {}

    @wraps(func)
    def patched(*args, **keywargs):
>       with self.decoration_helper(patched,
                                    args,
                                    keywargs) as (newargs, newkeywargs):

D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1333: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Coding\Anaconda\envs\testagent-experiment\lib\contextlib.py:119: in __enter__
    return next(self.gen)
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1315: in decoration_helper
    arg = exit_stack.enter_context(patching)
D:\Coding\Anaconda\envs\testagent-experiment\lib\contextlib.py:448: in enter_context
    result = _cm_type.__enter__(cm)
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1388: in __enter__
    self.target = self.getter()
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1563: in <lambda>
    getter = lambda: _importer(target)
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1239: in _importer
    thing = _dot_lookup(thing, comp, import_path)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

thing = <module 'tensorflow' from 'D:\\Coding\\Anaconda\\envs\\testagent-experiment\\lib\\site-packages\\tensorflow\\__init__.py'>
comp = 'python', import_path = 'tensorflow.python'

    def _dot_lookup(thing, comp, import_path):
        try:
            return getattr(thing, comp)
        except AttributeError:
            __import__(import_path)
>           return getattr(thing, comp)
E           AttributeError: module 'tensorflow' has no attribute 'python'

D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1229: AttributeError
_____________________ test_multiple_feature_types_support _____________________

thing = <module 'tensorflow' from 'D:\\Coding\\Anaconda\\envs\\testagent-experiment\\lib\\site-packages\\tensorflow\\__init__.py'>
comp = 'python', import_path = 'tensorflow.python'

    def _dot_lookup(thing, comp, import_path):
        try:
>           return getattr(thing, comp)
E           AttributeError: module 'tensorflow' has no attribute 'python'

D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1226: AttributeError

During handling of the above exception, another exception occurred:

args = (), keywargs = {}

    @wraps(func)
    def patched(*args, **keywargs):
>       with self.decoration_helper(patched,
                                    args,
                                    keywargs) as (newargs, newkeywargs):

D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1333: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Coding\Anaconda\envs\testagent-experiment\lib\contextlib.py:119: in __enter__
    return next(self.gen)
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1315: in decoration_helper
    arg = exit_stack.enter_context(patching)
D:\Coding\Anaconda\envs\testagent-experiment\lib\contextlib.py:448: in enter_context
    result = _cm_type.__enter__(cm)
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1388: in __enter__
    self.target = self.getter()
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1563: in <lambda>
    getter = lambda: _importer(target)
D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1239: in _importer
    thing = _dot_lookup(thing, comp, import_path)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

thing = <module 'tensorflow' from 'D:\\Coding\\Anaconda\\envs\\testagent-experiment\\lib\\site-packages\\tensorflow\\__init__.py'>
comp = 'python', import_path = 'tensorflow.python'

    def _dot_lookup(thing, comp, import_path):
        try:
            return getattr(thing, comp)
        except AttributeError:
            __import__(import_path)
>           return getattr(thing, comp)
E           AttributeError: module 'tensorflow' has no attribute 'python'

D:\Coding\Anaconda\envs\testagent-experiment\lib\unittest\mock.py:1229: AttributeError

---------- coverage: platform win32, python 3.9.25-final-0 -----------
Name                                                                   Stmts   Miss Branch BrPart  Cover   Missing
------------------------------------------------------------------------------------------------------------------
tests\test_tensorflow_python_data_experimental_ops_parsing_ops_g1.py     219    169     58      5    23%   27, 29-38, 46, 52-61, 89-153, 180-182, 193-280, 294-403, 427-464
------------------------------------------------------------------------------------------------------------------
TOTAL                                                                    219    169     58      5    23%
Coverage XML written to file coverage.xml

=========================== short test summary info ===========================
FAILED tests\test_tensorflow_python_data_experimental_ops_parsing_ops_g1.py::test_fixed_len_feature_basic_parsing
FAILED tests\test_tensorflow_python_data_experimental_ops_parsing_ops_g1.py::test_features_parameter_validation[features1-ValueError]
FAILED tests\test_tensorflow_python_data_experimental_ops_parsing_ops_g1.py::test_parallel_parsing_functionality
FAILED tests\test_tensorflow_python_data_experimental_ops_parsing_ops_g1.py::test_multiple_feature_types_support
4 failed, 1 passed in 1.85s

Error: exit 1