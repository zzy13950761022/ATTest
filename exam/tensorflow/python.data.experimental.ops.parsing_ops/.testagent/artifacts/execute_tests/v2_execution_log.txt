=== Run Tests ===
F                                                                        [100%]
================================== FAILURES ===================================
_ TestParsingOpsG2.test_multiple_feature_types_support[feature_types0-dtype_combinations0-False-15] _

self = <test_tensorflow_python_data_experimental_ops_parsing_ops_g2.TestParsingOpsG2 object at 0x0000024BF1B57BB0>
create_string_vector_dataset = <function TestParsingOpsG2.create_string_vector_dataset.<locals>._create_dataset at 0x0000024BF1B609D0>
feature_types = ['FixedLenFeature', 'VarLenFeature']
dtype_combinations = ['float32', 'int64'], deterministic = False
dataset_size = 15

    @pytest.mark.parametrize("feature_types,dtype_combinations,deterministic,dataset_size", [
        (["FixedLenFeature", "VarLenFeature"], ["float32", "int64"], False, 15)
    ])
    def test_multiple_feature_types_support(self, create_string_vector_dataset,
                                           feature_types, dtype_combinations,
                                           deterministic, dataset_size):
        """测试多种特征类型支持 (TC-05)
    
        验证parse_example_dataset能够正确处理FixedLenFeature和VarLenFeature的组合。
        """
        # 创建特征规格字典
        features = {}
    
        # 添加FixedLenFeature
        if "FixedLenFeature" in feature_types:
            if "float32" in dtype_combinations:
                features["fixed_float"] = tf.io.FixedLenFeature([], tf.float32)
            if "int64" in dtype_combinations:
                features["fixed_int"] = tf.io.FixedLenFeature([], tf.int64)
    
        # 添加VarLenFeature
        if "VarLenFeature" in feature_types:
            if "float32" in dtype_combinations:
                features["var_float"] = tf.io.VarLenFeature(tf.float32)
            if "int64" in dtype_combinations:
                features["var_int"] = tf.io.VarLenFeature(tf.int64)
    
        # 创建测试数据集
        dataset = create_string_vector_dataset(dataset_size, features)
    
        # 应用parse_example_dataset转换
        parse_fn = parsing_ops.parse_example_dataset(
            features=features,
            num_parallel_calls=2,
            deterministic=deterministic
        )
    
        # 验证转换返回一个函数
        assert callable(parse_fn), "parse_example_dataset应该返回一个可调用函数"
    
        # 应用转换
        parsed_dataset = dataset.apply(parse_fn)
    
        # 验证输出数据集结构
        element_spec = parsed_dataset.element_spec
        assert isinstance(element_spec, dict), "输出element_spec应该是一个字典"
    
        # 检查所有特征都存在
        expected_keys = set(features.keys())
        assert set(element_spec.keys()) == expected_keys, \
            f"期望特征键: {expected_keys}, 实际: {set(element_spec.keys())}"
    
        # 验证每种特征类型的张量规格
        for key, feature in features.items():
            spec = element_spec[key]
    
            if isinstance(feature, tf.io.FixedLenFeature):
                # FixedLenFeature应该产生TensorSpec
                assert isinstance(spec, tf.TensorSpec), \
                    f"特征'{key}'应该是TensorSpec，实际是{type(spec)}"
                assert spec.dtype == feature.dtype, \
                    f"特征'{key}'的数据类型不匹配: 期望{feature.dtype}, 实际{spec.dtype}"
>               assert spec.shape.as_list() == list(feature.shape), \
                    f"特征'{key}'的形状不匹配: 期望{feature.shape}, 实际{spec.shape}"
E               AssertionError: 特征'fixed_float'的形状不匹配: 期望[], 实际(None,)
E               assert [None] == []
E                 
E                 Left contains one more item: None
E                 Use -v to get more diff

tests\test_tensorflow_python_data_experimental_ops_parsing_ops_g2.py:128: AssertionError
---------------------------- Captured stderr call -----------------------------
2026-01-18 18:51:16.617928: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.

---------- coverage: platform win32, python 3.9.25-final-0 -----------
Name                                                                   Stmts   Miss Branch BrPart  Cover   Missing
------------------------------------------------------------------------------------------------------------------
tests\test_tensorflow_python_data_experimental_ops_parsing_ops_g2.py     113     53     60     12    47%   46-47, 48->40, 51->40, 80->87, 81->83, 83->87, 87->94, 88->90, 90->94, 131-218, 240-269
------------------------------------------------------------------------------------------------------------------
TOTAL                                                                    113     53     60     12    47%
Coverage XML written to file coverage.xml

=========================== short test summary info ===========================
FAILED tests\test_tensorflow_python_data_experimental_ops_parsing_ops_g2.py::TestParsingOpsG2::test_multiple_feature_types_support[feature_types0-dtype_combinations0-False-15]
1 failed in 1.55s

Error: exit 1