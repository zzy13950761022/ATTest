{
  "plan_version": 2,
  "target": "tensorflow.python.ops.map_fn",
  "block_rules": {
    "header_block": "HEADER",
    "footer_block": "FOOTER",
    "case_prefix": "CASE_",
    "case_format": "CASE_01"
  },
  "iteration_strategy": {
    "round1": {
      "include": "SMOKE_SET",
      "assert_level": "weak",
      "max_blocks": 5
    },
    "roundN": {
      "only_fix_failed_blocks": true,
      "block_limit": 3,
      "promote_deferred": true
    },
    "final": {
      "enable_strong_asserts": true,
      "coverage_optional": true
    }
  },
  "test_files": {
    "default": "tests/test_tensorflow_python_ops_map_fn.py",
    "all_pattern": "tests/test_tensorflow_python_ops_map_fn.py"
  },
  "cases": [
    {
      "tc_id": "TC-01",
      "block_id": "CASE_01",
      "name": "基本单张量映射",
      "priority": "High",
      "param_matrix": [
        {
          "fn_type": "lambda",
          "elems_type": "tensor",
          "dtype": "float32",
          "shape": [3, 4, 5],
          "fn_output_signature": null,
          "parallel_iterations": null,
          "back_prop": true,
          "swap_memory": false,
          "infer_shape": true,
          "name": null
        }
      ],
      "asserts": {
        "weak": ["shape_match", "dtype_match", "basic_functionality"],
        "strong": ["exact_values", "gradient_check", "performance_bounds"]
      },
      "oracle": "manual_loop_implementation",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 70,
      "max_params": 8,
      "is_parametrized": true,
      "requires_mock": false,
      "mock_targets": []
    },
    {
      "tc_id": "TC-02",
      "block_id": "CASE_02",
      "name": "嵌套张量输入",
      "priority": "High",
      "param_matrix": [
        {
          "fn_type": "lambda_multi",
          "elems_type": "nested_tensors",
          "dtype": "int32",
          "shape": [2, 3],
          "fn_output_signature": "tf.int32",
          "parallel_iterations": 10,
          "back_prop": true,
          "swap_memory": false,
          "infer_shape": true,
          "name": "test_map"
        }
      ],
      "asserts": {
        "weak": ["shape_match", "dtype_match", "nested_structure"],
        "strong": ["exact_values", "structure_integrity", "gradient_check"]
      },
      "oracle": "manual_nested_loop",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 75,
      "max_params": 8,
      "is_parametrized": true,
      "requires_mock": false,
      "mock_targets": []
    },
    {
      "tc_id": "TC-03",
      "block_id": "CASE_03",
      "name": "RaggedTensor输入处理",
      "priority": "High",
      "param_matrix": [
        {
          "fn_type": "reduce_sum",
          "elems_type": "ragged_tensor",
          "ragged_rank": 1,
          "fn_output_signature": "tf.int32",
          "parallel_iterations": null,
          "back_prop": false,
          "swap_memory": false,
          "infer_shape": true,
          "name": null
        }
      ],
      "asserts": {
        "weak": ["shape_match", "dtype_match", "ragged_structure"],
        "strong": ["exact_values", "ragged_integrity", "edge_cases"]
      },
      "oracle": "manual_ragged_loop",
      "assertion_level": "weak",
      "size": "M",
      "max_lines": 85,
      "max_params": 7,
      "is_parametrized": true,
      "requires_mock": true,
      "mock_targets": [
        "tensorflow.autograph",
        "tensorflow.control_flow_ops.while_loop",
        "tensorflow.nest"
      ]
    },
    {
      "tc_id": "TC-04",
      "block_id": "CASE_04",
      "name": "SparseTensor输入输出",
      "priority": "High",
      "param_matrix": [
        {
          "fn_type": "sparse_op",
          "elems_type": "sparse_tensor",
          "sparsity": 0.3,
          "fn_output_signature": "tf.SparseTensorSpec",
          "parallel_iterations": 1,
          "back_prop": true,
          "swap_memory": true,
          "infer_shape": false,
          "name": "sparse_map"
        }
      ],
      "asserts": {
        "weak": ["shape_match", "sparse_structure", "basic_functionality"],
        "strong": ["exact_values", "sparse_integrity", "gradient_check"]
      },
      "oracle": "manual_sparse_loop",
      "assertion_level": "weak",
      "size": "M",
      "max_lines": 90,
      "max_params": 8,
      "is_parametrized": true,
      "requires_mock": true,
      "mock_targets": [
        "tensorflow.autograph",
        "tensorflow.control_flow_ops.while_loop",
        "tensorflow.nest"
      ]
    },
    {
      "tc_id": "TC-05",
      "block_id": "CASE_05",
      "name": "fn签名不同必须指定输出签名",
      "priority": "High",
      "param_matrix": [
        {
          "fn_type": "type_changing",
          "elems_type": "tensor",
          "input_dtype": "float32",
          "output_dtype": "int32",
          "fn_output_signature": "tf.int32",
          "parallel_iterations": null,
          "back_prop": true,
          "swap_memory": false,
          "infer_shape": true,
          "name": null
        }
      ],
      "asserts": {
        "weak": ["shape_match", "dtype_match", "error_without_signature"],
        "strong": ["exact_values", "type_conversion", "error_handling"]
      },
      "oracle": "type_check_validation",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 65,
      "max_params": 7,
      "is_parametrized": true,
      "requires_mock": false,
      "mock_targets": []
    }
  ],
  "param_extensions": [
    {
      "base_block_id": "CASE_01",
      "priority": "Medium",
      "params": {
        "fn_type": "lambda",
        "elems_type": "tensor",
        "dtype": "float64",
        "shape": [5, 2, 3],
        "fn_output_signature": null,
        "parallel_iterations": 5,
        "back_prop": false,
        "swap_memory": true,
        "infer_shape": false,
        "name": "extended_test"
      },
      "note": "参数扩展：不同dtype、形状和参数组合"
    },
    {
      "base_block_id": "CASE_01",
      "priority": "Medium",
      "params": {
        "fn_type": "lambda",
        "elems_type": "tensor",
        "dtype": "int64",
        "shape": [1, 10],
        "fn_output_signature": null,
        "parallel_iterations": 1,
        "back_prop": true,
        "swap_memory": false,
        "infer_shape": true,
        "name": null
      },
      "note": "参数扩展：边界形状和eager模式"
    },
    {
      "base_block_id": "CASE_02",
      "priority": "Medium",
      "params": {
        "fn_type": "lambda_multi",
        "elems_type": "nested_tensors",
        "dtype": "float32",
        "shape": [4, 1],
        "fn_output_signature": "tf.float32",
        "parallel_iterations": null,
        "back_prop": true,
        "swap_memory": false,
        "infer_shape": true,
        "name": null
      },
      "note": "参数扩展：不同dtype和形状的嵌套结构"
    },
    {
      "base_block_id": "CASE_03",
      "priority": "Medium",
      "params": {
        "fn_type": "reduce_mean",
        "elems_type": "ragged_tensor",
        "ragged_rank": 2,
        "fn_output_signature": "tf.float32",
        "parallel_iterations": 10,
        "back_prop": true,
        "swap_memory": false,
        "infer_shape": true,
        "name": "ragged_test"
      },
      "note": "参数扩展：不同ragged_rank和操作"
    }
  ],
  "smoke_set": ["CASE_01", "CASE_02", "CASE_05"],
  "deferred_set": ["CASE_03", "CASE_04"]
}