=== Run Tests ===
...FFF                                                                   [100%]
================================== FAILURES ===================================
_ TestTypeConversionAndSpecialTypes.test_as_dtype_numpy_conversion[np.float32-float32] _

self = <test_tensorflow_python_framework_dtypes_g2.TestTypeConversionAndSpecialTypes object at 0x000002A02244D790>
numpy_type_str = 'np.float32', expected_name = 'float32'

    @pytest.mark.parametrize(
        "numpy_type_str,expected_name",
        [
            ("np.float32", "float32"),
            ("np.int64", "int64"),
            ("np.bool_", "bool"),
        ]
    )
    def test_as_dtype_numpy_conversion(self, numpy_type_str, expected_name):
        """测试as_dtype函数对NumPy dtype对象的转换功能
    
        验证as_dtype能够正确地将NumPy dtype对象转换为对应的TensorFlow DType对象。
    
        Args:
            numpy_type_str: NumPy类型字符串（用于eval）
            expected_name: 期望的DType名称
        """
        # 解析NumPy类型
        numpy_type = eval(numpy_type_str, {"np": np})
    
        # 执行转换
        result = dtypes.as_dtype(numpy_type)
    
        # 验证转换成功
        assert result is not None, f"as_dtype({numpy_type_str}) should return a DType object"
        assert isinstance(result, dtypes.DType), f"Result should be a DType instance, got {type(result)}"
    
        # 验证类型名称匹配
        assert result.name == expected_name, (
            f"Expected dtype name '{expected_name}', got '{result.name}'"
        )
    
        # 验证类型枚举值有效
        assert hasattr(result, '_type_enum'), "DType should have _type_enum attribute"
        assert result._type_enum > 0, f"Invalid type enum value: {result._type_enum}"
    
        # 验证可以转换为numpy dtype（应该与输入匹配）
        result_numpy_dtype = result.as_numpy_dtype
        assert result_numpy_dtype == numpy_type, (
            f"as_numpy_dtype should return {numpy_type}, got {result_numpy_dtype}"
        )
    
        # 验证字符串表示
        str_repr = str(result)
        assert expected_name in str_repr, f"String representation should contain '{expected_name}', got '{str_repr}'"
    
        # 验证类型一致性：通过as_dtype转换的结果应该与直接访问常量相同
        if hasattr(dtypes, expected_name):
            direct_dtype = getattr(dtypes, expected_name)
            assert result == direct_dtype, (
                f"as_dtype({numpy_type_str}) should equal dtypes.{expected_name}"
            )
    
        # 验证往返一致性：将结果再次传递给as_dtype应该返回相同的对象
        result_again = dtypes.as_dtype(result)
        assert result_again is result, "as_dtype should return interned DType objects"
    
        # 验证基本属性
        assert hasattr(result, 'size'), "DType should have size attribute"
        assert result.size > 0, f"Invalid size: {result.size}"
    
        # 验证NumPy dtype属性
>       assert isinstance(numpy_type, np.dtype), f"Input should be numpy dtype, got {type(numpy_type)}"
E       AssertionError: Input should be numpy dtype, got <class 'type'>
E       assert False
E        +  where False = isinstance(<class 'numpy.float32'>, <class 'numpy.dtype'>)
E        +    where <class 'numpy.dtype'> = np.dtype

tests\test_tensorflow_python_framework_dtypes_g2.py:153: AssertionError
_ TestTypeConversionAndSpecialTypes.test_as_dtype_numpy_conversion[np.int64-int64] _

self = <test_tensorflow_python_framework_dtypes_g2.TestTypeConversionAndSpecialTypes object at 0x000002A02244D8B0>
numpy_type_str = 'np.int64', expected_name = 'int64'

    @pytest.mark.parametrize(
        "numpy_type_str,expected_name",
        [
            ("np.float32", "float32"),
            ("np.int64", "int64"),
            ("np.bool_", "bool"),
        ]
    )
    def test_as_dtype_numpy_conversion(self, numpy_type_str, expected_name):
        """测试as_dtype函数对NumPy dtype对象的转换功能
    
        验证as_dtype能够正确地将NumPy dtype对象转换为对应的TensorFlow DType对象。
    
        Args:
            numpy_type_str: NumPy类型字符串（用于eval）
            expected_name: 期望的DType名称
        """
        # 解析NumPy类型
        numpy_type = eval(numpy_type_str, {"np": np})
    
        # 执行转换
        result = dtypes.as_dtype(numpy_type)
    
        # 验证转换成功
        assert result is not None, f"as_dtype({numpy_type_str}) should return a DType object"
        assert isinstance(result, dtypes.DType), f"Result should be a DType instance, got {type(result)}"
    
        # 验证类型名称匹配
        assert result.name == expected_name, (
            f"Expected dtype name '{expected_name}', got '{result.name}'"
        )
    
        # 验证类型枚举值有效
        assert hasattr(result, '_type_enum'), "DType should have _type_enum attribute"
        assert result._type_enum > 0, f"Invalid type enum value: {result._type_enum}"
    
        # 验证可以转换为numpy dtype（应该与输入匹配）
        result_numpy_dtype = result.as_numpy_dtype
        assert result_numpy_dtype == numpy_type, (
            f"as_numpy_dtype should return {numpy_type}, got {result_numpy_dtype}"
        )
    
        # 验证字符串表示
        str_repr = str(result)
        assert expected_name in str_repr, f"String representation should contain '{expected_name}', got '{str_repr}'"
    
        # 验证类型一致性：通过as_dtype转换的结果应该与直接访问常量相同
        if hasattr(dtypes, expected_name):
            direct_dtype = getattr(dtypes, expected_name)
            assert result == direct_dtype, (
                f"as_dtype({numpy_type_str}) should equal dtypes.{expected_name}"
            )
    
        # 验证往返一致性：将结果再次传递给as_dtype应该返回相同的对象
        result_again = dtypes.as_dtype(result)
        assert result_again is result, "as_dtype should return interned DType objects"
    
        # 验证基本属性
        assert hasattr(result, 'size'), "DType should have size attribute"
        assert result.size > 0, f"Invalid size: {result.size}"
    
        # 验证NumPy dtype属性
>       assert isinstance(numpy_type, np.dtype), f"Input should be numpy dtype, got {type(numpy_type)}"
E       AssertionError: Input should be numpy dtype, got <class 'type'>
E       assert False
E        +  where False = isinstance(<class 'numpy.int64'>, <class 'numpy.dtype'>)
E        +    where <class 'numpy.dtype'> = np.dtype

tests\test_tensorflow_python_framework_dtypes_g2.py:153: AssertionError
_ TestTypeConversionAndSpecialTypes.test_as_dtype_numpy_conversion[np.bool_-bool] _

self = <test_tensorflow_python_framework_dtypes_g2.TestTypeConversionAndSpecialTypes object at 0x000002A02244DA90>
numpy_type_str = 'np.bool_', expected_name = 'bool'

    @pytest.mark.parametrize(
        "numpy_type_str,expected_name",
        [
            ("np.float32", "float32"),
            ("np.int64", "int64"),
            ("np.bool_", "bool"),
        ]
    )
    def test_as_dtype_numpy_conversion(self, numpy_type_str, expected_name):
        """测试as_dtype函数对NumPy dtype对象的转换功能
    
        验证as_dtype能够正确地将NumPy dtype对象转换为对应的TensorFlow DType对象。
    
        Args:
            numpy_type_str: NumPy类型字符串（用于eval）
            expected_name: 期望的DType名称
        """
        # 解析NumPy类型
        numpy_type = eval(numpy_type_str, {"np": np})
    
        # 执行转换
        result = dtypes.as_dtype(numpy_type)
    
        # 验证转换成功
        assert result is not None, f"as_dtype({numpy_type_str}) should return a DType object"
        assert isinstance(result, dtypes.DType), f"Result should be a DType instance, got {type(result)}"
    
        # 验证类型名称匹配
        assert result.name == expected_name, (
            f"Expected dtype name '{expected_name}', got '{result.name}'"
        )
    
        # 验证类型枚举值有效
        assert hasattr(result, '_type_enum'), "DType should have _type_enum attribute"
        assert result._type_enum > 0, f"Invalid type enum value: {result._type_enum}"
    
        # 验证可以转换为numpy dtype（应该与输入匹配）
        result_numpy_dtype = result.as_numpy_dtype
        assert result_numpy_dtype == numpy_type, (
            f"as_numpy_dtype should return {numpy_type}, got {result_numpy_dtype}"
        )
    
        # 验证字符串表示
        str_repr = str(result)
        assert expected_name in str_repr, f"String representation should contain '{expected_name}', got '{str_repr}'"
    
        # 验证类型一致性：通过as_dtype转换的结果应该与直接访问常量相同
        if hasattr(dtypes, expected_name):
            direct_dtype = getattr(dtypes, expected_name)
            assert result == direct_dtype, (
                f"as_dtype({numpy_type_str}) should equal dtypes.{expected_name}"
            )
    
        # 验证往返一致性：将结果再次传递给as_dtype应该返回相同的对象
        result_again = dtypes.as_dtype(result)
        assert result_again is result, "as_dtype should return interned DType objects"
    
        # 验证基本属性
        assert hasattr(result, 'size'), "DType should have size attribute"
        assert result.size > 0, f"Invalid size: {result.size}"
    
        # 验证NumPy dtype属性
>       assert isinstance(numpy_type, np.dtype), f"Input should be numpy dtype, got {type(numpy_type)}"
E       AssertionError: Input should be numpy dtype, got <class 'type'>
E       assert False
E        +  where False = isinstance(<class 'numpy.bool_'>, <class 'numpy.dtype'>)
E        +    where <class 'numpy.dtype'> = np.dtype

tests\test_tensorflow_python_framework_dtypes_g2.py:153: AssertionError

---------- coverage: platform win32, python 3.9.25-final-0 -----------
Name                                                  Stmts   Miss Branch BrPart  Cover   Missing
-------------------------------------------------------------------------------------------------
tests\test_tensorflow_python_framework_dtypes_g2.py      73     16     18      4    71%   67->74, 86->exit, 138->145, 156-176, 192
-------------------------------------------------------------------------------------------------
TOTAL                                                    73     16     18      4    71%
Coverage XML written to file coverage.xml

=========================== short test summary info ===========================
FAILED tests\test_tensorflow_python_framework_dtypes_g2.py::TestTypeConversionAndSpecialTypes::test_as_dtype_numpy_conversion[np.float32-float32]
FAILED tests\test_tensorflow_python_framework_dtypes_g2.py::TestTypeConversionAndSpecialTypes::test_as_dtype_numpy_conversion[np.int64-int64]
FAILED tests\test_tensorflow_python_framework_dtypes_g2.py::TestTypeConversionAndSpecialTypes::test_as_dtype_numpy_conversion[np.bool_-bool]
3 failed, 3 passed in 1.60s

Error: exit 1