=== Run Tests ===
....ssssss.sss..............s...............xFF.x.........               [100%]
=================================== FAILURES ===================================
__________________________ test_parameter_exclusivity __________________________

    def test_parameter_exclusivity():
        """
        Test that size and scale_factor parameters are mutually exclusive.
    
        Verifies that:
        1. ValueError is raised when both size and scale_factor are specified
        2. Error message contains appropriate information
        """
        # Create input tensor
        input_shape = (1, 3, 4, 4)
        x = create_test_tensor(input_shape, dtype=torch.float32, device='cpu')
    
        # Test with Upsample class - should raise ValueError
        with pytest.raises(ValueError) as exc_info:
            # Both size and scale_factor specified - should raise ValueError
            upsample = nn.Upsample(
                size=[8, 8],
                scale_factor=2.0,
                mode='nearest'
            )
            # Try to use it (though initialization should fail)
            upsample(x)
    
        # Check error message - actual PyTorch error message is "only one of size or scale_factor should be defined"
        error_msg = str(exc_info.value).lower()
        assert "size" in error_msg or "scale_factor" in error_msg, (
            f"Error message should mention size or scale_factor: {error_msg}"
        )
        # Check for the actual PyTorch error message pattern
        assert "only one" in error_msg or "mutually exclusive" in error_msg, (
            f"Error message should indicate mutual exclusivity: {error_msg}"
        )
    
        # Also test with specialized classes
>       with pytest.raises(ValueError) as exc_info2:
E       Failed: DID NOT RAISE <class 'ValueError'>

tests/test_torch_nn_modules_upsampling_g3.py:89: Failed
_________________________ test_invalid_mode_parameter __________________________

    def test_invalid_mode_parameter():
        """
        Test that invalid mode parameter raises appropriate error.
    
        Verifies that:
        1. Error is raised when invalid mode is specified
        2. Error message contains appropriate information
    
        Note: PyTorch raises NotImplementedError for invalid mode, not ValueError
        """
        # Create input tensor
        input_shape = (1, 3, 4, 4)
        x = create_test_tensor(input_shape, dtype=torch.float32, device='cpu')
    
        # Test with invalid mode - PyTorch raises NotImplementedError
        with pytest.raises(NotImplementedError) as exc_info:
            upsample = nn.Upsample(
                scale_factor=2.0,
                mode='invalid_mode'  # Invalid mode
            )
            # Try to use it - error occurs during forward pass
            upsample(x)
    
        # Check error message
        error_msg = str(exc_info.value).lower()
        assert "mode" in error_msg or "invalid_mode" in error_msg, (
            f"Error message should mention mode or invalid_mode: {error_msg}"
        )
>       assert "not supported" in error_msg or "unsupported" in error_msg, (
            f"Error message should indicate unsupported mode: {error_msg}"
        )
E       AssertionError: Error message should indicate unsupported mode: input error: only 3d, 4d and 5d input tensors supported (got 4d) for the modes: nearest | linear | bilinear | bicubic | trilinear | area | nearest-exact (got invalid_mode)
E       assert ('not supported' in 'input error: only 3d, 4d and 5d input tensors supported (got 4d) for the modes: nearest | linear | bilinear | bicubic | trilinear | area | nearest-exact (got invalid_mode)' or 'unsupported' in 'input error: only 3d, 4d and 5d input tensors supported (got 4d) for the modes: nearest | linear | bilinear | bicubic | trilinear | area | nearest-exact (got invalid_mode)')

tests/test_torch_nn_modules_upsampling_g3.py:139: AssertionError
================================ tests coverage ================================
______________ coverage: platform darwin, python 3.10.19-final-0 _______________

Name                                           Stmts   Miss Branch BrPart  Cover   Missing
------------------------------------------------------------------------------------------
cleanup.py                                         7      7      4      0     0%   1-15
run_test.py                                       12     12      4      0     0%   1-24
test_repr.py                                       9      9      0      0     0%   1-16
test_scale_factor_behavior.py                     32     32      0      0     0%   1-40
tests/test_torch_nn_modules_upsampling_g1.py     162     23     12      3    82%   158->161, 196, 204, 212, 220, 228, 236, 295-298, 306, 314, 322, 359-368, 372-373
tests/test_torch_nn_modules_upsampling_g2.py     226     28     34      5    83%   44-58, 226-234, 435->441, 454-457, 462-470, 608-609, 612
tests/test_torch_nn_modules_upsampling_g3.py     196     58     16      1    67%   22, 32-46, 92-106, 144-167, 287-328, 353, 364, 385, 489
------------------------------------------------------------------------------------------
TOTAL                                            644    169     70      9    70%
Coverage XML written to file coverage.xml
=========================== short test summary info ============================
FAILED tests/test_torch_nn_modules_upsampling_g3.py::test_parameter_exclusivity
FAILED tests/test_torch_nn_modules_upsampling_g3.py::test_invalid_mode_parameter
2 failed, 44 passed, 10 skipped, 2 xfailed in 0.92s

Error: exit 1