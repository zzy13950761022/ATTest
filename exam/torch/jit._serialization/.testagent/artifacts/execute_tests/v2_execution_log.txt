=== Run Tests ===
...F.....                                                                [100%]
=================================== FAILURES ===================================
____ test_file_object_interface[simple_script_module-file_object-cpu-None] _____

module_type = 'simple_script_module', file_type = 'file_object', device = 'cpu'
extra_files = None
simple_module = RecursiveScriptModule(
  original_name=SimpleModule
  (linear): RecursiveScriptModule(original_name=Linear)
  (relu): RecursiveScriptModule(original_name=ReLU)
)

    @pytest.mark.parametrize("module_type,file_type,device,extra_files", [
        ("simple_script_module", "file_object", "cpu", None),
    ])
    def test_file_object_interface(module_type, file_type, device, extra_files, simple_module):
        """
        TC-04: 文件对象接口
        测试使用文件对象（而非路径）进行序列化和反序列化。
        """
        # Setup
        if module_type == "simple_script_module":
            module = simple_module
        else:
            raise ValueError(f"Unknown module type: {module_type}")
    
        # Test 1: Save to file-like object with write/flush methods
        mock_file = Mock(spec=['write', 'flush'])
        buffer_content = None
    
        # 使用side_effect来捕获写入的数据，同时保持Mock对象的属性
        def mock_write_side_effect(data):
            nonlocal buffer_content
            buffer_content = data
            return len(data) if data else 0
    
        mock_file.write.side_effect = mock_write_side_effect
        mock_file.flush.return_value = None
    
        # Save to mock file object
        torch.jit.save(module, mock_file, _extra_files=extra_files)
    
        # Weak assertion: file_methods_called
        assert mock_file.write.called, "write method should be called"
>       assert mock_file.flush.called, "flush method should be called"
E       AssertionError: flush method should be called
E       assert False
E        +  where False = <Mock name='mock.flush' id='4787366416'>.called
E        +    where <Mock name='mock.flush' id='4787366416'> = <Mock id='4787371456'>.flush

tests/test_torch_jit_serialization.py:364: AssertionError
================================ tests coverage ================================
______________ coverage: platform darwin, python 3.10.19-final-0 _______________

Name                                    Stmts   Miss Branch BrPart  Cover   Missing
-----------------------------------------------------------------------------------
tests/test_torch_jit_serialization.py     329     79     52     13    74%   30, 49, 58, 71-95, 137, 147, 180->exit, 197, 267, 308, 327->exit, 344, 368-446, 462, 523, 543->exit, 586, 603, 660
-----------------------------------------------------------------------------------
TOTAL                                     329     79     52     13    74%
Coverage XML written to file coverage.xml
=========================== short test summary info ============================
FAILED tests/test_torch_jit_serialization.py::test_file_object_interface[simple_script_module-file_object-cpu-None]
1 failed, 8 passed in 0.84s

Error: exit 1