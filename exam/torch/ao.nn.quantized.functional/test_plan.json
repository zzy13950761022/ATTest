{
  "plan_version": 2,
  "target": "torch.ao.nn.quantized.functional",
  "block_rules": {
    "header_block": "HEADER",
    "footer_block": "FOOTER",
    "case_prefix": "CASE_",
    "case_format": "CASE_01"
  },
  "iteration_strategy": {
    "round1": {
      "include": "SMOKE_SET",
      "assert_level": "weak",
      "max_blocks": 5
    },
    "roundN": {
      "only_fix_failed_blocks": true,
      "block_limit": 3,
      "promote_deferred": true
    },
    "final": {
      "enable_strong_asserts": true,
      "coverage_optional": true
    }
  },
  "test_files": {
    "default": "tests/test_torch_ao_nn_quantized_functional.py",
    "all_pattern": "tests/test_torch_ao_nn_quantized_functional_*.py",
    "groups": {
      "G1": "tests/test_torch_ao_nn_quantized_functional_g1.py",
      "G2": "tests/test_torch_ao_nn_quantized_functional_g2.py",
      "G3": "tests/test_torch_ao_nn_quantized_functional_g3.py"
    }
  },
  "active_group_order": ["G1", "G2", "G3"],
  "groups": [
    {
      "group_id": "G1",
      "title": "核心卷积函数族",
      "entrypoints": ["conv1d", "conv2d", "conv3d"],
      "smoke_set": ["CASE_01", "CASE_02"],
      "deferred_set": ["CASE_03", "CASE_04"],
      "note": "测试量化卷积基本功能"
    },
    {
      "group_id": "G2",
      "title": "线性与池化函数族",
      "entrypoints": ["linear", "avg_pool2d", "max_pool2d"],
      "smoke_set": ["CASE_05"],
      "deferred_set": ["CASE_06", "CASE_07"],
      "note": "测试线性层和池化操作"
    },
    {
      "group_id": "G3",
      "title": "激活与归一化函数族",
      "entrypoints": ["relu", "hardtanh", "layer_norm"],
      "smoke_set": ["CASE_08"],
      "deferred_set": ["CASE_09", "CASE_10"],
      "note": "测试激活函数和归一化"
    }
  ],
  "cases": [
    {
      "tc_id": "TC-01",
      "block_id": "CASE_01",
      "group_id": "G1",
      "name": "conv2d基本量化操作",
      "priority": "High",
      "param_matrix": [
        {
          "input_shape": [1, 3, 5, 5],
          "weight_shape": [2, 3, 3, 3],
          "input_dtype": "torch.quint8",
          "weight_dtype": "torch.qint8",
          "bias": true,
          "scale": 1.0,
          "zero_point": 0,
          "stride": 1,
          "padding": 0,
          "dilation": 1,
          "groups": 1
        }
      ],
      "asserts": {
        "weak": ["output_is_quantized", "output_shape_correct", "output_dtype_correct", "no_nan_inf"],
        "strong": ["quant_params_match", "vs_float_conv_error", "bias_addition_correct"]
      },
      "oracle": "torch.nn.functional.conv2d",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 80,
      "max_params": 8,
      "is_parametrized": true,
      "requires_mock": false
    },
    {
      "tc_id": "TC-02",
      "block_id": "CASE_02",
      "group_id": "G1",
      "name": "conv2d量化参数传播",
      "priority": "High",
      "param_matrix": [
        {
          "input_shape": [2, 4, 6, 6],
          "weight_shape": [4, 4, 2, 2],
          "input_dtype": "torch.quint8",
          "weight_dtype": "torch.qint8",
          "bias": false,
          "scale": 0.5,
          "zero_point": 128,
          "stride": 2,
          "padding": 1,
          "dilation": 1,
          "groups": 1
        }
      ],
      "asserts": {
        "weak": ["output_is_quantized", "output_shape_correct", "scale_zero_point_match", "no_nan_inf"],
        "strong": ["quant_params_propagated", "vs_float_conv_error", "stride_padding_effect"]
      },
      "oracle": "manual_calculation",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 80,
      "max_params": 8,
      "is_parametrized": true,
      "requires_mock": false
    },
    {
      "tc_id": "TC-03",
      "block_id": "CASE_03",
      "group_id": "G1",
      "name": "conv1d基本功能",
      "priority": "Medium",
      "param_matrix": [
        {
          "input_shape": [1, 3, 10],
          "weight_shape": [2, 3, 3],
          "input_dtype": "torch.quint8",
          "weight_dtype": "torch.qint8",
          "bias": true,
          "scale": 1.0,
          "zero_point": 0,
          "stride": 1,
          "padding": 0,
          "dilation": 1,
          "groups": 1
        }
      ],
      "asserts": {
        "weak": ["output_is_quantized", "output_shape_correct", "output_dtype_correct", "no_nan_inf"],
        "strong": ["quant_params_match", "vs_float_conv1d_error", "bias_addition_correct"]
      },
      "oracle": "torch.nn.functional.conv1d",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 80,
      "max_params": 8,
      "is_parametrized": true,
      "requires_mock": false
    },
    {
      "tc_id": "TC-04",
      "block_id": "CASE_04",
      "group_id": "G1",
      "name": "conv3d基本功能",
      "priority": "Medium",
      "param_matrix": [
        {
          "input_shape": [1, 2, 4, 4, 4],
          "weight_shape": [2, 2, 2, 2, 2],
          "input_dtype": "torch.quint8",
          "weight_dtype": "torch.qint8",
          "bias": false,
          "scale": 1.0,
          "zero_point": 0,
          "stride": 1,
          "padding": 0,
          "dilation": 1,
          "groups": 1
        }
      ],
      "asserts": {
        "weak": ["output_is_quantized", "output_shape_correct", "output_dtype_correct", "no_nan_inf"],
        "strong": ["quant_params_match", "vs_float_conv3d_error", "3d_shape_correct"]
      },
      "oracle": "torch.nn.functional.conv3d",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 80,
      "max_params": 8,
      "is_parametrized": true,
      "requires_mock": false
    },
    {
      "tc_id": "TC-05",
      "block_id": "CASE_05",
      "group_id": "G2",
      "name": "linear基本量化操作",
      "priority": "High",
      "param_matrix": [
        {
          "input_shape": [2, 4],
          "weight_shape": [3, 4],
          "input_dtype": "torch.quint8",
          "weight_dtype": "torch.qint8",
          "bias": true,
          "scale": 1.0,
          "zero_point": 0
        }
      ],
      "asserts": {
        "weak": ["output_is_quantized", "output_shape_correct", "output_dtype_correct", "no_nan_inf"],
        "strong": ["quant_params_match", "vs_float_linear_error", "bias_addition_correct", "weight_packing_effect"]
      },
      "oracle": "torch.nn.functional.linear",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 80,
      "max_params": 6,
      "is_parametrized": true,
      "requires_mock": false
    },
    {
      "tc_id": "TC-06",
      "block_id": "CASE_06",
      "group_id": "G2",
      "name": "avg_pool2d量化操作",
      "priority": "Medium",
      "param_matrix": [
        {
          "input_shape": [1, 3, 6, 6],
          "input_dtype": "torch.quint8",
          "kernel_size": 2,
          "stride": 2,
          "padding": 0,
          "ceil_mode": false,
          "count_include_pad": true,
          "divisor_override": null,
          "scale": 1.0,
          "zero_point": 0
        }
      ],
      "asserts": {
        "weak": ["output_is_quantized", "output_shape_correct", "output_dtype_correct", "no_nan_inf"],
        "strong": ["quant_params_match", "vs_float_avg_pool2d_error", "pooling_effect_correct"]
      },
      "oracle": "torch.nn.functional.avg_pool2d",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 80,
      "max_params": 8,
      "is_parametrized": true,
      "requires_mock": false
    },
    {
      "tc_id": "TC-07",
      "block_id": "CASE_07",
      "group_id": "G2",
      "name": "max_pool2d量化操作",
      "priority": "Medium",
      "param_matrix": [
        {
          "input_shape": [1, 3, 6, 6],
          "input_dtype": "torch.quint8",
          "kernel_size": 2,
          "stride": 2,
          "padding": 0,
          "dilation": 1,
          "ceil_mode": false,
          "scale": 1.0,
          "zero_point": 0
        }
      ],
      "asserts": {
        "weak": ["output_is_quantized", "output_shape_correct", "output_dtype_correct", "no_nan_inf"],
        "strong": ["quant_params_match", "vs_float_max_pool2d_error", "pooling_effect_correct"]
      },
      "oracle": "torch.nn.functional.max_pool2d",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 80,
      "max_params": 8,
      "is_parametrized": true,
      "requires_mock": false
    },
    {
      "tc_id": "TC-08",
      "block_id": "CASE_08",
      "group_id": "G3",
      "name": "relu量化激活",
      "priority": "High",
      "param_matrix": [
        {
          "input_shape": [2, 3, 4, 4],
          "input_dtype": "torch.quint8",
          "scale": 1.0,
          "zero_point": 0,
          "inplace": false
        }
      ],
      "asserts": {
        "weak": ["output_is_quantized", "output_shape_correct", "output_dtype_correct", "no_nan_inf", "relu_effect_visible"],
        "strong": ["quant_params_match", "vs_float_relu_error", "relu_function_correct"]
      },
      "oracle": "torch.nn.functional.relu",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 80,
      "max_params": 5,
      "is_parametrized": true,
      "requires_mock": false
    },
    {
      "tc_id": "TC-09",
      "block_id": "CASE_09",
      "group_id": "G3",
      "name": "hardtanh量化激活",
      "priority": "Medium",
      "param_matrix": [
        {
          "input_shape": [2, 3],
          "input_dtype": "torch.quint8",
          "min_val": -1.0,
          "max_val": 1.0,
          "scale": 1.0,
          "zero_point": 0,
          "inplace": false
        }
      ],
      "asserts": {
        "weak": ["output_is_quantized", "output_shape_correct", "output_dtype_correct", "no_nan_inf", "clipping_effect_visible"],
        "strong": ["quant_params_match", "vs_float_hardtanh_error", "clipping_function_correct"]
      },
      "oracle": "torch.nn.functional.hardtanh",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 80,
      "max_params": 6,
      "is_parametrized": true,
      "requires_mock": false
    },
    {
      "tc_id": "TC-10",
      "block_id": "CASE_10",
      "group_id": "G3",
      "name": "layer_norm量化归一化",
      "priority": "Medium",
      "param_matrix": [
        {
          "input_shape": [2, 3, 4],
          "input_dtype": "torch.quint8",
          "normalized_shape": [3, 4],
          "weight": true,
          "bias": true,
          "eps": 1e-5,
          "scale": 1.0,
          "zero_point": 0
        }
      ],
      "asserts": {
        "weak": ["output_is_quantized", "output_shape_correct", "output_dtype_correct", "no_nan_inf", "normalization_effect_visible"],
        "strong": ["quant_params_match", "vs_float_layer_norm_error", "normalization_function_correct"]
      },
      "oracle": "torch.nn.functional.layer_norm",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 80,
      "max_params": 7,
      "is_parametrized": true,
      "requires_mock": false
    }
  ],
  "param_extensions": [
    {
      "base_block_id": "CASE_01",
      "priority": "Medium",
      "params": {
        "input_shape": [2, 6, 8, 8],
        "weight_shape": [4, 6, 3, 3],
        "input_dtype": "torch.quint8",
        "weight_dtype": "torch.qint8",
        "bias": false,
        "scale": 0.25,
        "zero_point": 64,
        "stride": 2,
        "padding": 1,
        "dilation": 2,
        "groups": 2
      },
      "note": "扩展测试：不同量化参数、dilation、groups"
    },
    {
      "base_block_id": "CASE_01",
      "priority": "Low",
      "params": {
        "input_shape": [1, 1, 3, 3],
        "weight_shape": [1, 1, 1, 1],
        "input_dtype": "torch.quint8",
        "weight_dtype": "torch.qint8",
        "bias": true,
        "scale": 0.1,
        "zero_point": 255,
        "stride": 1,
        "padding": 0,
        "dilation": 1,
        "groups": 1
      },
      "note": "边界测试：最小形状、极端量化参数"
    },
    {
      "base_block_id": "CASE_05",
      "priority": "Medium",
      "params": {
        "input_shape": [4, 8],
        "weight_shape": [6, 8],
        "input_dtype": "torch.quint8",
        "weight_dtype": "torch.qint8",
        "bias": false,
        "scale": 2.0,
        "zero_point": 127
      },
      "note": "扩展测试：不同batch size、量化参数"
    }
  ],
  "smoke_set": ["CASE_01", "CASE_02", "CASE_05", "CASE_08"],
  "deferred_set": ["CASE_03", "CASE_04", "CASE_06", "CASE_07", "CASE_09", "CASE_10"]
}