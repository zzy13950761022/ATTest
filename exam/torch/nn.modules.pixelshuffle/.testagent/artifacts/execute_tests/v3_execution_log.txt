=== Run Tests ===
..F......FF....                                                          [100%]
=================================== FAILURES ===================================
_________________ test_pixelshuffle_invalid_upscale_factor_g1 __________________

    def test_pixelshuffle_invalid_upscale_factor_g1():
        """Test PixelShuffle with invalid upscale factor (G1 group)"""
>       with pytest.raises(ValueError):
E       Failed: DID NOT RAISE <class 'ValueError'>

tests/test_torch_nn_modules_pixelshuffle_g1.py:191: Failed
_______________ test_pixelunshuffle_invalid_downscale_factor_g2 ________________

    def test_pixelunshuffle_invalid_downscale_factor_g2():
        """Test PixelUnshuffle with invalid downscale factor (G2 group)"""
        # Note: Based on actual testing, PixelUnshuffle does NOT raise ValueError
        # for invalid downscale factors during initialization. The error occurs
        # during forward pass when dimensions are not divisible.
    
        # Test with downscale_factor = 0 (should work but fail during forward)
        pixel_unshuffle_0 = PixelUnshuffle(0)
        input_tensor = torch.randn(1, 4, 8, 8)
        with pytest.raises(RuntimeError, match="downscale_factor must be greater than zero"):
>           pixel_unshuffle_0(input_tensor)

tests/test_torch_nn_modules_pixelshuffle_g2.py:239: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/nn/modules/module.py:1190: in _call_impl
    return forward_call(*input, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = PixelUnshuffle(downscale_factor=0)
input = tensor([[[[ 9.7329e-01, -1.0151e+00, -5.4192e-01, -4.4102e-01, -3.1362e-01,
           -1.2925e-01, -7.1496e-01, -4.75...[ 2.5403e-01, -1.7906e-01,  1.1993e+00, -4.2922e-01,  1.0103e+00,
            6.1104e-01,  1.2208e+00, -6.0764e-01]]]])

    def forward(self, input: Tensor) -> Tensor:
>       return F.pixel_unshuffle(input, self.downscale_factor)
E       RuntimeError: pixel_unshuffle expects a positive downscale_factor, but got 0

/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/nn/modules/pixelshuffle.py:104: RuntimeError

During handling of the above exception, another exception occurred:

    def test_pixelunshuffle_invalid_downscale_factor_g2():
        """Test PixelUnshuffle with invalid downscale factor (G2 group)"""
        # Note: Based on actual testing, PixelUnshuffle does NOT raise ValueError
        # for invalid downscale factors during initialization. The error occurs
        # during forward pass when dimensions are not divisible.
    
        # Test with downscale_factor = 0 (should work but fail during forward)
        pixel_unshuffle_0 = PixelUnshuffle(0)
        input_tensor = torch.randn(1, 4, 8, 8)
>       with pytest.raises(RuntimeError, match="downscale_factor must be greater than zero"):
E       AssertionError: Regex pattern did not match.
E         Expected regex: 'downscale_factor must be greater than zero'
E         Actual message: 'pixel_unshuffle expects a positive downscale_factor, but got 0'

tests/test_torch_nn_modules_pixelshuffle_g2.py:238: AssertionError
_______________ test_pixelunshuffle_invalid_input_dimensions_g2 ________________

    def test_pixelunshuffle_invalid_input_dimensions_g2():
        """Test PixelUnshuffle with input dimensions not divisible by r (G2 group)"""
        pixel_unshuffle = PixelUnshuffle(2)
        # Input height/width = 5, not divisible by 2
        input_tensor = torch.randn(1, 4, 5, 5)
        with pytest.raises(RuntimeError, match="input spatial dimensions.*not divisible by downscale_factor"):
>           pixel_unshuffle(input_tensor)

tests/test_torch_nn_modules_pixelshuffle_g2.py:258: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/nn/modules/module.py:1190: in _call_impl
    return forward_call(*input, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = PixelUnshuffle(downscale_factor=2)
input = tensor([[[[-1.7376, -0.1254, -1.3658,  1.1117, -0.6228],
          [-0.7892, -0.1678,  1.6433,  2.0071, -1.2531],
    ...],
          [-1.8815,  0.5851, -0.0743, -0.1566, -0.8708],
          [-0.6411,  0.5374,  0.7817,  1.0477, -0.3948]]]])

    def forward(self, input: Tensor) -> Tensor:
>       return F.pixel_unshuffle(input, self.downscale_factor)
E       RuntimeError: pixel_unshuffle expects height to be divisible by downscale_factor, but input.size(-2)=5 is not divisible by 2

/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/nn/modules/pixelshuffle.py:104: RuntimeError

During handling of the above exception, another exception occurred:

    def test_pixelunshuffle_invalid_input_dimensions_g2():
        """Test PixelUnshuffle with input dimensions not divisible by r (G2 group)"""
        pixel_unshuffle = PixelUnshuffle(2)
        # Input height/width = 5, not divisible by 2
        input_tensor = torch.randn(1, 4, 5, 5)
>       with pytest.raises(RuntimeError, match="input spatial dimensions.*not divisible by downscale_factor"):
E       AssertionError: Regex pattern did not match.
E         Expected regex: 'input spatial dimensions.*not divisible by downscale_factor'
E         Actual message: 'pixel_unshuffle expects height to be divisible by downscale_factor, but input.size(-2)=5 is not divisible by 2'

tests/test_torch_nn_modules_pixelshuffle_g2.py:257: AssertionError
================================ tests coverage ================================
______________ coverage: platform darwin, python 3.10.19-final-0 _______________

Name                                             Stmts   Miss Branch BrPart  Cover   Missing
--------------------------------------------------------------------------------------------
cleanup2.py                                          4      4      0      0     0%   1-4
cleanup.py                                           3      3      0      0     0%   1-3
test_pixelunshuffle_behavior.py                     25     25      0      0     0%   1-33
tests/test_torch_nn_modules_pixelshuffle_g1.py      99      5      8      2    93%   12-13, 19, 99->exit, 194-195
tests/test_torch_nn_modules_pixelshuffle_g2.py     152     12     10      4    90%   12-13, 19, 103->exit, 169->194, 194->exit, 242-250, 351, 362
--------------------------------------------------------------------------------------------
TOTAL                                              283     49     18      6    82%
Coverage XML written to file coverage.xml
=========================== short test summary info ============================
FAILED tests/test_torch_nn_modules_pixelshuffle_g1.py::test_pixelshuffle_invalid_upscale_factor_g1
FAILED tests/test_torch_nn_modules_pixelshuffle_g2.py::test_pixelunshuffle_invalid_downscale_factor_g2
FAILED tests/test_torch_nn_modules_pixelshuffle_g2.py::test_pixelunshuffle_invalid_input_dimensions_g2
3 failed, 12 passed in 0.65s

Error: exit 1