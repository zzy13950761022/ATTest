=== Run Tests ===
..FF                                                                     [100%]
=================================== FAILURES ===================================
_ test_fold_basic_tuple_params[output_size0-kernel_size0-stride0-padding0-dilation0-2-3-dtype0-cpu] _

output_size = [4, 5], kernel_size = [2, 3], stride = [1, 1], padding = [0, 0]
dilation = [1, 1], batch_size = 2, channels = 3, dtype = torch.float32
device = 'cpu'

    @pytest.mark.parametrize(
        "output_size,kernel_size,stride,padding,dilation,batch_size,channels,dtype,device",
        [
            # Base case from test plan
            ([4, 5], [2, 3], [1, 1], [0, 0], [1, 1], 2, 3, torch.float32, 'cpu'),
            # Parameter extensions
            ([4, 5], [2, 3], [2, 2], [1, 1], [2, 2], 2, 3, torch.float32, 'cpu'),
        ]
    )
    def test_fold_basic_tuple_params(output_size, kernel_size, stride, padding, dilation, batch_size, channels, dtype, device):
        """
        TC-02: Fold基本功能_tuple参数
        Test Fold with tuple parameters (different values for height and width dimensions)
        """
        # Create Fold module
        fold = Fold(
            output_size=output_size,
            kernel_size=kernel_size,
            stride=stride,
            padding=padding,
            dilation=dilation
        )
    
        # Create valid input tensor
        input_tensor = create_fold_input(
            batch_size=batch_size,
            channels=channels,
            output_size=output_size,
            kernel_size=kernel_size,
            stride=stride,
            padding=padding,
            dilation=dilation,
            dtype=dtype,
            device=device
        )
    
        # Forward pass
        output = fold(input_tensor)
    
        # Weak assertions
        # 1. Shape match
        expected_shape = compute_fold_output_shape(
            batch_size, channels, output_size, kernel_size, stride, padding, dilation
        )
        assert output.shape == expected_shape, f"Expected shape {expected_shape}, got {output.shape}"
    
        # 2. Dtype match
        assert output.dtype == dtype, f"Expected dtype {dtype}, got {output.dtype}"
    
        # 3. Finite values
        assert torch.isfinite(output).all(), "Output contains non-finite values (inf or nan)"
    
        # 4. No NaN/Inf
        assert not torch.isnan(output).any(), "Output contains NaN values"
        assert not torch.isinf(output).any(), "Output contains Inf values"
    
        # Additional basic checks
        assert output.device.type == device, f"Expected device {device}, got {output.device.type}"
    
        # Verify that output has correct spatial dimensions
        assert output.size(2) == output_size[0], f"Expected height {output_size[0]}, got {output.size(2)}"
        assert output.size(3) == output_size[1], f"Expected width {output_size[1]}, got {output.size(3)}"
    
        # Verify parameter handling
        # Check that module stores parameters correctly
>       assert fold.output_size == (output_size[0], output_size[1]), \
            f"Module output_size mismatch: expected {output_size}, got {fold.output_size}"
E       AssertionError: Module output_size mismatch: expected [4, 5], got [4, 5]
E       assert [4, 5] == (4, 5)
E         
E         Use -v to get more diff

tests/test_torch_nn_modules_fold_fold.py:198: AssertionError
_ test_fold_basic_tuple_params[output_size1-kernel_size1-stride1-padding1-dilation1-2-3-dtype1-cpu] _

output_size = [4, 5], kernel_size = [2, 3], stride = [2, 2], padding = [1, 1]
dilation = [2, 2], batch_size = 2, channels = 3, dtype = torch.float32
device = 'cpu'

    @pytest.mark.parametrize(
        "output_size,kernel_size,stride,padding,dilation,batch_size,channels,dtype,device",
        [
            # Base case from test plan
            ([4, 5], [2, 3], [1, 1], [0, 0], [1, 1], 2, 3, torch.float32, 'cpu'),
            # Parameter extensions
            ([4, 5], [2, 3], [2, 2], [1, 1], [2, 2], 2, 3, torch.float32, 'cpu'),
        ]
    )
    def test_fold_basic_tuple_params(output_size, kernel_size, stride, padding, dilation, batch_size, channels, dtype, device):
        """
        TC-02: Fold基本功能_tuple参数
        Test Fold with tuple parameters (different values for height and width dimensions)
        """
        # Create Fold module
        fold = Fold(
            output_size=output_size,
            kernel_size=kernel_size,
            stride=stride,
            padding=padding,
            dilation=dilation
        )
    
        # Create valid input tensor
        input_tensor = create_fold_input(
            batch_size=batch_size,
            channels=channels,
            output_size=output_size,
            kernel_size=kernel_size,
            stride=stride,
            padding=padding,
            dilation=dilation,
            dtype=dtype,
            device=device
        )
    
        # Forward pass
        output = fold(input_tensor)
    
        # Weak assertions
        # 1. Shape match
        expected_shape = compute_fold_output_shape(
            batch_size, channels, output_size, kernel_size, stride, padding, dilation
        )
        assert output.shape == expected_shape, f"Expected shape {expected_shape}, got {output.shape}"
    
        # 2. Dtype match
        assert output.dtype == dtype, f"Expected dtype {dtype}, got {output.dtype}"
    
        # 3. Finite values
        assert torch.isfinite(output).all(), "Output contains non-finite values (inf or nan)"
    
        # 4. No NaN/Inf
        assert not torch.isnan(output).any(), "Output contains NaN values"
        assert not torch.isinf(output).any(), "Output contains Inf values"
    
        # Additional basic checks
        assert output.device.type == device, f"Expected device {device}, got {output.device.type}"
    
        # Verify that output has correct spatial dimensions
        assert output.size(2) == output_size[0], f"Expected height {output_size[0]}, got {output.size(2)}"
        assert output.size(3) == output_size[1], f"Expected width {output_size[1]}, got {output.size(3)}"
    
        # Verify parameter handling
        # Check that module stores parameters correctly
>       assert fold.output_size == (output_size[0], output_size[1]), \
            f"Module output_size mismatch: expected {output_size}, got {fold.output_size}"
E       AssertionError: Module output_size mismatch: expected [4, 5], got [4, 5]
E       assert [4, 5] == (4, 5)
E         
E         Use -v to get more diff

tests/test_torch_nn_modules_fold_fold.py:198: AssertionError
================================ tests coverage ================================
______________ coverage: platform darwin, python 3.10.19-final-0 _______________

Name                                       Stmts   Miss Branch BrPart  Cover   Missing
--------------------------------------------------------------------------------------
tests/test_torch_nn_modules_fold_fold.py      77      6     22      1    93%   128-129, 200-206
--------------------------------------------------------------------------------------
TOTAL                                         77      6     22      1    93%
Coverage XML written to file coverage.xml
=========================== short test summary info ============================
FAILED tests/test_torch_nn_modules_fold_fold.py::test_fold_basic_tuple_params[output_size0-kernel_size0-stride0-padding0-dilation0-2-3-dtype0-cpu]
FAILED tests/test_torch_nn_modules_fold_fold.py::test_fold_basic_tuple_params[output_size1-kernel_size1-stride1-padding1-dilation1-2-3-dtype1-cpu]
2 failed, 2 passed in 0.76s

Error: exit 1