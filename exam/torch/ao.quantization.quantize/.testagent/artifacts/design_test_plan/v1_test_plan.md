# torch.ao.quantization.quantize 测试计划

## 1. 测试策略
- 单元测试框架：pytest
- 隔离策略：使用mock隔离外部依赖（prepare, convert, get_default_static_quant_module_mappings等）
- 随机性处理：固定随机种子确保测试可重复性
- 模型构造：使用简单线性模型和卷积模型作为测试基础

## 2. 生成规格摘要（来自 test_plan.json）
- **SMOKE_SET**: CASE_01, CASE_02, CASE_03, CASE_04（共4个核心用例）
- **DEFERRED_SET**: CASE_05, CASE_06, CASE_07（共3个延后用例）
- **group列表**: G1（核心量化流程）, G2（边界与异常处理）
- **active_group_order**: G1, G2（按优先级顺序执行）
- **断言分级策略**: 首轮使用weak断言（基本结构验证），最终轮启用strong断言（精度性能验证）
- **预算策略**: 
  - S级用例：max_lines=80, max_params=6
  - M级用例：max_lines=100, max_params=8
  - 所有用例均参数化，大部分需要mock

## 3. 数据与边界
- **正常数据集**: 简单线性模型（2-3层），卷积模型（Conv2d + Linear）
- **随机生成策略**: 固定随机种子，可重复的模型权重初始化
- **边界值**: 
  - 最小模型（单层Linear）
  - 空校准函数（no-op）
  - 空映射字典
  - 复杂run_args参数组合
- **负例与异常场景**:
  - 无效模型输入
  - 不可调用run_fn
  - 训练模式模型
  - 不支持的自定义映射

## 4. 覆盖映射
- **TC-01**: 基本量化流程验证（需求1）
- **TC-02**: inplace参数行为验证（需求2）
- **TC-03**: 自定义mapping参数应用（需求3）
- **TC-04**: 校准函数参数传递（需求4）
- **TC-05**: 模型架构兼容性（可选路径）
- **TC-06**: 异常输入处理（错误场景）
- **TC-07**: 边界情况处理（边界值）

- **尚未覆盖的风险点**:
  - 量化精度损失的具体阈值
  - 大规模模型的内存限制
  - 复杂嵌套模型结构
  - 量化配置选项的完整验证