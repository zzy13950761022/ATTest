=== Run Tests ===
F.                                                                       [100%]
=================================== FAILURES ===================================
_______________ TestWeightNormG2.test_invalid_module_type_error ________________

self = <test_torch_nn_utils_weight_norm_g2.TestWeightNormG2 object at 0x1114b4ee0>

    def test_invalid_module_type_error(self):
        """TC-06: 无效模块类型错误处理
    
        Test that weight_norm raises TypeError when given invalid module type.
        Weak assertions: raises_type_error, error_message_contains
        """
        # Test with various invalid module types
    
        # Test 1: String instead of module
        with pytest.raises(TypeError) as exc_info:
>           weight_norm("not_a_module", name='weight', dim=0)

tests/test_torch_nn_utils_weight_norm_g2.py:33: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:109: in weight_norm
    WeightNorm.apply(module, name, dim)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

module = 'not_a_module', name = 'weight', dim = 0

    @staticmethod
    def apply(module, name: str, dim: int) -> 'WeightNorm':
>       for k, hook in module._forward_pre_hooks.items():
E       AttributeError: 'str' object has no attribute '_forward_pre_hooks'

/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:29: AttributeError
================================ tests coverage ================================
______________ coverage: platform darwin, python 3.10.19-final-0 _______________

Name                                          Stmts   Miss Branch BrPart  Cover   Missing
-----------------------------------------------------------------------------------------
tests/test_torch_nn_utils_weight_norm_g2.py      58     23      0      0    60%   36-73, 139-140
-----------------------------------------------------------------------------------------
TOTAL                                            58     23      0      0    60%
Coverage XML written to file coverage.xml
=========================== short test summary info ============================
FAILED tests/test_torch_nn_utils_weight_norm_g2.py::TestWeightNormG2::test_invalid_module_type_error
1 failed, 1 passed in 0.60s

Error: exit 1