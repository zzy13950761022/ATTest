=== Run Tests ===
....F......F........                                                     [100%]
=================================== FAILURES ===================================
_____________________________ test_invalid_inputs ______________________________

    def test_invalid_inputs() -> None:
        """测试非法输入场景"""
    
        # 测试 uniform_ 的非法输入
        with pytest.raises(RuntimeError):
            # 非张量输入
>           init.uniform_(None, 0, 1)

tests/test_torch_nn_init_g1.py:231: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/nn/init.py:137: in uniform_
    return _no_grad_uniform_(tensor, a, b)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

tensor = None, a = 0, b = 1

    def _no_grad_uniform_(tensor, a, b):
        with torch.no_grad():
>           return tensor.uniform_(a, b)
E           AttributeError: 'NoneType' object has no attribute 'uniform_'

/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/nn/init.py:14: AttributeError
_____________________________ test_invalid_inputs ______________________________

    def test_invalid_inputs() -> None:
        """测试非法输入场景"""
    
        # 测试 xavier_uniform_ 的非法输入
        # 注意：传入None会抛出AttributeError而不是RuntimeError
        # 因为None没有dim属性
        with pytest.raises(AttributeError):
            # 非张量输入
            init.xavier_uniform_(None)
    
        # 测试 kaiming_uniform_ 的非法模式
        tensor = torch.empty(2, 3)
        with pytest.raises(ValueError, match="mode must be 'fan_in' or 'fan_out'"):
>           init.kaiming_uniform_(tensor, mode="invalid_mode")

tests/test_torch_nn_init_g2.py:271: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/nn/init.py:407: in kaiming_uniform_
    fan = _calculate_correct_fan(tensor, mode)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

tensor = tensor([[0., 0., 0.],
        [0., 0., 0.]]), mode = 'invalid_mode'

    def _calculate_correct_fan(tensor, mode):
        mode = mode.lower()
        valid_modes = ['fan_in', 'fan_out']
        if mode not in valid_modes:
>           raise ValueError("Mode {} not supported, please use one of {}".format(mode, valid_modes))
E           ValueError: Mode invalid_mode not supported, please use one of ['fan_in', 'fan_out']

/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/nn/init.py:360: ValueError

During handling of the above exception, another exception occurred:

    def test_invalid_inputs() -> None:
        """测试非法输入场景"""
    
        # 测试 xavier_uniform_ 的非法输入
        # 注意：传入None会抛出AttributeError而不是RuntimeError
        # 因为None没有dim属性
        with pytest.raises(AttributeError):
            # 非张量输入
            init.xavier_uniform_(None)
    
        # 测试 kaiming_uniform_ 的非法模式
        tensor = torch.empty(2, 3)
>       with pytest.raises(ValueError, match="mode must be 'fan_in' or 'fan_out'"):
E       AssertionError: Regex pattern did not match.
E         Expected regex: "mode must be 'fan_in' or 'fan_out'"
E         Actual message: "Mode invalid_mode not supported, please use one of ['fan_in', 'fan_out']"

tests/test_torch_nn_init_g2.py:270: AssertionError
================================ tests coverage ================================
______________ coverage: platform darwin, python 3.10.19-final-0 _______________

Name                             Stmts   Miss Branch BrPart  Cover   Missing
----------------------------------------------------------------------------
test_sparse_behavior.py             53     53      0      0     0%   1-61
tests/test_torch_nn_init_g1.py     118     25     16      6    77%   20, 58, 110->114, 129->exit, 176->180, 207->exit, 234-242, 294-321
tests/test_torch_nn_init_g2.py     132     22     24      7    80%   20, 58, 67, 158-159, 223->229, 235->240, 241, 274-275, 327-349
tests/test_torch_nn_init_g3.py     275     83     84     21    67%   20, 38, 59->exit, 90->141, 141->exit, 158->exit, 188->237, 216->228, 237->310, 252->292, 274-288, 292->302, 302->310, 310->exit, 349-366, 389-426, 429->471, 452->455, 460-468, 473-480, 485-492, 532-534, 578-600
----------------------------------------------------------------------------
TOTAL                              578    183    124     34    67%
Coverage XML written to file coverage.xml
=========================== short test summary info ============================
FAILED tests/test_torch_nn_init_g1.py::test_invalid_inputs - AttributeError: ...
FAILED tests/test_torch_nn_init_g2.py::test_invalid_inputs - AssertionError: ...
2 failed, 18 passed in 0.90s

Error: exit 1