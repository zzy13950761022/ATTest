=== Run Tests ===
........F..........                                                      [100%]
=================================== FAILURES ===================================
__________________ test_unsupported_sequence_unchanged[False] __________________

random_input = tensor([[[[ 1.9269e+00,  1.4873e+00,  9.0072e-01,  ...,  4.1759e-02,
           -2.5158e-01,  8.5986e-01],
          [...065e-01],
          [ 9.6563e-01,  4.6251e-01, -1.4208e+00,  ...,  1.7574e-01,
            2.5499e-01,  8.0700e-01]]]])
inplace = False

    @pytest.mark.parametrize("inplace", [False])
    def test_unsupported_sequence_unchanged(random_input, inplace):
        """Test that unsupported fusion sequences raise NotImplementedError."""
        # Setup
        model = UnsupportedSequence()
        model.eval()
    
        # Get original output
        with torch.no_grad():
            original_output = model(random_input)
    
        # Try to fuse unsupported sequence (conv-relu-conv)
        # This should raise NotImplementedError according to fuse_known_modules
        modules_to_fuse = ["conv", "relu", "conv2"]
    
        # Weak assertions: should raise NotImplementedError
        with pytest.raises(NotImplementedError) as exc_info:
>           fused_model = fuse_modules(
                model,
                modules_to_fuse,
                inplace=inplace,
                fuser_func=None,  # Use default
                fuse_custom_config_dict=None
            )

tests/test_torch_ao_quantization_fuse_modules_g1.py:489: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/ao/quantization/fuse_modules.py:152: in fuse_modules
    return _fuse_modules(
/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/ao/quantization/fuse_modules.py:90: in _fuse_modules
    _fuse_modules_helper(model, modules_to_fuse, is_qat, fuser_func, fuse_custom_config_dict)
/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/ao/quantization/fuse_modules.py:78: in _fuse_modules_helper
    new_mod_list = fuser_func(mod_list, is_qat, additional_fuser_method_mapping)
/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/ao/quantization/fuse_modules.py:46: in fuse_known_modules
    fuser_method = get_fuser_method(types, additional_fuser_method_mapping)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

op_list = (<class 'torch.nn.modules.conv.Conv2d'>, <class 'torch.nn.modules.activation.ReLU'>, <class 'torch.nn.modules.conv.Conv2d'>)
additional_fuser_method_mapping = {}

    def get_fuser_method(op_list, additional_fuser_method_mapping=None):
        ''' Get fuser method for the given list of module types,
        return None if fuser method does not exist
        '''
        if additional_fuser_method_mapping is None:
            additional_fuser_method_mapping = {}
        all_mappings = get_combined_dict(DEFAULT_OP_LIST_TO_FUSER_METHOD,
                                         additional_fuser_method_mapping)
        fuser_method = all_mappings.get(op_list, None)
>       assert fuser_method is not None, "did not find fuser method for: {} ".format(op_list)
E       AssertionError: did not find fuser method for: (<class 'torch.nn.modules.conv.Conv2d'>, <class 'torch.nn.modules.activation.ReLU'>, <class 'torch.nn.modules.conv.Conv2d'>)

/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/ao/quantization/fuser_method_mappings.py:184: AssertionError
================================ tests coverage ================================
______________ coverage: platform darwin, python 3.10.19-final-0 _______________

Name                                                  Stmts   Miss Branch BrPart  Cover   Missing
-------------------------------------------------------------------------------------------------
tests/test_torch_ao_quantization_fuse_modules_g1.py     272     33     30      7    86%   22, 76-83, 86-94, 255->254, 269, 328, 457, 498-516, 564, 575-576
tests/test_torch_ao_quantization_fuse_modules_g2.py     119     15     10      3    84%   22, 60, 215-230, 272, 312, 329-330
-------------------------------------------------------------------------------------------------
TOTAL                                                   391     48     40     10    86%
Coverage XML written to file coverage.xml
=========================== short test summary info ============================
FAILED tests/test_torch_ao_quantization_fuse_modules_g1.py::test_unsupported_sequence_unchanged[False]
1 failed, 18 passed in 0.85s

Error: exit 1