=== Run Tests ===
...FFFFF.                                                                [100%]
=================================== FAILURES ===================================
_______________________ test_non_module_type_input[123] ________________________

invalid_model = 123

    @pytest.mark.parametrize("invalid_model", [
        None,           # None input
        123,            # Integer input
        "not_a_model",  # String input
        [],             # List input
        {},             # Dict input
    ])
    def test_non_module_type_input(invalid_model):
        """Test that non-Module type inputs raise appropriate exception."""
        # Try to fuse with invalid model type
        modules_to_fuse = ["conv", "bn"]
    
        # Weak assertions
        # 1. Exception raised check
        with pytest.raises(Exception) as exc_info:
            fuse_modules(
                invalid_model,
                modules_to_fuse,
                inplace=False,
                fuser_func=None,
                fuse_custom_config_dict=None
            )
    
        # 2. Exception type check
        exception = exc_info.value
        assert exception is not None, "Exception should be raised for non-Module input"
    
        # 3. Check exception message contains type-related info
        exception_str = str(exception).lower()
        # The message should indicate type error
        type_indicators = ["type", "module", "instance", "argument", "expected"]
        type_error_found = any(indicator in exception_str for indicator in type_indicators)
>       assert type_error_found, \
            f"Exception message should indicate type error: {exception_str}"
E       AssertionError: Exception message should indicate type error: 'int' object has no attribute 'conv'
E       assert False

tests/test_torch_ao_quantization_fuse_modules_g2.py:160: AssertionError
___________________ test_non_module_type_input[not_a_model] ____________________

invalid_model = 'not_a_model'

    @pytest.mark.parametrize("invalid_model", [
        None,           # None input
        123,            # Integer input
        "not_a_model",  # String input
        [],             # List input
        {},             # Dict input
    ])
    def test_non_module_type_input(invalid_model):
        """Test that non-Module type inputs raise appropriate exception."""
        # Try to fuse with invalid model type
        modules_to_fuse = ["conv", "bn"]
    
        # Weak assertions
        # 1. Exception raised check
        with pytest.raises(Exception) as exc_info:
            fuse_modules(
                invalid_model,
                modules_to_fuse,
                inplace=False,
                fuser_func=None,
                fuse_custom_config_dict=None
            )
    
        # 2. Exception type check
        exception = exc_info.value
        assert exception is not None, "Exception should be raised for non-Module input"
    
        # 3. Check exception message contains type-related info
        exception_str = str(exception).lower()
        # The message should indicate type error
        type_indicators = ["type", "module", "instance", "argument", "expected"]
        type_error_found = any(indicator in exception_str for indicator in type_indicators)
>       assert type_error_found, \
            f"Exception message should indicate type error: {exception_str}"
E       AssertionError: Exception message should indicate type error: 'str' object has no attribute 'conv'
E       assert False

tests/test_torch_ao_quantization_fuse_modules_g2.py:160: AssertionError
__________________ test_non_module_type_input[invalid_model3] __________________

invalid_model = []

    @pytest.mark.parametrize("invalid_model", [
        None,           # None input
        123,            # Integer input
        "not_a_model",  # String input
        [],             # List input
        {},             # Dict input
    ])
    def test_non_module_type_input(invalid_model):
        """Test that non-Module type inputs raise appropriate exception."""
        # Try to fuse with invalid model type
        modules_to_fuse = ["conv", "bn"]
    
        # Weak assertions
        # 1. Exception raised check
        with pytest.raises(Exception) as exc_info:
            fuse_modules(
                invalid_model,
                modules_to_fuse,
                inplace=False,
                fuser_func=None,
                fuse_custom_config_dict=None
            )
    
        # 2. Exception type check
        exception = exc_info.value
        assert exception is not None, "Exception should be raised for non-Module input"
    
        # 3. Check exception message contains type-related info
        exception_str = str(exception).lower()
        # The message should indicate type error
        type_indicators = ["type", "module", "instance", "argument", "expected"]
        type_error_found = any(indicator in exception_str for indicator in type_indicators)
>       assert type_error_found, \
            f"Exception message should indicate type error: {exception_str}"
E       AssertionError: Exception message should indicate type error: 'list' object has no attribute 'conv'
E       assert False

tests/test_torch_ao_quantization_fuse_modules_g2.py:160: AssertionError
__________________ test_non_module_type_input[invalid_model4] __________________

invalid_model = {}

    @pytest.mark.parametrize("invalid_model", [
        None,           # None input
        123,            # Integer input
        "not_a_model",  # String input
        [],             # List input
        {},             # Dict input
    ])
    def test_non_module_type_input(invalid_model):
        """Test that non-Module type inputs raise appropriate exception."""
        # Try to fuse with invalid model type
        modules_to_fuse = ["conv", "bn"]
    
        # Weak assertions
        # 1. Exception raised check
        with pytest.raises(Exception) as exc_info:
            fuse_modules(
                invalid_model,
                modules_to_fuse,
                inplace=False,
                fuser_func=None,
                fuse_custom_config_dict=None
            )
    
        # 2. Exception type check
        exception = exc_info.value
        assert exception is not None, "Exception should be raised for non-Module input"
    
        # 3. Check exception message contains type-related info
        exception_str = str(exception).lower()
        # The message should indicate type error
        type_indicators = ["type", "module", "instance", "argument", "expected"]
        type_error_found = any(indicator in exception_str for indicator in type_indicators)
>       assert type_error_found, \
            f"Exception message should indicate type error: {exception_str}"
E       AssertionError: Exception message should indicate type error: 'dict' object has no attribute 'conv'
E       assert False

tests/test_torch_ao_quantization_fuse_modules_g2.py:160: AssertionError
_________________________ test_empty_list_input[False] _________________________

random_input = tensor([[[[ 1.9269e+00,  1.4873e+00,  9.0072e-01,  ...,  4.1759e-02,
           -2.5158e-01,  8.5986e-01],
          [...065e-01],
          [ 9.6563e-01,  4.6251e-01, -1.4208e+00,  ...,  1.7574e-01,
            2.5499e-01,  8.0700e-01]]]])
inplace = False

    @pytest.mark.parametrize("inplace", [False])
    def test_empty_list_input(random_input, inplace):
        """Test that empty modules_to_fuse list behaves correctly."""
        # Setup
        model = SimpleModel()
        model.eval()
    
        # Get original output
        with torch.no_grad():
            original_output = model(random_input)
    
        # Try to fuse with empty list
        modules_to_fuse = []
    
        # Weak assertions
        # 1. No exception check
        # The function should complete without raising an exception
>       fused_model = fuse_modules(
            model,
            modules_to_fuse,
            inplace=inplace,
            fuser_func=None,
            fuse_custom_config_dict=None
        )

tests/test_torch_ao_quantization_fuse_modules_g2.py:185: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/ao/quantization/fuse_modules.py:152: in fuse_modules
    return _fuse_modules(
/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/ao/quantization/fuse_modules.py:90: in _fuse_modules
    _fuse_modules_helper(model, modules_to_fuse, is_qat, fuser_func, fuse_custom_config_dict)
/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/ao/quantization/fuse_modules.py:78: in _fuse_modules_helper
    new_mod_list = fuser_func(mod_list, is_qat, additional_fuser_method_mapping)
/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/ao/quantization/fuse_modules.py:46: in fuse_known_modules
    fuser_method = get_fuser_method(types, additional_fuser_method_mapping)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

op_list = (), additional_fuser_method_mapping = {}

    def get_fuser_method(op_list, additional_fuser_method_mapping=None):
        ''' Get fuser method for the given list of module types,
        return None if fuser method does not exist
        '''
        if additional_fuser_method_mapping is None:
            additional_fuser_method_mapping = {}
        all_mappings = get_combined_dict(DEFAULT_OP_LIST_TO_FUSER_METHOD,
                                         additional_fuser_method_mapping)
        fuser_method = all_mappings.get(op_list, None)
>       assert fuser_method is not None, "did not find fuser method for: {} ".format(op_list)
E       AssertionError: did not find fuser method for: ()

/opt/anaconda3/envs/testagent-experiment/lib/python3.10/site-packages/torch/ao/quantization/fuser_method_mappings.py:184: AssertionError
================================ tests coverage ================================
______________ coverage: platform darwin, python 3.10.19-final-0 _______________

Name                                                  Stmts   Miss Branch BrPart  Cover   Missing
-------------------------------------------------------------------------------------------------
tests/test_torch_ao_quantization_fuse_modules_g2.py     117     21     10      3    80%   22, 60, 194-222, 252, 292, 309-310
-------------------------------------------------------------------------------------------------
TOTAL                                                   117     21     10      3    80%
Coverage XML written to file coverage.xml
=========================== short test summary info ============================
FAILED tests/test_torch_ao_quantization_fuse_modules_g2.py::test_non_module_type_input[123]
FAILED tests/test_torch_ao_quantization_fuse_modules_g2.py::test_non_module_type_input[not_a_model]
FAILED tests/test_torch_ao_quantization_fuse_modules_g2.py::test_non_module_type_input[invalid_model3]
FAILED tests/test_torch_ao_quantization_fuse_modules_g2.py::test_non_module_type_input[invalid_model4]
FAILED tests/test_torch_ao_quantization_fuse_modules_g2.py::test_empty_list_input[False]
5 failed, 4 passed in 0.82s

Error: exit 1