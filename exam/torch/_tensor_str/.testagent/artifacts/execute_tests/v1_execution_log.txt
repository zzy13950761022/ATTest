=== Run Tests ===
FF                                                                       [100%]
=================================== FAILURES ===================================
_ TestTensorStrCore.test_basic_float_tensor_formatting[dtype0-cpu-shape0-arange-4] _

self = <test_torch_tensor_str_core.TestTensorStrCore object at 0x14f175e40>
dtype = torch.float32, device = 'cpu', shape = (2, 3), values = 'arange'
precision = 4

    @pytest.mark.parametrize("dtype,device,shape,values,precision", [
        (torch.float32, 'cpu', (2, 3), 'arange', 4),
    ])
    def test_basic_float_tensor_formatting(self, dtype, device, shape, values, precision):
        """TC-01: Basic float tensor formatting with precision control."""
        # Set print options
        set_printoptions(precision=precision)
    
        # Create tensor based on values specification
        if values == 'arange':
            total_elements = math.prod(shape)
            tensor = torch.arange(total_elements, dtype=dtype, device=device).reshape(shape)
        else:
            raise ValueError(f"Unknown values specification: {values}")
    
        # Get string representation
        tensor_str = str(tensor)
    
        # Weak assertions
        # 1. Output is a string
        assert isinstance(tensor_str, str), "Tensor string representation should be a string"
    
        # 2. Contains shape information
        shape_str = f"{shape}".replace("(", "[").replace(")", "]")
>       assert shape_str in tensor_str, f"Shape information {shape_str} should be in output"
E       AssertionError: Shape information [2, 3] should be in output
E       assert '[2, 3]' in 'tensor([[0., 1., 2.],\n        [3., 4., 5.]])'

tests/test_torch_tensor_str_core.py:64: AssertionError
_ TestTensorStrCore.test_large_tensor_truncation_display[dtype0-cpu-shape0-1000-3] _

self = <test_torch_tensor_str_core.TestTensorStrCore object at 0x14f176230>
dtype = torch.float64, device = 'cpu', shape = (100, 100), threshold = 1000
edgeitems = 3

    @pytest.mark.parametrize("dtype,device,shape,threshold,edgeitems", [
        (torch.float64, 'cpu', (100, 100), 1000, 3),
    ])
    def test_large_tensor_truncation_display(self, dtype, device, shape, threshold, edgeitems):
        """TC-02: Large tensor truncation display with threshold and edgeitems control."""
        # Set print options
        set_printoptions(threshold=threshold, edgeitems=edgeitems)
    
        # Create large tensor
        total_elements = math.prod(shape)
        tensor = torch.arange(total_elements, dtype=dtype, device=device).reshape(shape)
    
        # Get string representation
        tensor_str = str(tensor)
    
        # Weak assertions
        # 1. Output is a string
        assert isinstance(tensor_str, str), "Tensor string representation should be a string"
    
        # 2. Contains ellipsis for truncation
        assert "..." in tensor_str, "Large tensor should be truncated with '...'"
    
        # 3. Shape information present
        shape_str = f"{shape}".replace("(", "[").replace(")", "]")
>       assert shape_str in tensor_str, f"Shape information {shape_str} should be in output"
E       AssertionError: Shape information [100, 100] should be in output
E       assert '[100, 100]' in 'tensor([[0.0000e+00, 1.0000e+00, 2.0000e+00,  ..., 9.7000e+01, 9.8000e+01,\n         9.9000e+01],\n        [1.0000e+0...       [9.9000e+03, 9.9010e+03, 9.9020e+03,  ..., 9.9970e+03, 9.9980e+03,\n         9.9990e+03]], dtype=torch.float64)'

tests/test_torch_tensor_str_core.py:115: AssertionError
================================ tests coverage ================================
______________ coverage: platform darwin, python 3.10.19-final-0 _______________

Name                                  Stmts   Miss Branch BrPart  Cover   Missing
---------------------------------------------------------------------------------
tests/test_torch_tensor_str_core.py      61     25     12      2    52%   53, 67-86, 119-136, 149
---------------------------------------------------------------------------------
TOTAL                                    61     25     12      2    52%
Coverage XML written to file coverage.xml
=========================== short test summary info ============================
FAILED tests/test_torch_tensor_str_core.py::TestTensorStrCore::test_basic_float_tensor_formatting[dtype0-cpu-shape0-arange-4]
FAILED tests/test_torch_tensor_str_core.py::TestTensorStrCore::test_large_tensor_truncation_display[dtype0-cpu-shape0-1000-3]
2 failed in 0.77s

Error: exit 1