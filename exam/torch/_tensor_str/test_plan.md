# torch._tensor_str 测试计划

## 1. 测试策略
- 单元测试框架：pytest
- 隔离策略：使用 fixture 隔离全局打印状态，mock 设备检查
- 随机性处理：固定随机种子，控制张量生成

## 2. 生成规格摘要（来自 test_plan.json）
- SMOKE_SET: CASE_01, CASE_02, CASE_03, CASE_04
- DEFERRED_SET: CASE_05, CASE_06, CASE_07, CASE_08, CASE_09, CASE_10
- group 列表：G1（核心格式化）、G2（打印选项）、G3（特殊张量）
- active_group_order: G1 → G2 → G3
- 断言分级策略：首轮使用 weak 断言（基本验证），最终启用 strong 断言（精确验证）
- 预算策略：size=S（小型用例），max_lines=60-80，max_params=5-6

## 3. 数据与边界
- 正常数据集：浮点/整数张量，形状 [2,3] 到 [100,100]，随机/序列值
- 边界值：空张量（含0维度），单元素张量，极端形状（>4维）
- 极端数值：NaN, inf, -inf, 零张量，接近精度边界的值
- 负例场景：非张量输入，无效选项值，负参数值，无效 profile
- 异常场景：内存不足（模拟），设备不可用，并发状态冲突

## 4. 覆盖映射
| TC_ID | 需求覆盖 | 约束覆盖 |
|-------|----------|----------|
| TC-01 | 基本浮点张量格式化 | 精度控制，形状显示 |
| TC-02 | 大张量截断显示 | threshold参数，edgeitems控制 |
| TC-03 | 全局打印选项设置 | 状态管理，选项验证 |
| TC-04 | 稀疏张量格式化 | 特殊张量标识，布局显示 |
| TC-05 | 复数张量格式化 | 实部/虚部分离显示 |

### 尚未覆盖的风险点
- 并发环境下的状态隔离
- 超大张量内存使用边界
- 特殊设备（MPS）支持情况
- 性能边界条件（处理时间）
- 嵌套张量/元张量格式化