{
  "plan_version": 2,
  "target": "torch.utils.data.dataset",
  "block_rules": {
    "header_block": "HEADER",
    "footer_block": "FOOTER",
    "case_prefix": "CASE_",
    "case_format": "CASE_01"
  },
  "iteration_strategy": {
    "round1": {
      "include": "SMOKE_SET",
      "assert_level": "weak",
      "max_blocks": 5
    },
    "roundN": {
      "only_fix_failed_blocks": true,
      "block_limit": 3,
      "promote_deferred": true
    },
    "final": {
      "enable_strong_asserts": true,
      "coverage_optional": true
    }
  },
  "test_files": {
    "default": "tests/test_torch_utils_data_dataset.py",
    "all_pattern": "tests/test_torch_utils_data_dataset.py"
  },
  "cases": [
    {
      "tc_id": "TC-01",
      "block_id": "CASE_01",
      "name": "TensorDataset 基本功能验证",
      "priority": "High",
      "param_matrix": [
        {
          "tensor_shapes": [[10, 3, 32, 32], [10, 1]],
          "dtypes": ["float32", "float32"],
          "device": "cpu",
          "index": 0
        }
      ],
      "asserts": {
        "weak": [
          "返回元组长度与输入张量数一致",
          "切片形状正确",
          "数据类型保持",
          "设备一致"
        ],
        "strong": [
          "张量值完全相等",
          "负索引访问正确",
          "边界索引处理正确"
        ]
      },
      "oracle": "TensorDataset.__getitem__",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 70,
      "max_params": 5,
      "is_parametrized": true,
      "requires_mock": false,
      "mock_targets": []
    },
    {
      "tc_id": "TC-02",
      "block_id": "CASE_02",
      "name": "TensorDataset 维度验证异常",
      "priority": "High",
      "param_matrix": [
        {
          "tensor_shapes": [[10, 3, 32, 32], [5, 1]],
          "dtypes": ["float32", "float32"],
          "device": "cpu"
        }
      ],
      "asserts": {
        "weak": [
          "抛出 RuntimeError",
          "错误信息包含维度不匹配提示"
        ],
        "strong": [
          "异常类型精确匹配",
          "错误信息格式符合预期"
        ]
      },
      "oracle": "TensorDataset.__init__",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 60,
      "max_params": 3,
      "is_parametrized": false,
      "requires_mock": false,
      "mock_targets": []
    },
    {
      "tc_id": "TC-03",
      "block_id": "CASE_03",
      "name": "random_split 整数分割",
      "priority": "High",
      "param_matrix": [
        {
          "dataset_size": 100,
          "lengths": [70, 30],
          "use_generator": false
        }
      ],
      "asserts": {
        "weak": [
          "返回列表长度正确",
          "子集大小与指定长度一致",
          "所有样本被分配且不重复"
        ],
        "strong": [
          "随机性可控制（使用固定种子）",
          "分割结果可重现",
          "原数据集未被修改"
        ]
      },
      "oracle": "random_split",
      "assertion_level": "weak",
      "size": "M",
      "max_lines": 80,
      "max_params": 4,
      "is_parametrized": true,
      "requires_mock": true,
      "mock_targets": ["torch.randperm"]
    },
    {
      "tc_id": "TC-04",
      "block_id": "CASE_04",
      "name": "ConcatDataset 多数据集拼接",
      "priority": "High",
      "param_matrix": [
        {
          "dataset_sizes": [20, 30, 50],
          "index_to_test": [0, 25, 80, -1]
        }
      ],
      "asserts": {
        "weak": [
          "总长度等于各数据集长度之和",
          "索引映射正确",
          "支持负索引访问"
        ],
        "strong": [
          "二分查找逻辑正确",
          "边界条件处理正确",
          "空数据集拼接处理"
        ]
      },
      "oracle": "ConcatDataset.__getitem__",
      "assertion_level": "weak",
      "size": "M",
      "max_lines": 85,
      "max_params": 4,
      "is_parametrized": true,
      "requires_mock": true,
      "mock_targets": ["bisect.bisect_right"]
    },
    {
      "tc_id": "TC-05",
      "block_id": "CASE_05",
      "name": "Dataset 抽象类接口约束",
      "priority": "High",
      "param_matrix": [
        {
          "test_method": "__getitem__"
        }
      ],
      "asserts": {
        "weak": [
          "直接实例化抛出 NotImplementedError",
          "错误信息明确"
        ],
        "strong": [
          "子类必须实现 __getitem__",
          "__add__ 方法返回 ConcatDataset"
        ]
      },
      "oracle": "Dataset.__getitem__",
      "assertion_level": "weak",
      "size": "S",
      "max_lines": 50,
      "max_params": 2,
      "is_parametrized": false,
      "requires_mock": false,
      "mock_targets": []
    }
  ],
  "param_extensions": [
    {
      "base_block_id": "CASE_01",
      "priority": "Medium",
      "params": {
        "tensor_shapes": [[5, 1, 28, 28], [5, 10]],
        "dtypes": ["float64", "int64"],
        "device": "cpu",
        "index": -1
      },
      "note": "不同数据类型和负索引测试"
    },
    {
      "base_block_id": "CASE_01",
      "priority": "Medium",
      "params": {
        "tensor_shapes": [[0, 3, 32, 32], [0, 1]],
        "dtypes": ["float32", "float32"],
        "device": "cpu",
        "index": 0
      },
      "note": "空数据集边界测试"
    },
    {
      "base_block_id": "CASE_03",
      "priority": "Medium",
      "params": {
        "dataset_size": 100,
        "lengths": [0.7, 0.3],
        "use_generator": true
      },
      "note": "比例分割和生成器参数测试"
    },
    {
      "base_block_id": "CASE_03",
      "priority": "Low",
      "params": {
        "dataset_size": 100,
        "lengths": [101],
        "use_generator": false
      },
      "note": "长度超过数据集大小的异常测试"
    },
    {
      "base_block_id": "CASE_04",
      "priority": "Medium",
      "params": {
        "dataset_sizes": [0, 50, 0],
        "index_to_test": [0, 25, 49]
      },
      "note": "包含空数据集的拼接测试"
    }
  ],
  "smoke_set": ["CASE_01", "CASE_02", "CASE_03"],
  "deferred_set": ["CASE_04", "CASE_05"]
}