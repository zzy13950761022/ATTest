# torch.nn.utils.convert_parameters 测试计划

## 1. 测试策略
- 单元测试框架：pytest
- 隔离策略：使用 pytest fixtures 管理测试数据和设备
- 随机性处理：固定随机种子确保可重复性
- 设备管理：支持 CPU 和 GPU（CUDA 可用时）测试

## 2. 生成规格摘要（来自 test_plan.json）
- **SMOKE_SET**: CASE_01, CASE_02, CASE_03, CASE_04（4个核心用例）
- **DEFERRED_SET**: CASE_05, CASE_06, CASE_07, CASE_08（4个扩展用例）
- **group 列表**: 
  - G1: parameters_to_vector 函数族（CASE_01-02, 05-06）
  - G2: vector_to_parameters 函数族（CASE_03-04, 07-08）
- **active_group_order**: ["G1", "G2"]（按函数分组执行）
- **断言分级策略**: 首轮使用 weak 断言，最终轮启用 strong 断言
- **预算策略**: 
  - 用例大小：XS(50行) ~ M(80行)
  - 最大参数数：3-5个
  - 参数化用例优先

## 3. 数据与边界
- **正常数据集**: 混合形状参数（2D/1D/3D），float32/float64 类型
- **边界值**: 空迭代器、零元素张量、极端大形状
- **异常场景**: 
  1. 设备不一致异常
  2. 向量长度不匹配
  3. 非张量输入异常
  4. 空迭代器处理

## 4. 覆盖映射
| TC ID | 功能覆盖 | 需求覆盖 | 风险点 |
|-------|----------|----------|--------|
| TC-01 | CPU参数展平 | 正常路径、设备一致性 | 浮点精度 |
| TC-02 | 设备检查 | 异常处理、设备验证 | GPU可用性 |
| TC-03 | 向量分割 | 双向转换、形状恢复 | 原地修改 |
| TC-04 | 长度验证 | 输入验证、错误处理 | 边界条件 |
| TC-05 | 空迭代器 | 边界处理、异常触发 | 边缘情况 |
| TC-06 | 零元素 | 特殊形状、连接逻辑 | 零值处理 |
| TC-07 | 类型检查 | 输入验证、类型安全 | 类型转换 |
| TC-08 | 大形状 | 性能边界、内存使用 | 资源限制 |

**尚未覆盖的关键风险点**:
- 梯度传播行为（autograd）
- 稀疏张量支持
- 复数类型参数
- 跨设备内存传输
- 非连续内存布局